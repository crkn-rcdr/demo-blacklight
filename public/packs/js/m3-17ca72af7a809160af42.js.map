{"version":3,"file":"js/m3-17ca72af7a809160af42.js","mappings":"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","sources":["webpack://demo-blacklight/./app/javascript/src/plugins/mirador-image-tools/ImageTool.js","webpack://demo-blacklight/./app/javascript/src/plugins/mirador-image-tools/ImageRotation.js","webpack://demo-blacklight/./app/javascript/src/plugins/mirador-image-tools/ImageFlip.js","webpack://demo-blacklight/./app/javascript/src/plugins/mirador-image-tools/MiradorImageTools.js","webpack://demo-blacklight/./app/javascript/src/plugins/mirador-image-tools/MiradorImageToolsMenuItem.js","webpack://demo-blacklight/./app/javascript/src/plugins/mirador-image-tools/translations.js","webpack://demo-blacklight/./app/javascript/src/plugins/mirador-image-tools/miradorImageToolsPlugin.js","webpack://demo-blacklight/./app/javascript/src/plugins/fullResDownloadPlugin.js","webpack://demo-blacklight/./app/javascript/src/plugins/pdfDownloadPlugin.js","webpack://demo-blacklight/./app/javascript/src/plugins/fullPdfDownloadPlugin.js","webpack://demo-blacklight/./app/javascript/src/plugins/mirador-downloads/miradorDownloadPlugin.js","webpack://demo-blacklight/./app/javascript/src/plugins/mirador-downloads/RenderingDownloadLink.js","webpack://demo-blacklight/./app/javascript/src/plugins/mirador-downloads/CanvasDownloadLinks.js","webpack://demo-blacklight/./app/javascript/src/plugins/mirador-downloads/ManifestDownloadLinks.js","webpack://demo-blacklight/./app/javascript/src/plugins/mirador-downloads/MiradorDownloadDialog.js","webpack://demo-blacklight/./app/javascript/src/plugins/miradorPDIIIFMenuItem.js","webpack://demo-blacklight/./app/javascript/src/plugins/downloadMenuButton.jsx","webpack://demo-blacklight/./app/javascript/src/plugins/downloadMenuPlugin.jsx","webpack://demo-blacklight/./app/javascript/src/plugins/miradorPDIIIFDialog.js","webpack://demo-blacklight/./app/javascript/src/plugins/pageNumPlugin.jsx","webpack://demo-blacklight/./app/javascript/src/plugins/miradorViewPlugin.jsx","webpack://demo-blacklight/./app/javascript/src/plugins/navControls.jsx","webpack://demo-blacklight/./app/javascript/src/plugins/legacySearchPlugin.jsx","webpack://demo-blacklight/./app/javascript/src/modules/m3_viewer.js","webpack://demo-blacklight/./app/javascript/packs/m3.js"],"sourcesContent":["import React, { Component } from 'react';\r\nimport compose from 'lodash/flowRight';\r\nimport PropTypes from 'prop-types';\r\nimport { MiradorMenuButton } from 'mirador/dist/es/src/components/MiradorMenuButton';\r\nimport Slider from '@material-ui/core/Slider';\r\nimport withStyles from '@material-ui/core/styles/withStyles';\r\nimport withWidth from '@material-ui/core/withWidth';\r\nimport { fade } from '@material-ui/core/styles/colorManipulator';\r\n\r\n/** Styles for withStyles HOC */\r\nconst styles = ({ palette, breakpoints }) => ({\r\n  slider: {\r\n    backgroundColor: fade(palette.shades.main, 0.8),\r\n    borderRadius: 25,\r\n    top: 48,\r\n    marginTop: 2,\r\n    position: 'absolute',\r\n    height: 150,\r\n    zIndex: 100,\r\n    marginLeft: 2,\r\n    padding: [[2, 7, 2, 7]],\r\n    [breakpoints.down('sm')]: {\r\n      top: 'auto',\r\n      right: 48,\r\n      width: 150,\r\n      height: 'auto',\r\n      marginTop: -46,\r\n      marginBottom: 2,\r\n      padding: [[4, 2, 4, 2]],\r\n    },\r\n  },\r\n});\r\n\r\nclass ImageTool extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      open: props.open,\r\n    };\r\n    this.handleChange = this.handleChange.bind(this);\r\n    this.handleClick = this.handleClick.bind(this);\r\n  }\r\n\r\n  handleClick() {\r\n    const { value, variant } = this.props;\r\n    switch (variant) {\r\n      case 'toggle':\r\n        this.handleChange({}, value === 0 ? 100 : 0);\r\n        break;\r\n      default:\r\n        this.setState((state) => ({\r\n          open: !state.open,\r\n        }));\r\n    }\r\n  }\r\n\r\n  handleChange(e, val) {\r\n    const { onChange } = this.props;\r\n    onChange(val);\r\n  }\r\n\r\n  render() {\r\n    const {\r\n      children, containerId, label, max, min, value, type, variant, windowId,\r\n      foregroundColor, classes, width,\r\n    } = this.props;\r\n    const { open } = this.state;\r\n\r\n    const toggled = variant === 'toggle' && value > 0;\r\n\r\n    const id = `${windowId}-${type}`;\r\n\r\n    let bubbleBg;\r\n    if (open || toggled) {\r\n      bubbleBg = fade(foregroundColor, open ? 0.1 : 0.25);\r\n    }\r\n\r\n    return (\r\n      <div style={{ display: 'inline-block' }}>\r\n        <MiradorMenuButton\r\n          id={`${id}-label`}\r\n          aria-label={label}\r\n          containerId={containerId}\r\n          onClick={this.handleClick}\r\n          aria-expanded={open}\r\n          aria-controls={id}\r\n          style={{ backgroundColor: bubbleBg }}\r\n        >\r\n          {children}\r\n        </MiradorMenuButton>\r\n\r\n        {open && (\r\n        <div\r\n          id={id}\r\n          aria-labelledby={`${id}-label`}\r\n          className={`MuiPaper-elevation4 ${classes.slider}`}\r\n        >\r\n          <Slider\r\n            orientation={['xs', 'sm'].indexOf(width) >= 0 ? 'horizontal' : 'vertical'}\r\n            min={min}\r\n            max={max}\r\n            value={value}\r\n            onChange={this.handleChange}\r\n          />\r\n        </div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nImageTool.propTypes = {\r\n  children: PropTypes.node.isRequired,\r\n  // eslint-disable-next-line react/forbid-prop-types\r\n  classes: PropTypes.object.isRequired,\r\n  containerId: PropTypes.string.isRequired,\r\n  foregroundColor: PropTypes.string,\r\n  label: PropTypes.string.isRequired,\r\n  min: PropTypes.number,\r\n  max: PropTypes.number,\r\n  onChange: PropTypes.func.isRequired,\r\n  open: PropTypes.bool,\r\n  type: PropTypes.string.isRequired,\r\n  value: PropTypes.number.isRequired,\r\n  variant: PropTypes.string,\r\n  windowId: PropTypes.string.isRequired,\r\n  width: PropTypes.oneOf(['lg', 'md', 'sm', 'xl', 'xs']).isRequired,\r\n};\r\n\r\nImageTool.defaultProps = {\r\n  foregroundColor: 'rgb(0, 0, 0)',\r\n  min: 0,\r\n  max: 100,\r\n  open: false,\r\n  variant: 'slider',\r\n};\r\n\r\nexport default compose(withStyles(styles), withWidth())(ImageTool);\r\n","import React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { MiradorMenuButton } from 'mirador/dist/es/src/components/MiradorMenuButton';\r\nimport RotateRightIcon from '@material-ui/icons/RotateRight';\r\nimport RotateLeftIcon from '@material-ui/icons/RotateLeft';\r\n\r\nexport default class ImageRotation extends Component {\r\n  render() {\r\n    const { label, variant, ...otherProps } = this.props;\r\n    return (\r\n      <MiradorMenuButton\r\n        aria-label={label}\r\n        {...otherProps}\r\n      >\r\n        { variant === 'left' ? <RotateLeftIcon /> : <RotateRightIcon /> }\r\n      </MiradorMenuButton>\r\n    );\r\n  }\r\n}\r\n\r\nImageRotation.propTypes = {\r\n  containerId: PropTypes.string.isRequired,\r\n  label: PropTypes.string.isRequired,\r\n  variant: PropTypes.string.isRequired,\r\n};\r\n","import React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { MiradorMenuButton } from 'mirador/dist/es/src/components/MiradorMenuButton';\r\nimport SwapHorizIcon from '@material-ui/icons/SwapHoriz';\r\nimport { fade } from '@material-ui/core/styles/colorManipulator';\r\n\r\nexport default class ImageFlip extends Component {\r\n  render() {\r\n    const {\r\n      flipped, label, backgroundColor, foregroundColor, ...otherProps\r\n    } = this.props;\r\n\r\n    return (\r\n      <MiradorMenuButton\r\n        aria-label={label}\r\n        style={{ backgroundColor: flipped && fade(foregroundColor, 0.25) }}\r\n        {...otherProps}\r\n      >\r\n        <SwapHorizIcon style={{ color: flipped && backgroundColor }} />\r\n      </MiradorMenuButton>\r\n    );\r\n  }\r\n}\r\n\r\nImageFlip.propTypes = {\r\n  backgroundColor: PropTypes.string,\r\n  containerId: PropTypes.string.isRequired,\r\n  foregroundColor: PropTypes.string,\r\n  flipped: PropTypes.bool.isRequired,\r\n  label: PropTypes.string.isRequired,\r\n};\r\n\r\nImageFlip.defaultProps = {\r\n  backgroundColor: 'rgb(255, 255, 255)',\r\n  foregroundColor: 'rgb(0, 0, 0)',\r\n};\r\n","import React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport compose from 'lodash/flowRight';\r\nimport BrightnessIcon from '@material-ui/icons/Brightness5';\r\nimport TonalityIcon from '@material-ui/icons/Tonality';\r\nimport GradientIcon from '@material-ui/icons/Gradient';\r\nimport ContrastIcon from '@material-ui/icons/ExposureSharp';\r\nimport InvertColorsIcon from '@material-ui/icons/InvertColors';\r\nimport TuneSharpIcon from '@material-ui/icons/TuneSharp';\r\nimport CloseSharpIcon from '@material-ui/icons/CloseSharp';\r\nimport ReplaySharpIcon from '@material-ui/icons/ReplaySharp';\r\nimport { fade } from '@material-ui/core/styles/colorManipulator';\r\nimport withStyles from '@material-ui/core/styles/withStyles';\r\nimport withWidth from '@material-ui/core/withWidth';\r\nimport { MiradorMenuButton } from 'mirador/dist/es/src/components/MiradorMenuButton';\r\nimport ImageTool from './ImageTool';\r\nimport ImageRotation from './ImageRotation';\r\nimport ImageFlip from './ImageFlip';\r\n\r\n/** Styles for withStyles HOC */\r\nconst styles = ({ breakpoints, palette }) => {\r\n  const backgroundColor = palette.shades.main;\r\n  const foregroundColor = palette.getContrastText(backgroundColor);\r\n  const border = `1px solid ${fade(foregroundColor, 0.2)}`;\r\n  const borderImageRight = 'linear-gradient('\r\n    + 'to bottom, '\r\n    + `${fade(foregroundColor, 0)} 20%, `\r\n    + `${fade(foregroundColor, 0.2)} 20% 80%, `\r\n    + `${fade(foregroundColor, 0)} 80% )`;\r\n  const borderImageBottom = borderImageRight.replace('to bottom', 'to right');\r\n  return {\r\n    root: {\r\n      backgroundColor: fade(backgroundColor, 0.8),\r\n      borderRadius: 25,\r\n      position: 'absolute',\r\n      top: 8,\r\n      right: 8,\r\n      zIndex: 999,\r\n      display: 'flex',\r\n      flexDirection: 'row',\r\n      [breakpoints.down('sm')]: {\r\n        flexDirection: 'column',\r\n      },\r\n    },\r\n    borderContainer: {\r\n      border: 0,\r\n      borderRight: border,\r\n      borderImageSlice: 1,\r\n      borderImageSource: borderImageRight,\r\n      display: 'flex',\r\n      flexDirection: 'row',\r\n      [breakpoints.down('sm')]: {\r\n        flexDirection: 'column',\r\n        borderBottom: border,\r\n        borderRight: 'none',\r\n        borderImageSource: borderImageBottom,\r\n      },\r\n    },\r\n    toggleButtonLabel : {\r\n      fontSize: '0.8rem'\r\n    }\r\n  };\r\n};\r\n\r\nclass MiradorImageTools extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.toggleState = this.toggleState.bind(this);\r\n    this.toggleRotate = this.toggleRotate.bind(this);\r\n    this.toggleFlip = this.toggleFlip.bind(this);\r\n    this.handleChange = this.handleChange.bind(this);\r\n    this.handleReset = this.handleReset.bind(this);\r\n  }\r\n\r\n  componentDidMount() {\r\n    const { viewer } = this.props;\r\n    if (viewer) this.applyFilters();\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    const { viewConfig, viewer } = this.props;\r\n    if (viewer && viewConfig !== prevProps.viewConfig) this.applyFilters();\r\n  }\r\n\r\n  handleChange(param) {\r\n    const { updateViewport, windowId } = this.props;\r\n    return (value) => updateViewport(windowId, { [param]: value });\r\n  }\r\n\r\n  handleReset() {\r\n    const { updateViewport, windowId } = this.props;\r\n    const viewConfig = {\r\n      rotation: 0,\r\n      flip: false,\r\n      brightness: 100,\r\n      contrast: 100,\r\n      saturate: 100,\r\n      grayscale: 0,\r\n      invert: 0,\r\n    };\r\n\r\n    updateViewport(windowId, viewConfig);\r\n  }\r\n\r\n  applyFilters() {\r\n    const {\r\n      viewConfig: {\r\n        brightness = 100,\r\n        contrast = 100,\r\n        saturate = 100,\r\n        grayscale = 0,\r\n        invert = 0,\r\n      },\r\n      viewer: { canvas },\r\n    } = this.props;\r\n\r\n    if (!canvas) return;\r\n\r\n    const controlledFilters = ['brightness', 'contrast', 'saturate', 'grayscale', 'invert'];\r\n\r\n    const currentFilters = canvas.style.filter.split(' ');\r\n    const newFilters = currentFilters.filter(\r\n      (filter) => !controlledFilters.some((type) => filter.includes(type)),\r\n    );\r\n    newFilters.push(`brightness(${brightness}%)`);\r\n    newFilters.push(`contrast(${contrast}%)`);\r\n    newFilters.push(`saturate(${saturate}%)`);\r\n    newFilters.push(`grayscale(${grayscale}%)`);\r\n    newFilters.push(`invert(${invert}%)`);\r\n    canvas.style.filter = newFilters.join(' ');\r\n  }\r\n\r\n  toggleState() {\r\n    const { open, updateWindow, windowId } = this.props;\r\n\r\n    updateWindow(windowId, { imageToolsOpen: !open });\r\n  }\r\n\r\n  toggleRotate(value) {\r\n    const { updateViewport, viewConfig: { flip = false, rotation = 0 }, windowId } = this.props;\r\n\r\n    const offset = flip ? -1 * value : value;\r\n\r\n    updateViewport(windowId, { rotation: (rotation + offset) % 360 });\r\n  }\r\n\r\n  toggleFlip() {\r\n    const { updateViewport, viewConfig: { flip = false }, windowId } = this.props;\r\n\r\n    updateViewport(windowId, { flip: !flip });\r\n  }\r\n\r\n  render() {\r\n    const {\r\n      classes, containerId, enabled, open, viewer, windowId, width,\r\n      theme: { palette },\r\n      viewConfig: {\r\n        flip = false,\r\n        brightness = 100,\r\n        contrast = 100,\r\n        saturate = 100,\r\n        grayscale = 0,\r\n        invert = 0,\r\n      },\r\n      t,\r\n    } = this.props;\r\n\r\n    if (!viewer || !enabled) return null;\r\n\r\n    const backgroundColor = palette.shades.main;\r\n    const foregroundColor = palette.getContrastText(backgroundColor);\r\n    const isSmallDisplay = ['xs', 'sm'].indexOf(width) >= 0;\r\n\r\n    /** Button for toggling the menu */\r\n    const toggleButton = (\r\n      <div className={(isSmallDisplay && open) ? classes.borderContainer : ''}>\r\n        <MiradorMenuButton\r\n          aria-expanded={open}\r\n          aria-haspopup\r\n          aria-label={t('collapse', { context: open ? 'open' : 'close' })}\r\n          containerId={containerId}\r\n          onClick={this.toggleState}\r\n        >\r\n          { open ? <CloseSharpIcon /> : <TuneSharpIcon /> }\r\n          { open ? \"\" : <label className={classes.toggleButtonLabel}>Image Tools</label> }\r\n          \r\n        </MiradorMenuButton>\r\n      </div>\r\n    );\r\n    return (\r\n      <div className={`MuiPaper-elevation4 ${classes.root}`}>\r\n        {isSmallDisplay && toggleButton}\r\n        {open\r\n        && (\r\n        <React.Fragment>\r\n          <div className={classes.borderContainer}>\r\n            <ImageRotation\r\n              containerId={containerId}\r\n              label={t('rotateRight')}\r\n              onClick={() => this.toggleRotate(90)}\r\n              variant=\"right\"\r\n            />\r\n            <ImageRotation\r\n              containerId={containerId}\r\n              label={t('rotateLeft')}\r\n              onClick={() => this.toggleRotate(-90)}\r\n              variant=\"left\"\r\n            />\r\n            <ImageFlip\r\n              label={t('flip')}\r\n              onClick={this.toggleFlip}\r\n              flipped={flip}\r\n              containerId={containerId}\r\n            />\r\n          </div>\r\n          <div className={classes.borderContainer}>\r\n            <ImageTool\r\n              type=\"brightness\"\r\n              label={t('brightness')}\r\n              max={200}\r\n              windowId={windowId}\r\n              value={brightness}\r\n              foregroundColor={foregroundColor}\r\n              containerId={containerId}\r\n              onChange={this.handleChange('brightness')}\r\n            >\r\n              <BrightnessIcon />\r\n            </ImageTool>\r\n            <ImageTool\r\n              type=\"contrast\"\r\n              label={t('contrast')}\r\n              max={200}\r\n              windowId={windowId}\r\n              value={contrast}\r\n              foregroundColor={foregroundColor}\r\n              containerId={containerId}\r\n              onChange={this.handleChange('contrast')}\r\n            >\r\n              <ContrastIcon style={{ transform: 'rotate(180deg)' }} />\r\n            </ImageTool>\r\n            <ImageTool\r\n              type=\"saturate\"\r\n              label={t('saturation')}\r\n              max={200}\r\n              windowId={windowId}\r\n              value={saturate}\r\n              foregroundColor={foregroundColor}\r\n              containerId={containerId}\r\n              onChange={this.handleChange('saturate')}\r\n            >\r\n              <GradientIcon />\r\n            </ImageTool>\r\n            <ImageTool\r\n              type=\"grayscale\"\r\n              variant=\"toggle\"\r\n              label={t('greyscale')}\r\n              windowId={windowId}\r\n              value={grayscale}\r\n              backgroundColor={backgroundColor}\r\n              foregroundColor={foregroundColor}\r\n              containerId={containerId}\r\n              onChange={this.handleChange('grayscale')}\r\n            >\r\n              <TonalityIcon />\r\n            </ImageTool>\r\n            <ImageTool\r\n              type=\"invert\"\r\n              variant=\"toggle\"\r\n              label={t('invert')}\r\n              windowId={windowId}\r\n              value={invert}\r\n              foregroundColor={foregroundColor}\r\n              containerId={containerId}\r\n              onChange={this.handleChange('invert')}\r\n            >\r\n              <InvertColorsIcon />\r\n            </ImageTool>\r\n          </div>\r\n          <div className={isSmallDisplay ? '' : classes.borderContainer}>\r\n            <MiradorMenuButton\r\n              aria-label={t('revert')}\r\n              containerId={containerId}\r\n              onClick={this.handleReset}\r\n            >\r\n              <ReplaySharpIcon />\r\n            </MiradorMenuButton>\r\n          </div>\r\n        </React.Fragment>\r\n        )}\r\n        {!isSmallDisplay && toggleButton}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nMiradorImageTools.propTypes = {\r\n  classes: PropTypes.object.isRequired, // eslint-disable-line react/forbid-prop-types\r\n  containerId: PropTypes.string.isRequired,\r\n  enabled: PropTypes.bool,\r\n  open: PropTypes.bool,\r\n  t: PropTypes.func.isRequired,\r\n  theme: PropTypes.object.isRequired, // eslint-disable-line react/forbid-prop-types\r\n  updateViewport: PropTypes.func.isRequired,\r\n  updateWindow: PropTypes.func.isRequired,\r\n  viewer: PropTypes.object, // eslint-disable-line react/forbid-prop-types\r\n  viewConfig: PropTypes.object, // eslint-disable-line react/forbid-prop-types\r\n  windowId: PropTypes.string.isRequired,\r\n  width: PropTypes.oneOf(['lg', 'md', 'sm', 'xl', 'xs']).isRequired,\r\n};\r\n\r\nMiradorImageTools.defaultProps = {\r\n  enabled: true,\r\n  open: true,\r\n  viewer: undefined,\r\n  viewConfig: {},\r\n};\r\n\r\n// Export without wrapping HOC for testing.\r\nexport const TestableImageTools = MiradorImageTools;\r\n\r\nexport default compose(withStyles(styles), withWidth())(MiradorImageTools);\r\n","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\r\nimport ListItemText from '@material-ui/core/ListItemText';\r\nimport TuneSharpIcon from '@material-ui/icons/TuneSharp';\r\n\r\nconst MiradorImageToolsMenuItem = ({\r\n  enabled, handleClose, t, updateWindow, windowId,\r\n}) => {\r\n  const handleClickOpen = () => {\r\n    handleClose();\r\n    updateWindow(windowId, { imageToolsEnabled: !enabled });\r\n  };\r\n\r\n  return (\r\n    <MenuItem onClick={handleClickOpen}>\r\n      <ListItemIcon>\r\n        <TuneSharpIcon />\r\n      </ListItemIcon>\r\n      <ListItemText primaryTypographyProps={{ variant: 'body1' }}>\r\n        { enabled ? t('hide') : t('show') }\r\n      </ListItemText>\r\n    </MenuItem>\r\n  );\r\n};\r\n\r\nMiradorImageToolsMenuItem.propTypes = {\r\n  enabled: PropTypes.bool,\r\n  handleClose: PropTypes.func.isRequired,\r\n  t: PropTypes.func.isRequired,\r\n  updateWindow: PropTypes.func.isRequired,\r\n  windowId: PropTypes.string.isRequired,\r\n};\r\n\r\nMiradorImageToolsMenuItem.defaultProps = {\r\n  enabled: true,\r\n};\r\n\r\nexport default MiradorImageToolsMenuItem;\r\n","const translations = {\r\n  de: {\r\n    brightness: 'Helligkeit',\r\n    collapse_open: 'Bildbearbeitung ausblenden',\r\n    collapse_close: 'Bildbearbeitung einblenden',\r\n    contrast: 'Kontrast',\r\n    flip: 'Spiegeln',\r\n    greyscale: 'Darstellung in Graustufen',\r\n    hide: 'Bildbearbeitung verbergen',\r\n    invert: 'Umkehrung der Farben',\r\n    revert: 'Einstellungen zurücksetzen',\r\n    rotateLeft: 'Rotation links',\r\n    rotateRight: 'Rotation rechts',\r\n    saturation: 'Sättigung',\r\n    show: 'Bildbearbeitung anzeigen',\r\n  },\r\n  en: {\r\n    brightness: 'Brightness',\r\n    collapse_open: 'Collapse image tools',\r\n    collapse_close: 'Expand image tools',\r\n    contrast: 'Contrast',\r\n    flip: 'Flip',\r\n    greyscale: 'Greyscale',\r\n    hide: 'Hide image tools',\r\n    invert: 'Invert colors',\r\n    revert: 'Revert image',\r\n    rotateLeft: 'Rotate left',\r\n    rotateRight: 'Rotate right',\r\n    saturation: 'Saturation',\r\n    show: 'Show image tools',\r\n  },\r\n  it: {\r\n    brightness: 'Luminosità',\r\n    collapse_open: 'Chiudere gli strumenti dell\\'immagine',\r\n    collapse_close: 'Espandi gli strumenti dell\\'immagine',\r\n    contrast: 'Contrasto',\r\n    flip: 'Inverti',\r\n    greyscale: 'Scala di grigio',\r\n    hide: 'Nascondi gli strumenti dell\\'immagine',\r\n    invert: 'Inverti colori',\r\n    revert: 'Ripristinare l\\'immagine',\r\n    rotateLeft: 'Ruota a sinistra',\r\n    rotateRight: 'Ruota a destra',\r\n    saturation: 'Saturazione',\r\n    show: 'Mostra gli strumenti dell\\'immagine',\r\n  },\r\n  fr: {\r\n    brightness: 'Luminosité',\r\n    collapse_open: 'Fermer les outils d\\'image',\r\n    collapse_close: 'Ouvrir les outils d\\'image',\r\n    contrast: 'Contraste',\r\n    flip: 'Miroir',\r\n    greyscale: 'Niveaux de gris',\r\n    hide: 'Masquer les outils d\\'image',\r\n    invert: 'Inverser les couleurs',\r\n    revert: 'Réinitialiser les réglages',\r\n    rotateLeft: 'Rotation vers la gauche',\r\n    rotateRight: 'Rotation vers la droite',\r\n    saturation: 'Saturation',\r\n    show: 'Afficher les outils d\\'image',\r\n  },\r\n  ja: {\r\n    brightness: '明るさ',\r\n    collapse_open: '画像ツールを畳む',\r\n    collapse_close: '画像ツールを開く',\r\n    contrast: 'コントラスト',\r\n    flip: 'フリップ',\r\n    greyscale: 'グレースケール',\r\n    hide: '画像ツールを隠す',\r\n    invert: '色を反転',\r\n    revert: '元に戻す',\r\n    rotateLeft: '左回転',\r\n    rotateRight: '右回転',\r\n    saturation: '彩度',\r\n    show: '画像ツールを表示',\r\n  },\r\n  sr: {\r\n    brightness: 'Осветљење',\r\n    collapse_open: 'Затворите алат',\r\n    collapse_close: 'Отворите алат',\r\n    contrast: 'Контраст',\r\n    flip: 'Окрени',\r\n    greyscale: 'Црнобело',\r\n    hide: 'Сакријте алат',\r\n    invert: 'Инверзија боја',\r\n    revert: 'Поништи подешавања',\r\n    rotateLeft: 'Ротирај лево',\r\n    rotateRight: 'Ротирај десно',\r\n    saturation: 'Сатурација',\r\n    show: 'Прикажите алат',\r\n  },\r\n  'zh-CN': {\r\n    brightness: '亮度',\r\n    collapse_open: '折叠图像工具',\r\n    collapse_close: '展开图像工具',\r\n    contrast: '对比度',\r\n    flip: '翻转',\r\n    greyscale: '灰度',\r\n    hide: '隐藏图像工具',\r\n    invert: '反转颜色',\r\n    revert: '还原图像',\r\n    rotateLeft: '向左旋转',\r\n    rotateRight: '向右旋转',\r\n    saturation: '饱和度',\r\n    show: '显示图像工具',\r\n  },\r\n  'zh-TW': {\r\n    brightness: '亮度',\r\n    collapse_open: '折疊圖像工具',\r\n    collapse_close: '展開圖像工具',\r\n    contrast: '對比度',\r\n    flip: '翻轉',\r\n    greyscale: '灰度',\r\n    hide: '隱藏圖像工具',\r\n    invert: '反轉顏色',\r\n    revert: '還原圖像',\r\n    rotateLeft: '向左旋轉',\r\n    rotateRight: '向右旋轉',\r\n    saturation: '飽和度',\r\n    show: '顯示圖像工具',\r\n  },\r\n};\r\n\r\nexport default translations;\r\n","import withTheme from '@material-ui/core/styles/withTheme';\r\nimport * as actions from 'mirador/dist/es/src/state/actions';\r\nimport { getWindowConfig, getViewer, getContainerId } from 'mirador/dist/es/src/state/selectors';\r\nimport MiradorImageTools from './MiradorImageTools';\r\nimport MiradorImageToolsMenuItem from './MiradorImageToolsMenuItem';\r\nimport translations from './translations';\r\n\r\nexport default [\r\n  {\r\n    target: 'OpenSeadragonViewer',\r\n    mapDispatchToProps: {\r\n      updateWindow: actions.updateWindow,\r\n      updateViewport: actions.updateViewport,\r\n    },\r\n    mapStateToProps: (state, { windowId }) => ({\r\n      containerId: getContainerId(state),\r\n      enabled: getWindowConfig(state, { windowId }).imageToolsEnabled || true,\r\n      open: getWindowConfig(state, { windowId }).imageToolsOpen || false,\r\n      viewConfig: getViewer(state, { windowId }) || {},\r\n    }),\r\n    mode: 'add',\r\n    component: withTheme(MiradorImageTools),\r\n    config: {\r\n      translations,\r\n    },\r\n  },\r\n  {\r\n    target: 'WindowTopBarPluginMenu',\r\n    component: MiradorImageToolsMenuItem,\r\n    mode: 'add',\r\n    mapDispatchToProps: {\r\n      updateWindow: actions.updateWindow,\r\n    },\r\n    mapStateToProps: (state, { windowId }) => ({\r\n      enabled: getWindowConfig(state, { windowId }).imageToolsEnabled || false,\r\n    }),\r\n  },\r\n];\r\n","import React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\r\nimport ListItemText from '@material-ui/core/ListItemText';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport DownloadIcon from '@material-ui/icons/VerticalAlignBottomSharp';\r\nimport {\r\n  getCanvasIndex, \r\n  getCurrentCanvas,\r\n} from 'mirador/dist/es/src/state/selectors'\r\n\r\n\r\n\r\nfunction downloadFile(url, filename) {\r\n  fetch(url, {\r\n      method: 'GET'\r\n  })\r\n  .then(response => response.blob())\r\n  .then(blob => {\r\n      var url = window.URL.createObjectURL(blob);\r\n      var a = document.createElement('a');\r\n      a.href = url;\r\n      a.download = filename;\r\n      document.body.appendChild(a); // we need to append the element to the dom -> otherwise it will not work in firefox\r\n      a.click();    \r\n      a.remove();  //afterwards we remove the element again         \r\n  });\r\n}\r\n\r\nclass FullResDownload extends Component {\r\n  downloadAndCloseMenu() {\r\n    const { handleClose, canvasIndex, manifestId, canvas } = this.props;\r\n    console.log(\"c\", canvas)\r\n    console.log(\"m\", manifestId)\r\n    let page = canvasIndex + 1\r\n    downloadFile(canvas.__jsonld.items[0].items[0].body.id, \"oocihm.84056.\"+page+\".jpg\") \r\n    handleClose()\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <React.Fragment>\r\n        <MenuItem \r\n        tabIndex=\"0\"\r\n        onClick={() => this.downloadAndCloseMenu()}>\r\n          <ListItemIcon>\r\n            <DownloadIcon />\r\n          </ListItemIcon>\r\n          <ListItemText primaryTypographyProps={{ variant: 'body1' }}>\r\n            Current image in full resolution\r\n          </ListItemText>\r\n        </MenuItem>\r\n      </React.Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nFullResDownload.propTypes = {\r\n  handleClose: PropTypes.func,\r\n  canvasIndex: PropTypes.number,\r\n  canvas: PropTypes.object,\r\n  manifestId: PropTypes.string\r\n};\r\n\r\nFullResDownload.defaultProps = {\r\n  handleClose: () => {}\r\n};\r\n\r\n/**\r\n * mapStateToProps - to hook up connect\r\n * @memberof Window\r\n * @private\r\n */\r\nconst mapStateToProps = (state, props) => {\r\n  const { windowId } = props;\r\n  const canvasIndex = getCanvasIndex(state, { windowId })\r\n  const canvas = getCurrentCanvas(state, { windowId })\r\n  const manifestId = state.windows[windowId].manifestId\r\n  return {\r\n    canvasIndex,\r\n    canvas,\r\n    manifestId\r\n  };\r\n};\r\n\r\nexport default {\r\n  target: 'WindowTopBarPluginMenu',\r\n  mode: 'add',\r\n  name: 'FullResDownloadPlugin',\r\n  component: FullResDownload,\r\n  mapStateToProps\r\n};","import React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\r\nimport ListItemText from '@material-ui/core/ListItemText';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport DownloadIcon from '@material-ui/icons/VerticalAlignBottomSharp';\r\nimport {\r\n  getCanvasIndex,\r\n} from 'mirador/dist/es/src/state/selectors'\r\n\r\nfunction downloadFile(url, filename) {\r\n  var a = document.createElement('a');\r\n  a.href = url;\r\n  a.download = filename;\r\n  document.body.appendChild(a); // we need to append the element to the dom -> otherwise it will not work in firefox\r\n  a.click();    \r\n  a.remove();  //afterwards we remove the element again       \r\n}\r\n\r\nclass PDFDownload extends Component {\r\n  downloadAndCloseMenu() {\r\n    const { handleClose, canvasIndex, manifestId } = this.props\r\n    const pathname = new URL(manifestId).pathname\r\n    const parts = pathname.split('/')\r\n    const id = parts[parts.length - 2]\r\n    console.log(\"/dl/\" + id)\r\n    fetch(\"/dl/\" + id, {\r\n      method: 'GET'\r\n    })\r\n    .then((response) => response.json())\r\n    .then(data => {\r\n      let page = canvasIndex + 1\r\n      console.log(\"data\", data)\r\n      if(data[\"canvasDownloadUris\"]?.length) {\r\n        downloadFile(data[\"canvasDownloadUris\"][canvasIndex], id + \".\" +page+\".pdf\") \r\n        handleClose() \r\n      } else {\r\n        alert(\"error\")\r\n      } \r\n    })\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <React.Fragment>\r\n        <MenuItem  \r\n        tabIndex=\"0\"\r\n        onClick={() => this.downloadAndCloseMenu()}>\r\n          <ListItemIcon>\r\n            <DownloadIcon />\r\n          </ListItemIcon>\r\n          <ListItemText primaryTypographyProps={{ variant: 'body1' }}>\r\n            Current image as a searchable PDF\r\n          </ListItemText>\r\n        </MenuItem>\r\n      </React.Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nPDFDownload.propTypes = {\r\n  handleClose: PropTypes.func,\r\n  canvasIndex: PropTypes.number,\r\n  manifestId: PropTypes.string\r\n};\r\n\r\nPDFDownload.defaultProps = {\r\n  handleClose: () => {}\r\n};\r\n\r\n/**\r\n * mapStateToProps - to hook up connect\r\n * @memberof Window\r\n * @private\r\n */\r\nconst mapStateToProps = (state, props) => {\r\n  const { windowId } = props;\r\n  const canvasIndex = getCanvasIndex(state, { windowId })\r\n  const  manifestId = state.windows[windowId].manifestId\r\n  return {\r\n    canvasIndex,\r\n    manifestId\r\n  };\r\n};\r\n\r\nexport default {\r\n  target: 'WindowTopBarPluginMenu',\r\n  mode: 'add',\r\n  name: 'PDFDownloadPlugin',\r\n  component: PDFDownload,\r\n  mapStateToProps\r\n};\r\n","import React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\r\nimport ListItemText from '@material-ui/core/ListItemText';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport DownloadIcon from '@material-ui/icons/VerticalAlignBottomSharp';\r\nimport {\r\n  getCanvasIndex,\r\n} from 'mirador/dist/es/src/state/selectors'\r\n\r\nfunction downloadFile(url, filename) {\r\n  var a = document.createElement('a');\r\n  a.href = url;\r\n  a.download = filename;\r\n  document.body.appendChild(a); // we need to append the element to the dom -> otherwise it will not work in firefox\r\n  a.click();    \r\n  a.remove();  //afterwards we remove the element again     \r\n}\r\n\r\nclass FullPDFDownload extends Component {\r\n  downloadAndCloseMenu() {\r\n    const { handleClose, manifestId } = this.props\r\n    const pathname = new URL(manifestId).pathname\r\n    const parts = pathname.split('/')\r\n    const id = parts[parts.length - 2]\r\n    console.log(\"/dl/\" + id)\r\n    fetch(\"/dl/\" + id, {\r\n      method: 'GET'\r\n    })\r\n    .then((response) => response.json())\r\n    .then(data => {\r\n      if(data[\"docPdfUri\"]?.length) {\r\n        downloadFile(data[\"docPdfUri\"], id + \".pdf\") \r\n        handleClose() \r\n      } else {\r\n        alert(\"error\")\r\n      } \r\n    })\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <React.Fragment>\r\n        <MenuItem \r\n        tabIndex=\"0\"\r\n        onClick={() => this.downloadAndCloseMenu()}>\r\n          <ListItemIcon>\r\n            <DownloadIcon />\r\n          </ListItemIcon>\r\n          <ListItemText primaryTypographyProps={{ variant: 'body1' }}>\r\n            All images as a searchable PDF\r\n          </ListItemText>\r\n        </MenuItem>\r\n      </React.Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nFullPDFDownload.propTypes = {\r\n  handleClose: PropTypes.func,\r\n  canvasIndex: PropTypes.number,\r\n  manifestId: PropTypes.string\r\n};\r\n\r\nFullPDFDownload.defaultProps = {\r\n  handleClose: () => {}\r\n};\r\n\r\n/**\r\n * mapStateToProps - to hook up connect\r\n * @memberof Window\r\n * @private\r\n */\r\nconst mapStateToProps = (state, props) => {\r\n  const { windowId } = props;\r\n  const canvasIndex = getCanvasIndex(state, { windowId })\r\n  const  manifestId = state.windows[windowId].manifestId\r\n  return {\r\n    canvasIndex,\r\n    manifestId\r\n  };\r\n};\r\n\r\nexport default {\r\n  target: 'WindowTopBarPluginMenu',\r\n  mode: 'add',\r\n  name: 'FullPDFDownloadPlugin',\r\n  component: FullPDFDownload,\r\n  mapStateToProps\r\n};\r\n","import React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\r\nimport ListItemText from '@material-ui/core/ListItemText';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport DownloadIcon from '@material-ui/icons/VerticalAlignBottomSharp';\r\n\r\nconst downloadDialogReducer = (state = {}, action) => {\r\n  if (action.type === 'OPEN_WINDOW_DIALOG') {\r\n    return {\r\n      ...state,\r\n      [action.windowId]: {\r\n        openDialog: action.dialogType,\r\n      },\r\n    };\r\n  }\r\n\r\n  if (action.type === 'CLOSE_WINDOW_DIALOG') {\r\n    return {\r\n      ...state,\r\n      [action.windowId]: {\r\n        openDialog: null,\r\n      },\r\n    };\r\n  }\r\n  return state;\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch, { windowId }) => ({\r\n  openDownloadDialog: () => dispatch({ type: 'OPEN_WINDOW_DIALOG', windowId, dialogType: 'download' }),\r\n});\r\n\r\nclass MiradorDownload extends Component {\r\n  openDialogAndCloseMenu() {\r\n    const { handleClose, openDownloadDialog } = this.props;\r\n\r\n    openDownloadDialog();\r\n    handleClose();\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <React.Fragment>\r\n        <MenuItem  \r\n        tabIndex=\"0\"\r\n        onClick={() => this.openDialogAndCloseMenu()}>\r\n          <ListItemIcon>\r\n            <DownloadIcon />\r\n          </ListItemIcon>\r\n          <ListItemText primaryTypographyProps={{ variant: 'body1' }}>\r\n            Current image in other resolutions\r\n          </ListItemText>\r\n        </MenuItem>\r\n      </React.Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nMiradorDownload.propTypes = {\r\n  handleClose: PropTypes.func,\r\n  openDownloadDialog: PropTypes.func,\r\n};\r\n\r\nMiradorDownload.defaultProps = {\r\n  handleClose: () => {},\r\n  openDownloadDialog: () => {},\r\n};\r\n\r\nexport default {\r\n  target: 'WindowTopBarPluginMenu',\r\n  mode: 'add',\r\n  name: 'MiradorDownloadPlugin',\r\n  component: MiradorDownload,\r\n  mapDispatchToProps,\r\n  reducers: {\r\n    windowDialogs: downloadDialogReducer,\r\n  },\r\n};\r\n","import React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport Link from '@material-ui/core/Link';\r\nimport ListItem from '@material-ui/core/ListItem';\r\nimport ListItemText from '@material-ui/core/ListItemText';\r\n\r\n/**\r\n * RenderingDownloadLink ~\r\n*/\r\nexport default class RenderingDownloadLink extends Component {\r\n  render() {\r\n    const { rendering } = this.props;\r\n    return (\r\n      <ListItem disableGutters divider key={rendering.id}>\r\n        <ListItemText primaryTypographyProps={{ variant: 'body1' }}>\r\n          <Link href={rendering.id} download rel=\"noopener noreferrer\" target=\"_blank\" variant=\"body1\">\r\n            {rendering.getLabel().getValue()}\r\n          </Link>\r\n          {rendering.getFormat()\r\n            && rendering.getFormat().value\r\n            && ` (${rendering.getFormat().value})`\r\n          }\r\n        </ListItemText>\r\n      </ListItem>\r\n    );\r\n  }\r\n}\r\n\r\nRenderingDownloadLink.propTypes = {\r\n  rendering: PropTypes.shape({\r\n    id: PropTypes.string.isRequired,\r\n    getLabel: PropTypes.func.isRequired,\r\n    getFormat: PropTypes.func.isRequired,\r\n  }).isRequired,\r\n};\r\n","import React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport Link from '@material-ui/core/Link';\r\nimport List from '@material-ui/core/List';\r\nimport ListItem from '@material-ui/core/ListItem';\r\nimport uniqBy from 'lodash/uniqBy';\r\nimport { OSDReferences } from 'mirador/dist/es/src/plugins/OSDReferences';\r\nimport RenderingDownloadLink from './RenderingDownloadLink';\r\n\r\n\r\n/**\r\n * CanvasDownloadLinks ~\r\n*/\r\nexport default class CanvasDownloadLinks extends Component {\r\n  zoomedImageLabel() {\r\n    const bounds = this.currentBounds();\r\n    return `Zoomed region (${Math.floor(bounds.width)} x ${Math.floor(bounds.height)}px)`;\r\n  }\r\n\r\n  fullImageLabel() {\r\n    const { canvas } = this.props;\r\n\r\n    return `Whole image (${canvas.getWidth()} x ${canvas.getHeight()}px)`;\r\n  }\r\n\r\n  smallImageLabel() {\r\n    const { canvas } = this.props;\r\n\r\n    return `Whole image (1000 x ${Math.floor((1000 * canvas.getHeight()) / canvas.getWidth())}px)`;\r\n  }\r\n\r\n  zoomedImageUrl() {\r\n    const { canvas } = this.props;\r\n    const bounds = this.currentBounds();\r\n    const boundsUrl = canvas.getCanonicalImageUri().replace(\r\n      /\\/full\\/.*\\/0\\//,\r\n      `/${bounds.x},${bounds.y},${bounds.width},${bounds.height}/full/0/`,\r\n    );\r\n\r\n    return `${boundsUrl}?download=true`;\r\n  }\r\n\r\n  imageUrlForSize(size) {\r\n    const { canvas } = this.props;\r\n\r\n    return `${canvas.getCanonicalImageUri(size.width)}?download=true`;\r\n  }\r\n\r\n  fullImageUrl() {\r\n    const { canvas } = this.props;\r\n\r\n    return `${canvas.getCanonicalImageUri().replace(/\\/full\\/.*\\/0\\//, '/full/full/0/')}?download=true`;\r\n  }\r\n\r\n  thousandPixelWideImage() {\r\n    const { canvas } = this.props;\r\n\r\n    return `${canvas.getCanonicalImageUri('1000')}?download=true`;\r\n  }\r\n\r\n  osdViewport() {\r\n    const { windowId } = this.props;\r\n\r\n    return OSDReferences.get(windowId).current.viewport;\r\n  }\r\n\r\n  currentBounds() {\r\n    const bounds = this.osdViewport().getBounds();\r\n\r\n    return Object.keys(bounds).reduce((object, key) => {\r\n      object[key] = Math.ceil(bounds[key]); // eslint-disable-line no-param-reassign\r\n      return object;\r\n    }, {});\r\n  }\r\n\r\n  definedSizesRestrictsDownload() {\r\n    const { infoResponse } = this.props;\r\n    if (!infoResponse.json) return false;\r\n    const { height, width } = infoResponse.json;\r\n\r\n    if (this.definedSizes().length !== 1) return false;\r\n\r\n    return this.definedSizes()[0].width <= width\r\n           && this.definedSizes()[0].height <= height;\r\n  }\r\n\r\n  displayCurrentZoomLink() {\r\n    const { restrictDownloadOnSizeDefinition, infoResponse, viewType } = this.props;\r\n\r\n    if (viewType !== 'single') return false;\r\n    if (restrictDownloadOnSizeDefinition && this.definedSizesRestrictsDownload()) return false;\r\n    if (!(infoResponse && infoResponse.json)) return false;\r\n\r\n    const bounds = this.currentBounds();\r\n    return bounds.height < infoResponse.json.height\r\n      && bounds.width < infoResponse.json.width\r\n      && bounds.x >= 0\r\n      && bounds.y >= 0;\r\n  }\r\n\r\n  /**\r\n   * This only returns unique sizes\r\n  */\r\n  definedSizes() {\r\n    const { infoResponse } = this.props;\r\n    if (!(infoResponse && infoResponse.json && infoResponse.json.sizes)) return [];\r\n\r\n    return uniqBy(infoResponse.json.sizes, size => `${size.width}${size.height}`);\r\n  }\r\n\r\n  fullImageLink() {\r\n    return (\r\n      <ListItem disableGutters divider key={this.fullImageUrl()}>\r\n        <Link href={this.fullImageUrl()} rel=\"noopener noreferrer\" target=\"_blank\" variant=\"body1\">\r\n          {this.fullImageLabel()}\r\n        </Link>\r\n      </ListItem>\r\n    );\r\n  }\r\n\r\n  thousandPixelWideLink() {\r\n    const { canvas } = this.props;\r\n\r\n    if (canvas.getWidth() < 1000) return '';\r\n\r\n    return (\r\n      <ListItem disableGutters divider key={this.thousandPixelWideImage()}>\r\n        <Link href={this.thousandPixelWideImage()} rel=\"noopener noreferrer\" target=\"_blank\" variant=\"body1\">\r\n          {this.smallImageLabel()}\r\n        </Link>\r\n      </ListItem>\r\n    );\r\n  }\r\n\r\n  linksForDefinedSizes() {\r\n    return (\r\n      this.definedSizes().map(size => (\r\n        <ListItem disableGutters divider key={`${size.width}${size.height}`}>\r\n          <Link href={this.imageUrlForSize(size)} rel=\"noopener noreferrer\" target=\"_blank\" variant=\"body1\">\r\n            {`Whole image (${size.width} x ${size.height}px)`}\r\n          </Link>\r\n        </ListItem>\r\n      ))\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Returns the rendered component\r\n  */\r\n  render() {\r\n    const {\r\n      canvas,\r\n      canvasLabel,\r\n      classes,\r\n    } = this.props;\r\n\r\n    return (\r\n      <React.Fragment>\r\n        <Typography noWrap variant=\"h3\" className={classes.h3}>{canvasLabel}</Typography>\r\n        <List>\r\n          {this.displayCurrentZoomLink()\r\n            && (\r\n              <ListItem disableGutters divider>\r\n                <Link href={this.zoomedImageUrl()} download rel=\"noopener noreferrer\" target=\"_blank\" variant=\"body1\">\r\n                  {this.zoomedImageLabel()}\r\n                </Link>\r\n              </ListItem>\r\n            )\r\n          }\r\n          {this.definedSizes().length === 0\r\n            && ([this.fullImageLink(), this.thousandPixelWideLink()])}\r\n          {this.definedSizes().length > 0\r\n            && (this.linksForDefinedSizes())}\r\n          {canvas.getRenderings().map(rendering => (\r\n            <RenderingDownloadLink rendering={rendering} key={rendering.id} />\r\n          ))}\r\n        </List>\r\n      </React.Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nCanvasDownloadLinks.propTypes = {\r\n  canvas: PropTypes.shape({\r\n    id: PropTypes.string.isRequired,\r\n    getCanonicalImageUri: PropTypes.func.isRequired,\r\n    getHeight: PropTypes.func.isRequired,\r\n    getRenderings: PropTypes.func.isRequired,\r\n    getWidth: PropTypes.func.isRequired,\r\n  }).isRequired,\r\n  canvasLabel: PropTypes.string.isRequired, // canvasLabel is passed because we need access to redux\r\n  classes: PropTypes.shape({\r\n    h3: PropTypes.string,\r\n  }).isRequired,\r\n  infoResponse: PropTypes.shape({\r\n    json: PropTypes.shape({\r\n      height: PropTypes.number,\r\n      sizes: PropTypes.arrayOf(\r\n        PropTypes.shape({ height: PropTypes.number, width: PropTypes.number }),\r\n      ),\r\n      width: PropTypes.number,\r\n    }),\r\n  }).isRequired,\r\n  restrictDownloadOnSizeDefinition: PropTypes.bool.isRequired,\r\n  viewType: PropTypes.string.isRequired,\r\n  windowId: PropTypes.string.isRequired,\r\n};\r\n","import React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport List from '@material-ui/core/List';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport RenderingDownloadLink from './RenderingDownloadLink';\r\n\r\n/**\r\n * ManifestDownloadLinks ~\r\n*/\r\nexport default class ManifestDownloadLinks extends Component {\r\n  /**\r\n   * Returns the rendered component\r\n  */\r\n  render() {\r\n    const { classes, renderings } = this.props;\r\n\r\n    return (\r\n      <React.Fragment>\r\n        <Typography variant=\"h3\" className={classes.h3}>Other Resolutions</Typography>\r\n        <List>\r\n          {renderings.map(rendering => (\r\n            <RenderingDownloadLink rendering={rendering} key={rendering.id} />\r\n          ))}\r\n        </List>\r\n      </React.Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nManifestDownloadLinks.propTypes = {\r\n  classes: PropTypes.shape({\r\n    h3: PropTypes.string,\r\n  }).isRequired,\r\n  renderings: PropTypes.array.isRequired, // eslint-disable-line react/forbid-prop-types\r\n};\r\n","import React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { withStyles } from '@material-ui/core/styles';\r\nimport Button from '@material-ui/core/Button';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport { getCanvasLabel, getVisibleCanvases, selectInfoResponse } from 'mirador/dist/es/src/state/selectors/canvases';\r\nimport { getWindowViewType } from 'mirador/dist/es/src/state/selectors/windows';\r\nimport { getManifestoInstance } from 'mirador/dist/es/src/state/selectors/manifests';\r\nimport { getContainerId } from 'mirador/dist/es/src/state/selectors/config';\r\nimport ScrollIndicatedDialogContent from 'mirador/dist/es/src/containers/ScrollIndicatedDialogContent';\r\nimport CanvasDownloadLinks from './CanvasDownloadLinks';\r\nimport ManifestDownloadLinks from './ManifestDownloadLinks';\r\n\r\nconst mapDispatchToProps = (dispatch, { windowId }) => ({\r\n  closeDialog: () => dispatch({ type: 'CLOSE_WINDOW_DIALOG', windowId }),\r\n});\r\n\r\nconst mapStateToProps = (state, { windowId }) => ({\r\n  canvases: getVisibleCanvases(state, { windowId }),\r\n  canvasLabel: canvasId => (getCanvasLabel(state, { canvasId, windowId })),\r\n  containerId: getContainerId(state),\r\n  infoResponse: canvasId => (selectInfoResponse(state, { windowId, canvasId }) || {}),\r\n  manifest: getManifestoInstance(state, { windowId }),\r\n  restrictDownloadOnSizeDefinition: state.config.miradorDownloadPlugin\r\n                                    && state.config\r\n                                      .miradorDownloadPlugin\r\n                                      .restrictDownloadOnSizeDefinition,\r\n  open: (state.windowDialogs[windowId] && state.windowDialogs[windowId].openDialog === 'download'),\r\n  viewType: getWindowViewType(state, { windowId }),\r\n});\r\n\r\n\r\n/**\r\n * MiradorDownloadDialog ~\r\n*/\r\nexport class MiradorDownloadDialog extends Component {\r\n  renderings() {\r\n    const { manifest } = this.props;\r\n    if (!(\r\n      manifest\r\n      && manifest.getSequences()\r\n      && manifest.getSequences()[0]\r\n      && manifest.getSequences()[0].getRenderings()\r\n    )) return [];\r\n\r\n    return manifest.getSequences()[0].getRenderings();\r\n  }\r\n\r\n  /**\r\n   * Returns the rendered component\r\n  */\r\n  render() {\r\n    const {\r\n      canvases,\r\n      canvasLabel,\r\n      classes,\r\n      closeDialog,\r\n      containerId,\r\n      infoResponse,\r\n      open,\r\n      restrictDownloadOnSizeDefinition,\r\n      viewType,\r\n      windowId,\r\n    } = this.props;\r\n\r\n    if (!open) return ('');\r\n\r\n    return (\r\n      <React.Fragment>\r\n        <Dialog\r\n          container={document.querySelector(`#${containerId} .mirador-viewer`)}\r\n          disableEnforceFocus\r\n          onClose={closeDialog}\r\n          open={open}\r\n          scroll=\"paper\"\r\n          fullWidth\r\n          maxWidth=\"xs\"\r\n        >\r\n          <DialogTitle disableTypography className={classes.h2}>\r\n            <Typography variant=\"h2\">Other Resolutions</Typography>\r\n          </DialogTitle>\r\n          <ScrollIndicatedDialogContent>\r\n            {canvases.map(canvas => (\r\n              <CanvasDownloadLinks\r\n                canvas={canvas}\r\n                canvasLabel={canvasLabel(canvas.id)}\r\n                classes={classes}\r\n                infoResponse={infoResponse(canvas.id)}\r\n                restrictDownloadOnSizeDefinition={restrictDownloadOnSizeDefinition}\r\n                key={canvas.id}\r\n                viewType={viewType}\r\n                windowId={windowId}\r\n              />\r\n            ))}\r\n            {this.renderings().length > 0\r\n              && <ManifestDownloadLinks classes={classes} renderings={this.renderings()} />\r\n            }\r\n          </ScrollIndicatedDialogContent>\r\n          <DialogActions>\r\n            <Button onClick={closeDialog} color=\"primary\">\r\n              Close\r\n            </Button>\r\n          </DialogActions>\r\n        </Dialog>\r\n      </React.Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nMiradorDownloadDialog.propTypes = {\r\n  canvasLabel: PropTypes.func.isRequired,\r\n  canvases: PropTypes.arrayOf(\r\n    PropTypes.shape({ id: PropTypes.string, index: PropTypes.number }),\r\n  ),\r\n  classes: PropTypes.shape({\r\n    h2: PropTypes.string,\r\n    h3: PropTypes.string,\r\n  }).isRequired,\r\n  closeDialog: PropTypes.func.isRequired,\r\n  containerId: PropTypes.string.isRequired,\r\n  infoResponse: PropTypes.func.isRequired,\r\n  manifest: PropTypes.shape({\r\n    getSequences: PropTypes.func,\r\n  }),\r\n  open: PropTypes.bool,\r\n  restrictDownloadOnSizeDefinition: PropTypes.bool,\r\n  viewType: PropTypes.string.isRequired,\r\n  windowId: PropTypes.string.isRequired,\r\n};\r\nMiradorDownloadDialog.defaultProps = {\r\n  canvases: [],\r\n  manifest: {},\r\n  open: false,\r\n  restrictDownloadOnSizeDefinition: false,\r\n};\r\n\r\nconst styles = () => ({\r\n  h2: {\r\n    paddingBottom: 0,\r\n  },\r\n  h3: {\r\n    marginTop: '20px',\r\n  },\r\n});\r\n\r\nexport default {\r\n  target: 'Window',\r\n  mode: 'add',\r\n  name: 'MiradorDownloadDialog',\r\n  component: withStyles(styles)(MiradorDownloadDialog),\r\n  mapDispatchToProps,\r\n  mapStateToProps,\r\n};\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport ListItemIcon from \"@material-ui/core/ListItemIcon\";\r\nimport ListItemText from \"@material-ui/core/ListItemText\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\r\nimport { withStyles } from \"@material-ui/core/styles\";\r\nimport { getCanvasGroupings } from \"mirador/dist/es/src/state/selectors\";\r\nimport { estimatePdfSize } from \"pdiiif\";\r\n\r\n/**\r\n * Check support for streamsaver\r\n * Adapted from PDIIIF web example: https://github.com/jbaiter/pdiiif/blob/main/pdiiif-web/src/util.ts\r\n */\r\nfunction checkStreamsaverSupport() {\r\n  try {\r\n    // Our usecase requires WriteableStream\r\n    new Response(new WritableStream());\r\n    if (isSecureContext && !(\"serviceWorker\" in navigator)) {\r\n      return false;\r\n    }\r\n  } catch (err) {\r\n    return false;\r\n  }\r\n  return true;\r\n}\r\n\r\n/**\r\n * Check image API has CORS\r\n * Adapted from PDIIIF web example: https://github.com/jbaiter/pdiiif/blob/main/pdiiif-web/src/iiif.ts\r\n * @returns {boolean} true if image API has CORS\r\n */\r\nasync function checkImageApiHasCors() {\r\n  try {\r\n    let testImgResp = await fetch(images[0][\"@id\"] ?? images[0].id);\r\n    let testImgData = new Uint8Array(await testImgResp.arrayBuffer());\r\n    return testImgData[0] !== undefined ? true : false;\r\n  } catch {\r\n    return false;\r\n  }\r\n}\r\n\r\n\r\n// select an icon from material icons to import and use: https://v4.mui.com/components/material-icons/\r\nimport DownloadIcon from '@material-ui/icons/VerticalAlignBottomSharp';\r\n\r\nconst dialogReducer = (state = {}, action) => {\r\n  if (action.type === \"OPEN_WINDOW_DIALOG\") {\r\n    return {\r\n      ...state,\r\n      [action.windowId]: {\r\n        openDialog: action.dialogType,\r\n      },\r\n    };\r\n  }\r\n\r\n  if (action.type === \"CLOSE_WINDOW_DIALOG\") {\r\n    return {\r\n      ...state,\r\n      [action.windowId]: {\r\n        openDialog: null,\r\n      },\r\n    };\r\n  }\r\n  return state;\r\n};\r\n\r\nconst PDIIIFReducer = (state = {}, action) => {\r\n  if (action.type === \"PDIIIF/ALLOW_PDF_DOWNLOAD\") {\r\n    return {\r\n      ...state,\r\n      [action.windowId]: {\r\n        ...state[action.windowId],\r\n        PDFDownloadEnabled: true,\r\n      },\r\n    };\r\n  }\r\n  if (action.type === \"PDIIIF/SET_ESTIMATED_SIZE\") {\r\n    var estimatedSizeInBytes = action.size;\r\n    if (\r\n      typeof action.size === 'object' &&\r\n      !Array.isArray(action.size) &&\r\n      action.size !== null\r\n    ) {\r\n        if ('size' in action.size) {\r\n          estimatedSizeInBytes = action.size.size;\r\n        }\r\n    }\r\n    return {\r\n      ...state,\r\n      [action.windowId]: {\r\n        ...state[action.windowId],\r\n        estimatedSizeInBytes: estimatedSizeInBytes,\r\n      },\r\n    };\r\n  }\r\n  return state;\r\n};\r\n\r\nconst mapStateToProps = (state, { windowId }) => ({\r\n  manifest: state.manifests[state.windows[windowId].manifestId],\r\n  canvasGroupings: getCanvasGroupings(state, { windowId }),\r\n  allowPdfDownload: state.PDIIIF[windowId]?.PDFDownloadEnabled ?? false,\r\n});\r\n\r\nconst mapDispatchToProps = (dispatch, { windowId }) => ({\r\n  setAllowPdfDownload: () =>\r\n    dispatch({ type: \"PDIIIF/ALLOW_PDF_DOWNLOAD\", windowId }),\r\n  setEstimatedSize: (size) =>\r\n    dispatch({ type: \"PDIIIF/SET_ESTIMATED_SIZE\", windowId, size }),\r\n  openDialog: () =>\r\n    dispatch({ type: \"OPEN_WINDOW_DIALOG\", windowId, dialogType: \"PDIIIF\" }),\r\n});\r\n\r\nclass PDIIIFMenuItem extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      hasChecked: false,\r\n      supportsFilesystemAPI: typeof showSaveFilePicker === \"function\",\r\n      supportsStreamsaver: checkStreamsaverSupport(),\r\n      imageApiHasCors: checkImageApiHasCors(),\r\n    };\r\n  }\r\n\r\n  openDialogAndCloseMenu() {\r\n    const { handleClose, openDialog } = this.props;\r\n\r\n    openDialog();\r\n    handleClose();\r\n  }\r\n\r\n  async componentDidMount() {\r\n    const {\r\n      manifest,\r\n      canvasGroupings,\r\n      setAllowPdfDownload,\r\n      allowPdfDownload,\r\n      setEstimatedSize,\r\n    } = this.props;\r\n    const { supportsFilesystemAPI, supportsStreamsaver, imageApiHasCors } =\r\n      this.state;\r\n\r\n    // If already allowed, don't check again\r\n    // Don't allow PDF download if neither Filesystem API or Streamsaver are supported\r\n    // Or if image API doesn't have CORS headers\r\n    if (\r\n      allowPdfDownload ||\r\n      (!supportsFilesystemAPI && !supportsStreamsaver) ||\r\n      !imageApiHasCors\r\n    ) {\r\n      this.setState({ hasChecked: true });\r\n      return;\r\n    }\r\n\r\n    if (!manifest?.error && manifest?.json) {\r\n      // Only show PDF's for PTO's\r\n      if (canvasGroupings.length > 1) {\r\n        // Check size can be estimated\r\n        const estimatedSizeInBytes = await estimatePdfSize({\r\n          manifest: manifest.json,\r\n          maxWidth: 1500,\r\n        });\r\n\r\n        // Estimated size, or 0\r\n        // N.B. Sometimes this is NaN, but not sure what triggers this\r\n        // it seems to be be caused bug in PDIIIIF trying to divide 0 by 0\r\n        if (estimatedSizeInBytes !== 0) {\r\n          setAllowPdfDownload();\r\n          setEstimatedSize(estimatedSizeInBytes);\r\n        }\r\n      }\r\n    }\r\n\r\n    this.setState({ hasChecked: true });\r\n  }\r\n\r\n  renderMenuItemText = () => {\r\n    const { hasChecked } = this.state;\r\n    const { allowPdfDownload } = this.props;\r\n\r\n    if (!hasChecked) {\r\n      return \"Loading non-searchable PDF options\";\r\n    }\r\n\r\n    if (allowPdfDownload) {\r\n      return \"Range of images in a non-searchable PDF\";\r\n    }\r\n\r\n    return \"Non-searchable PDF Unavailable\";\r\n  };\r\n\r\n  render() {\r\n    const { classes, allowPdfDownload } = this.props;\r\n    const { hasChecked } = this.state;\r\n    return (\r\n      <div>\r\n        <MenuItem \r\n          tabIndex=\"0\"\r\n          disabled={!hasChecked || !allowPdfDownload}\r\n          onClick={() => this.openDialogAndCloseMenu()}\r\n        >\r\n          <ListItemIcon>\r\n            <DownloadIcon />\r\n          </ListItemIcon>\r\n          <ListItemText primaryTypographyProps={{ variant: \"body1\" }}>\r\n            {this.renderMenuItemText()}\r\n          </ListItemText>\r\n          {!hasChecked && (\r\n            <CircularProgress size={15} className={classes.progress} />\r\n          )}\r\n        </MenuItem>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nPDIIIFMenuItem.propTypes = {\r\n  allowPdfDownload: PropTypes.bool,\r\n  canvasGroupings: PropTypes.array.isRequired,\r\n  handleClose: PropTypes.func,\r\n  openPDIIIFDialog: PropTypes.func,\r\n  manifest: PropTypes.object.isRequired,\r\n  setAllowPdfDownload: PropTypes.func.isRequired,\r\n  setEstimatedSize: PropTypes.func.isRequired,\r\n};\r\n\r\nPDIIIFMenuItem.defaultProps = {\r\n  handleClose: () => {},\r\n  openPDIIIFDialog: () => {},\r\n};\r\n\r\nconst styles = () => ({\r\n  progress: {\r\n    marginLeft: \"2px\",\r\n  },\r\n});\r\n\r\nexport default {\r\n  target: \"WindowTopBarShareMenu\",\r\n  mode: \"add\",\r\n  name: \"PDIIIFMenuItem\",\r\n  component: withStyles(styles)(PDIIIFMenuItem),\r\n  mapDispatchToProps,\r\n  mapStateToProps,\r\n  reducers: {\r\n    windowDialogs: dialogReducer,\r\n    PDIIIF: PDIIIFReducer,\r\n  },\r\n};\r\n","import React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport MoreVertIcon from '@material-ui/icons/MoreVertSharp';\r\nimport Menu from '@material-ui/core/Menu';\r\nimport MiradorMenuButton from 'mirador/dist/es/src/containers/MiradorMenuButton';\r\nimport { PluginHook } from 'mirador/dist/es/src/components/PluginHook';\r\n\r\n/**\r\n *\r\n */\r\nexport class DownloadWindowTopBarPluginMenu extends Component {\r\n  /**\r\n   * constructor -\r\n   */\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      anchorEl: null,\r\n      open: false,\r\n    };\r\n    this.handleMenuClick = this.handleMenuClick.bind(this);\r\n    this.handleMenuClose = this.handleMenuClose.bind(this);\r\n  }\r\n\r\n  /**\r\n   * Set the anchorEl state to the click target\r\n   */\r\n  handleMenuClick(event) {\r\n    this.setState({\r\n      anchorEl: event.currentTarget,\r\n      open: true,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Set the anchorEl state to null (closing the menu)\r\n   */\r\n  handleMenuClose() {\r\n    this.setState({\r\n      anchorEl: null,\r\n      open: false,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * render component\r\n   */\r\n  render() {\r\n    const {\r\n      container, PluginComponents, t, windowId, menuIcon,\r\n    } = this.props;\r\n    const { anchorEl, open } = this.state;\r\n    const windowPluginMenuId = `window-plugin-menu_${windowId}`;\r\n    if (!PluginComponents || PluginComponents.length === 0) return null;\r\n\r\n    return (\r\n      <>\r\n\r\n<button type=\"button\" class=\"btn btn-primary\" data-bs-toggle=\"modal\" data-bs-target=\"#downloadsModal\">\r\n{menuIcon}\r\n<span>Download</span>\r\n</button>\r\n\r\n<div class=\"modal fade\" id=\"downloadsModal\" tabindex=\"-1\" aria-labelledby=\"downloadsModalLabel\" aria-hidden=\"true\">\r\n  <div class=\"modal-dialog\">\r\n    <div class=\"modal-content\">\r\n      <div class=\"modal-header\">\r\n        <h5 class=\"modal-title\" id=\"downloadsModalLabel\">Modal title</h5>\r\n        <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\r\n      </div>\r\n      <div class=\"modal-body\" id={windowPluginMenuId}>\r\n        <PluginHook handleClose={() => this.handleMenuClose()} {...this.props} />\r\n      </div>\r\n      <div class=\"modal-footer\">\r\n        <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Close</button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nDownloadWindowTopBarPluginMenu.propTypes = {\r\n  anchorEl: PropTypes.object, // eslint-disable-line react/forbid-prop-types\r\n  container: PropTypes.shape({ current: PropTypes.instanceOf(Element) }),\r\n  menuIcon: PropTypes.element,\r\n  open: PropTypes.bool,\r\n  PluginComponents: PropTypes.arrayOf(\r\n    PropTypes.node,\r\n  ),\r\n  t: PropTypes.func.isRequired,\r\n  windowId: PropTypes.string.isRequired,\r\n};\r\n\r\n\r\nimport miradorPDIIIFMenuItemPlugin from './miradorPDIIIFMenuItem.js'\r\nDownloadWindowTopBarPluginMenu.defaultProps = {\r\n  anchorEl: null,\r\n  container: null,\r\n  menuIcon: <MoreVertIcon />,\r\n  open: false,\r\n  PluginComponents: [\r\n    miradorPDIIIFMenuItemPlugin\r\n  ],\r\n};\r\n\r\nexport default {\r\n  target: 'WindowTopBarShareMenu',\r\n  mode: 'wrap',\r\n  component: DownloadWindowTopBarPluginMenu\r\n};\r\n","'use strict';\r\nimport React from 'react';\r\nimport { withStyles } from '@material-ui/core';\r\nimport { withPlugins } from 'mirador/dist/es/src/extend/withPlugins';\r\nimport { DownloadWindowTopBarPluginMenu } from './downloadMenuButton.jsx';\r\nimport { getContainerId } from 'mirador/dist/es/src/state/selectors';\r\nimport DownloadIcon from '@material-ui/icons/VerticalAlignBottomSharp';\r\n\r\nconst WindowTopBarShareMenu = (props) => (\r\n  <DownloadWindowTopBarPluginMenu\r\n    {...props}\r\n    t={() => 'Download options'}\r\n    menuIcon={<DownloadIcon />}\r\n  />\r\n)\r\n\r\n/**\r\n *\r\n * @param theme\r\n * @returns {{ctrlBtn: {margin: (number|string)}}}\r\n */\r\nconst styles = theme => ({\r\n  ctrlBtnSelected: {\r\n    backgroundColor: theme.palette.action.selected,\r\n  },\r\n});\r\n\r\nconst ImprovedWindowTopBarShareMenu = withStyles(styles)(\r\n  withPlugins('WindowTopBarShareMenu')(\r\n    WindowTopBarShareMenu\r\n  )\r\n);\r\n\r\n\r\nexport default {\r\n  component: ImprovedWindowTopBarShareMenu,\r\n  mapStateToProps: (state) => ({\r\n    containerId: getContainerId(state),\r\n  }),\r\n  mode: 'add',\r\n  name: 'WindowTopBarShareMenu',\r\n  target: 'WindowTopBarPluginArea',\r\n};\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport { withStyles } from \"@material-ui/core/styles\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport LinearProgress from \"@material-ui/core/LinearProgress\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogContentText from \"@material-ui/core/DialogContentText\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport { convertManifest } from \"pdiiif\";\r\nimport {\r\n  getCanvases,\r\n  getManifestTitle,\r\n} from \"mirador/dist/es/src/state/selectors\";\r\nimport streamSaver from \"streamsaver\";\r\n\r\n/**\r\n * Format bytes to human readable string\r\n * https://stackoverflow.com/questions/15900485/correct-way-to-convert-size-in-bytes-to-kb-mb-gb-in-javascript\r\n * @param {number} bytes number of bytes\r\n * @param {number} decimals number of decimals\r\n * @returns {string} human readable string\r\n */\r\nfunction formatBytes(bytes, decimals = 2) {\r\n  if (!+bytes) return \"0 Bytes\";\r\n\r\n  const k = 1024;\r\n  const dm = decimals < 0 ? 0 : decimals;\r\n  const sizes = [\"Bytes\", \"KB\", \"MB\", \"GB\", \"TB\", \"PB\", \"EB\", \"ZB\", \"YB\"];\r\n\r\n  const i = Math.floor(Math.log(bytes) / Math.log(k));\r\n\r\n  return `${parseFloat((bytes / Math.pow(k, i)).toFixed(dm))} ${sizes[i]}`;\r\n}\r\n\r\n/**\r\n * Check support for streamsaver\r\n * Adapted from PDIIIF web example: https://github.com/jbaiter/pdiiif/blob/main/pdiiif-web/src/util.ts\r\n */\r\nfunction checkStreamsaverSupport() {\r\n  try {\r\n    // Our usecase requires WriteableStream\r\n    new Response(new WritableStream());\r\n    if (isSecureContext && !(\"serviceWorker\" in navigator)) {\r\n      return false;\r\n    }\r\n  } catch (err) {\r\n    return false;\r\n  }\r\n  return true;\r\n}\r\n\r\nconst mapDispatchToProps = (dispatch, { windowId }) => ({\r\n  closeDialog: () => dispatch({ type: \"CLOSE_WINDOW_DIALOG\", windowId }),\r\n});\r\n\r\nconst mapStateToProps = (state, { windowId }) => ({\r\n  open:\r\n    state.windowDialogs[windowId] &&\r\n    state.windowDialogs[windowId].openDialog === \"PDIIIF\",\r\n  manifestId: state.windows[windowId].manifestId,\r\n  manifest: state.manifests[state.windows[windowId].manifestId],\r\n  containerId: state.config.id,\r\n  estimatedSize: state.PDIIIF[windowId]?.estimatedSizeInBytes,\r\n  allowPdfDownload: state.PDIIIF[windowId]?.allowPdfDownload,\r\n  canvasIds: getCanvases(state, { windowId }).map((canvas) => canvas.id),\r\n  mitmPath: state.config.miradorPDIIIFPlugin?.mitmPath,\r\n  manifestLabel: getManifestTitle(state, { windowId }),\r\n  coverPageEndpoint: state.config.miradorPDIIIFPlugin?.coverPageEndpoint,\r\n});\r\n\r\n/**\r\n * createRange\r\n * Adapted from PDIIIF's range function\r\n * @param {Number} start - start of range\r\n * @param {Number} end  - end of range\r\n * @returns {Array} Array of numbers\r\n */\r\nfunction createRange(start, end) {\r\n  return Array.from({ length: end - start + 1 }, (_, i) => start + i);\r\n}\r\n\r\n/**\r\n * PDIIIFDialog ~\r\n */\r\nexport class PDIIIFDialog extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      savingError: null,\r\n      isDownloading: false,\r\n      supportsFilesystemAPI: typeof showSaveFilePicker === \"function\",\r\n      supportsStreamsaver: checkStreamsaverSupport(),\r\n      webWritable: null,\r\n      abortController: new AbortController(), // Needs to be reset if aborted\r\n      indexSpec: \"\",\r\n      pageError: false,\r\n      filteredCanvasIds: undefined, // Undefined will trigger all pages\r\n      progress: 0,\r\n      pdfPath: \"\"\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Parse string from input to generate array of corresponding canvasId's\r\n   * Adapted from PDIIIF's parseCanvasRanges function\r\n   * @param {String} indexSpec String of comma separated pages and/or ranges\r\n   * @param {Array} canvasIds Array of all canvasId's\r\n   * @returns {Array|undefined} Array of corresponding canvasId's\r\n   */\r\n  parseCanvasRanges(indexSpec, canvasIds) {\r\n    const canvasCount = canvasIds.length;\r\n\r\n    // First find the indexes of the canvases to be included (set will remove dupes)\r\n    const canvasIdxs = new Set(\r\n      indexSpec\r\n        .split(\",\")\r\n        .filter((g) => g.length > 0)\r\n        .reduce((idxs, group) => {\r\n          let newIdxs;\r\n          if (group.startsWith(\"-\")) {\r\n            const end = Number.parseInt(group.slice(1));\r\n            if (end < 1 || end > canvasCount) {\r\n              this.setState({ pageError: true });\r\n            }\r\n            newIdxs = createRange(1, end);\r\n          } else if (group.endsWith(\"-\")) {\r\n            const start = Number.parseInt(group.slice(0, -1));\r\n            if (start < 1 || start > canvasCount) {\r\n              this.setState({ pageError: true });\r\n            }\r\n            newIdxs = createRange(start, canvasCount);\r\n          } else if (group.indexOf(\"-\") > 0) {\r\n            const parts = group.split(\"-\");\r\n            const [start, end] = parts.map((p) => Number.parseInt(p, 10));\r\n            if (\r\n              start < 1 ||\r\n              end < 1 ||\r\n              start > end ||\r\n              start > canvasCount ||\r\n              end > canvasCount\r\n            ) {\r\n              this.setState({ pageError: true });\r\n            }\r\n            newIdxs = createRange(\r\n              Number.parseInt(parts[0]),\r\n              Number.parseInt(parts[1])\r\n            );\r\n          } else {\r\n            const num = Number.parseInt(group);\r\n            if (num < 1 || num > canvasCount) {\r\n              this.setState({ pageError: true });\r\n            }\r\n            newIdxs = [num];\r\n          }\r\n          if (newIdxs.find(Number.isNaN)) {\r\n            this.setState({ pageError: true });\r\n          }\r\n          return idxs.concat(newIdxs);\r\n        }, [])\r\n    );\r\n\r\n    // Next filter the canvasIds to only include those from canvasIdxs\r\n    const out = canvasIds.filter((_, i) => canvasIdxs.has(i + 1));\r\n    if (out.length === 0) {\r\n      return undefined;\r\n    }\r\n    return out;\r\n  }\r\n\r\n  componentDidMount() {\r\n    const { mitmPath } = this.props;\r\n\r\n    // Set the streamsaver mitm path or allow default\r\n    streamSaver.mitm = mitmPath ?? streamSaver.mitm;\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    const { isDownloading, webWritable } = this.state;\r\n    const { open } = this.props;\r\n\r\n    if (!prevProps.open && open) {\r\n      // Opening / closing the modal while a download is _not_ in progress is the ideal cleanup time\r\n      if (!isDownloading) {\r\n        this.setState({\r\n          indexSpec: \"\",\r\n          filteredCanvasIds: undefined,\r\n          pageError: false,\r\n        });\r\n\r\n        this.resetDownloadState();\r\n      }\r\n    }\r\n\r\n    if (\r\n      prevState.isDownloading !== isDownloading ||\r\n      prevState.webWritable !== webWritable\r\n    ) {\r\n      if (isDownloading) {\r\n        window.addEventListener(\"beforeunload\", this.handleBeforeUnload);\r\n        window.addEventListener(\"unload\", this.handleUnload, { once: true });\r\n      } else {\r\n        window.removeEventListener(\"beforeunload\", this.handleBeforeUnload);\r\n        window.removeEventListener(\"unload\", this.handleUnload, { once: true });\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle beforeunload event\r\n   * @param {Event} e\r\n   */\r\n  handleBeforeUnload = (e) => {\r\n    const { isDownloading, supportsFilesystemAPI } = this.state;\r\n    // Unlike a regular download, if the user *closes* the window / tab\r\n    // the download will fail, which is unexpected - this is just a warning\r\n    // Most modern browsers also cannot show a custom message:\r\n    // https://stackoverflow.com/questions/38879742/is-it-possible-to-display-a-custom-message-in-the-beforeunload-popup\r\n    if (isDownloading && !supportsFilesystemAPI) {\r\n      const msg = \"Are you sure? Leaving now will interrupt the download.\";\r\n      e.preventDefault();\r\n      e.returnValue = msg;\r\n      return msg;\r\n    }\r\n  };\r\n\r\n  handlePageChange = (event) => {\r\n    const { canvasIds } = this.props;\r\n    this.setState({ pageError: false });\r\n    this.setState({ indexSpec: event.target.value });\r\n    this.setState({\r\n      filteredCanvasIds: this.parseCanvasRanges(event.target.value, canvasIds),\r\n    });\r\n  };\r\n\r\n  /**\r\n   * Handle unload event\r\n   */\r\n  handleUnload = () => {\r\n    // N.B. Despite this, browsers aren't guaranteed to fire the unload event (and often don't)\r\n    // The side effect of this will usually be a download that looks like it's still in progress\r\n    const { abortController, webWritable } = this.state;\r\n\r\n    abortController.abort();\r\n    webWritable?.abort();\r\n  };\r\n\r\n  /**\r\n   * Resets the download state\r\n   * @returns {void}\r\n   */\r\n  resetDownloadState = () => {\r\n    // Cancelling or aborting will always need clear up the state\r\n    // In particular a new AbortController needs to be created\r\n    this.setState({\r\n      webWritable: null,\r\n      isDownloading: false,\r\n      progress: 0,\r\n      abortController: new AbortController(),\r\n    });\r\n  };\r\n\r\n  /**\r\n   * Attaches an abort listener to the AbortController\r\n   */\r\n  attachAbortListener = () => {\r\n    const { abortController } = this.state;\r\n\r\n    abortController.signal.addEventListener(\r\n      \"abort\",\r\n      async () => {\r\n        try {\r\n          await webWritable.abort();\r\n        } catch {\r\n          // NOP\r\n        } finally {\r\n          this.resetDownloadState();\r\n        }\r\n      },\r\n      { once: true }\r\n    );\r\n  };\r\n\r\n  /**\r\n   * Updates the progress state\r\n   * @param {Object} status - onProgress status object from PDIIIF\r\n   */\r\n  updateProgress = (status) => {\r\n    const { isDownloading } = this.state;\r\n\r\n    // When cancelled, sometimes this returns one last time\r\n    if (isDownloading) {\r\n      this.setState({\r\n        progress: Math.round((status.pagesWritten / status.totalPages) * 100),\r\n      });\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Renders the progress bar\r\n   * @returns {ReactElement|null}\r\n   */\r\n  renderProgress = () => {\r\n    const { classes } = this.props;\r\n    const { progress, isDownloading } = this.state;\r\n\r\n    // Cases for showing progress bar:\r\n    // 1. Download is in progress (but potentially at 0%)\r\n    // 2. Not downloading, but progress is 100% (i.e. download is complete and we want the user to see it)\r\n\r\n    if (isDownloading || progress === 100) {\r\n      return (\r\n        <div className={classes.progressContainer}>\r\n          <Typography variant=\"body2\" color=\"textSecondary\">\r\n            Download progress:\r\n          </Typography>\r\n          <Box display=\"flex\" alignItems=\"center\">\r\n            <Box width=\"100%\" mr={1}>\r\n              <LinearProgress variant=\"determinate\" value={progress} />\r\n            </Box>\r\n            <Box minWidth={35}>\r\n              <Typography variant=\"body2\" color=\"textSecondary\">\r\n                {progress}%\r\n              </Typography>\r\n            </Box>\r\n          </Box>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return null;\r\n  };\r\n\r\n  /**\r\n   * Cancels the download\r\n   */\r\n  cancelDownload = () => {\r\n    const { abortController } = this.state;\r\n\r\n    abortController.abort();\r\n\r\n    this.resetDownloadState();\r\n  };\r\n\r\n  /**\r\n   * Downoloads the PDF using the appropriate method\r\n   * @returns {Promise}\r\n   */\r\n  downloadPDF = async () => {\r\n    const { manifestLabel } = this.props;\r\n    const { supportsFilesystemAPI, supportsStreamsaver } = this.state;\r\n\r\n    // This is more of a insurance against what _might_ come out of manifesto\r\n    // For our purposes we'd always expect a string for v2 and v3 manifests\r\n    let suggestedName;\r\n    if (typeof manifestLabel === \"string\") {\r\n      suggestedName = manifestLabel;\r\n    } else if (Array.isArray(manifestLabel)) {\r\n      suggestedName = manifestLabel;\r\n    } else {\r\n      const date = new Date();\r\n      suggestedName = `PDF Download ${date.getYear()}-${date.getMonth()}-${date.getDate()}`;\r\n    }\r\n\r\n    // Enforce character limit (arbitrary, 128 incl extension)\r\n    suggestedName = `${suggestedName.slice(0, 123)}.pdf`;\r\n\r\n    // Ensure fresh state on each download attempt\r\n    this.resetDownloadState();\r\n\r\n    if (supportsFilesystemAPI) {\r\n      return await this.downloadWithFilesystemAPI(suggestedName);\r\n    }\r\n\r\n    if (supportsStreamsaver) {\r\n      return await this.downloadWithStreamsaver(suggestedName);\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Downoloads the PDF using the Filesystem API\r\n   * @returns {Promise}\r\n   */\r\n  async downloadWithFilesystemAPI(suggestedName) {\r\n    // Get a writable handle to a file on the user's machine\r\n    let handle;\r\n\r\n    // The error here will typically be a user hitting esc / cancel\r\n    try {\r\n      handle = await showSaveFilePicker({\r\n        suggestedName,\r\n        types: [\r\n          {\r\n            description: \"PDF file\",\r\n            accept: { \"application/pdf\": [\".pdf\"] },\r\n          },\r\n        ],\r\n      });\r\n    } catch (e) {\r\n      this.setState({ savingError: e.message });\r\n      console.error(e);\r\n      return Promise.reject(e);\r\n    }\r\n\r\n    try {\r\n      if ((await handle.queryPermission({ mode: \"readwrite\" })) !== \"granted\") {\r\n        // Throw error if permission is not granted\r\n        // N.B. I wasn't able to trigger this error (e.g. by choosing folder with strict permission)\r\n        // but it's here for completeness\r\n        throw new Error(\"Permission to write to file was not granted\");\r\n      } else {\r\n        // Reset the error state\r\n        this.setState({ savingError: null });\r\n        const file = await handle.getFile()\r\n        console.log(\"F\", file)\r\n        this.state.pdfPath = file.name;\r\n        const webWritable = await handle.createWritable();\r\n\r\n        this.setState({ webWritable: webWritable });\r\n\r\n        // Start the PDF generation\r\n        return await this.manifestConverter(webWritable);\r\n      }\r\n    } catch (e) {\r\n      // Display permission / conversion error\r\n      this.setState({ savingError: e.message });\r\n      this.resetDownloadState();\r\n      console.error(e);\r\n      return Promise.reject(e);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Downoloads the PDF using the Streamsaver API\r\n   * @param {string} label\r\n   * @returns {Promise}\r\n   */\r\n  async downloadWithStreamsaver(suggestedName) {\r\n    const webWritable = streamSaver.createWriteStream(suggestedName);\r\n    this.setState({ webWritable: webWritable });\r\n\r\n    // Start the PDF generation\r\n    return await this.manifestConverter(webWritable);\r\n  }\r\n\r\n  /**\r\n   * Call to PDIIIF convertManifest shared between download methods\r\n   * @param {WritableStream} webWritable Stream required by PDIIIF\r\n   * @returns {Promise} (implicit)\r\n   */\r\n  async manifestConverter(webWritable) {\r\n    const { manifest, coverPageEndpoint } = this.props;\r\n    const { abortController, filteredCanvasIds } = this.state;\r\n\r\n    this.attachAbortListener();\r\n\r\n    this.setState({ isDownloading: true }, async () => {\r\n      try {\r\n        await convertManifest(manifest.json, webWritable, {\r\n          concurrency: 4,\r\n          maxWidth: 1500,\r\n          abortController,\r\n          filterCanvases: filteredCanvasIds,\r\n          coverPageEndpoint: coverPageEndpoint ?? \"\",\r\n          onProgress: this.updateProgress,\r\n        });\r\n      } catch (e) {\r\n        this.setState({ savingError: e.message });\r\n        console.error(e);\r\n      }\r\n      this.setState({ isDownloading: false });\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Returns the rendered component\r\n   */\r\n  render() {\r\n    const { savingError, pageError, isDownloading, progress } = this.state;\r\n    const {\r\n      classes,\r\n      closeDialog,\r\n      containerId,\r\n      open,\r\n      allowPdfDownload,\r\n      estimatedSize,\r\n      canvasIds,\r\n    } = this.props;\r\n\r\n    if (!open || !allowPdfDownload) null;\r\n\r\n    const fileSizeText = estimatedSize\r\n      ? ` and has an estimated file size of ${formatBytes(estimatedSize)}`\r\n      : \"\";\r\n\r\n    return (\r\n      <Dialog\r\n        container={document.querySelector(`#${containerId} .mirador-viewer`)}\r\n        disableEnforceFocus\r\n        onClose={closeDialog}\r\n        open={open}\r\n        scroll=\"paper\"\r\n        fullWidth\r\n        maxWidth=\"xs\"\r\n      >\r\n        <DialogTitle disableTypography className={classes.h2}>\r\n          <Typography variant=\"h2\">Download a range of images to non-searchable PDF</Typography>\r\n        </DialogTitle>\r\n        <DialogContent>\r\n          {savingError && (\r\n            <DialogContentText>{savingError.message}</DialogContentText>\r\n          )}\r\n          <DialogContentText>\r\n            Note: The resulting PDF will NOT be a searchable PDF. \r\n            <br />\r\n            <br />\r\n            {isDownloading || progress === 100 ? isDownloading ? \"Downloading \" + this.state.pdfPath  : this.state.pdfPath + \" downloaded!\":\r\n            (\"The resulting PDF will contain \" + canvasIds.length + \" images \" + fileSizeText + \". All images will be included by default. If you wish to only download certain images, you may provide a comma separated list of image numbers and/or ranges below.\") }\r\n          </DialogContentText>\r\n          {isDownloading || progress === 100 ? progress === 100 ? (\r\n          <DialogContentText>Download finished! Navigate to the location you selected on your computer to view your PDF.</DialogContentText>): this.renderProgress() : (\r\n          <TextField\r\n            id=\"pages\"\r\n            label=\"(Optional) Image Numbers...\"\r\n            margin=\"normal\"\r\n            variant=\"outlined\"\r\n            placeholder=\"1, 4, 8-12, ...\"\r\n            error={pageError}\r\n            onChange={this.handlePageChange}\r\n            value={this.state.indexSpec}\r\n            disabled={isDownloading || progress === 100}\r\n          />\r\n          )}\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button\r\n            onClick={isDownloading ? this.cancelDownload : this.downloadPDF}\r\n            className={\r\n              pageError || progress === 100 ? classes.disabledButton : \"\"\r\n            }\r\n            color=\"primary\"\r\n            disabled={pageError || progress === 100}\r\n          >\r\n            {(() => {\r\n              if (progress === 100) {\r\n                return \"Done\";\r\n              } else if (isDownloading) {\r\n                return \"Cancel\";\r\n              } else {\r\n                return \"Download\";\r\n              }\r\n            })()}\r\n          </Button>\r\n          <Button onClick={closeDialog} color=\"primary\">\r\n            {(() => {\r\n              if (progress === 100) {\r\n                return \"Ok\";\r\n              } \r\n              else {\r\n                return \"Close\";\r\n              }\r\n            })()}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n    );\r\n  }\r\n}\r\n\r\nPDIIIFDialog.propTypes = {\r\n  canvasIds: PropTypes.arrayOf(PropTypes.string),\r\n  classes: PropTypes.shape({\r\n    h2: PropTypes.string,\r\n    h3: PropTypes.string,\r\n    disabledButton: PropTypes.string,\r\n  }).isRequired,\r\n  closeDialog: PropTypes.func.isRequired,\r\n  containerId: PropTypes.string.isRequired,\r\n  coverPageEndpoint: PropTypes.string,\r\n  estimatedSize: PropTypes.number,\r\n  manifest: PropTypes.object,\r\n  manifestId: PropTypes.string,\r\n  manifestLabel: PropTypes.oneOfType([\r\n    PropTypes.string,\r\n    PropTypes.arrayOf(PropTypes.string),\r\n  ]),\r\n  allowPdfDownload: PropTypes.bool,\r\n  open: PropTypes.bool,\r\n  windowId: PropTypes.string.isRequired,\r\n  mitmPath: PropTypes.string,\r\n};\r\n\r\nPDIIIFDialog.defaultProps = {\r\n  open: false,\r\n};\r\n\r\nconst styles = () => ({\r\n  h2: {\r\n    paddingBottom: 0,\r\n  },\r\n  progressContainer: {\r\n    marginTop: \"10px\",\r\n  },\r\n  h3: {\r\n    marginTop: \"20px\",\r\n  },\r\n  disabledButton: {\r\n    opacity: 0.6,\r\n  },\r\n});\r\n\r\nexport default {\r\n  target: \"Window\",\r\n  mode: \"add\",\r\n  name: \"PDIIIFDialog\",\r\n  component: withStyles(styles)(PDIIIFDialog),\r\n  mapDispatchToProps,\r\n  mapStateToProps,\r\n};\r\n","import React, { Component } from 'react'\r\nimport PropTypes from \"prop-types\"\r\nimport {\r\n  getCanvasIndex,\r\n} from 'mirador/dist/es/src/state/selectors'\r\n\r\nexport class PageNumPlugin extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n  }\r\n\r\n  render() {\r\n    const {\r\n     TargetComponent, targetProps\r\n    } = this.props;\r\n\r\n    return (\r\n      <TargetComponent {...targetProps} />\r\n    )\r\n  }\r\n}\r\n\r\nPageNumPlugin.propTypes = {\r\n  canvasIndex: PropTypes.number\r\n};\r\n\r\n/**\r\n * mapStateToProps - to hook up connect\r\n * @memberof Window\r\n * @private\r\n */\r\nconst mapStateToProps = (state, props) => {\r\n  const { windowId } = props;\r\n  const canvasIndex = getCanvasIndex(state, { windowId });\r\n  let pageNum = canvasIndex + 1\r\n  let queryParams = new URLSearchParams(window.location.search)\r\n  const queryPageNum = queryParams.get(\"pageNum\")\r\n  if(typeof queryPageNum !== \"undefined\" && pageNum !== parseInt(queryPageNum)) {\r\n    queryParams.set(\"pageNum\", pageNum)\r\n    history.pushState(null, null, \"?\"+queryParams.toString())\r\n  }\r\n  return {\r\n    canvasIndex\r\n  };\r\n};\r\n\r\n\r\nexport default {\r\n  target: 'WindowCanvasNavigationControls',\r\n  mode: 'wrap',\r\n  component: PageNumPlugin,\r\n  mapStateToProps\r\n};\r\n","import React, { Component } from 'react';\r\nimport WindowViewSettings from 'mirador/dist/es/src/containers/WindowViewSettings';\r\n\r\n/**\r\n */\r\nexport class ViewPlugin extends Component {\r\n  /**\r\n   * render\r\n   * @return\r\n   */\r\n  render() {\r\n    const {\r\n      handleClose, windowId\r\n    } = this.props;\r\n\r\n    return (\r\n      <WindowViewSettings windowId={windowId} handleClose={handleClose} />\r\n    );\r\n  }\r\n}\r\n\r\nexport default {\r\n  component: ViewPlugin,\r\n  mode: 'add',\r\n  name: 'ViewPlugin',\r\n  target: 'WindowTopBarPluginArea',\r\n};","import React, { Component } from 'react'\r\nimport PropTypes from \"prop-types\"\r\nimport NavigationIcon from '@material-ui/icons/NavigateNext';\r\nimport SkipNextIcon from '@material-ui/icons/SkipNext';\r\nimport classNames from 'classnames';\r\nimport ns from 'mirador/dist/es/src/config/css-ns';\r\nimport Select from 'react-select';\r\nimport * as actions from 'mirador/dist/es/src/state/actions';\r\nimport {\r\n  getSequenceViewingDirection,\r\n  getNextCanvasGrouping,\r\n  getPreviousCanvasGrouping,\r\n  getCurrentCanvas,\r\n  getCanvases\r\n} from 'mirador/dist/es/src/state/selectors';\r\nimport isEqual from 'lodash/isEqual'\r\n\r\n/**\r\n */\r\nclass ViewerNavigation extends Component {\r\n  /**\r\n   * Renders things\r\n   */\r\n  render() {\r\n    const {\r\n      hasNextCanvas, hasPreviousCanvas, setNextCanvas, setPreviousCanvas, \r\n      viewingDirection, setCanvas, lastCanvas, firstCanvas\r\n    } = this.props;\r\n\r\n    let htmlDir = 'ltr';\r\n    let previousIconStyle = {};\r\n    let nextIconStyle = {};\r\n    switch (viewingDirection) {\r\n      case 'top-to-bottom':\r\n        previousIconStyle = { transform: 'rotate(270deg)' };\r\n        nextIconStyle = { transform: 'rotate(90deg)' };\r\n        break;\r\n      case 'bottom-to-top':\r\n        previousIconStyle = { transform: 'rotate(90deg)' };\r\n        nextIconStyle = { transform: 'rotate(270deg)' };\r\n        break;\r\n      case 'right-to-left':\r\n        htmlDir = 'rtl';\r\n        previousIconStyle = {};\r\n        nextIconStyle = { transform: 'rotate(180deg)' };\r\n        break;\r\n      default:\r\n        previousIconStyle = { transform: 'rotate(180deg)' };\r\n        nextIconStyle = {};\r\n    }\r\n\r\n    return (\r\n      <div\r\n        className={classNames(ns('osd-navigation-custom'))}\r\n        dir={htmlDir}\r\n      >\r\n        <ul class=\"nav nav-pills\" aria-label=\"Item navigation buttons\">\r\n          <li class=\"nav-item\">\r\n            <a \r\n            class=\"nav-link MuiButtonBase-root MuiIconButton-root mirador-first-canvas-button btn btn-outline\" \r\n            href=\"#\" \r\n            tabindex=\"0\"\r\n            aria-label=\"Last Image\" \r\n            title=\"First Image\"\r\n            disabled={!hasPreviousCanvas}\r\n            onClick={() => { hasPreviousCanvas && setCanvas(firstCanvas); }}>\r\n              <SkipNextIcon style={previousIconStyle} />\r\n            </a>\r\n          </li>\r\n          <li class=\"nav-item\">\r\n            <a \r\n            class=\"nav-link MuiButtonBase-root MuiIconButton-root mirador-first-canvas-button btn btn-outline\" \r\n            href=\"#\" \r\n            tabindex=\"0\" \r\n            aria-label=\"Previous Image\" \r\n            title=\"Previous Image\"\r\n            disabled={!hasPreviousCanvas}\r\n            onClick={() => { hasPreviousCanvas && setPreviousCanvas(); }}>\r\n              <NavigationIcon style={previousIconStyle} />\r\n            </a>\r\n          </li>\r\n          <li class=\"nav-item\">\r\n            <a \r\n            class=\"nav-link MuiButtonBase-root MuiIconButton-root mirador-first-canvas-button btn btn-outline\" \r\n            href=\"#\" \r\n            tabindex=\"0\" \r\n            aria-label=\"Next Image\" \r\n            title=\"Next Image\"\r\n            disabled={!hasNextCanvas}\r\n            onClick={() => { hasNextCanvas && setNextCanvas(); }}>\r\n              <NavigationIcon style={nextIconStyle} />\r\n            </a>\r\n          </li>\r\n          <li class=\"nav-item\">\r\n            <a \r\n            class=\"nav-link MuiButtonBase-root MuiIconButton-root mirador-first-canvas-button btn btn-outline\" \r\n            href=\"#\" \r\n            tabindex=\"0\" \r\n            aria-label=\"Last Image\" \r\n            title=\"Last Image\"\r\n            disabled={!hasNextCanvas}\r\n            onClick={() => { hasNextCanvas && setCanvas(lastCanvas); }}>\r\n            <SkipNextIcon style={nextIconStyle} />\r\n            </a>\r\n          </li>\r\n        </ul>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nViewerNavigation.propTypes = {\r\n  hasNextCanvas: PropTypes.bool,\r\n  hasPreviousCanvas: PropTypes.bool,\r\n  setNextCanvas: PropTypes.func,\r\n  setPreviousCanvas: PropTypes.func,\r\n  setCanvas: PropTypes.func,\r\n  t: PropTypes.func.isRequired,\r\n  viewingDirection: PropTypes.string,\r\n  firstCanvas: PropTypes.string,\r\n  lastCanvas: PropTypes.string,\r\n};\r\n\r\nexport class NavControlsPlugin extends Component {\r\n  state = {\r\n    firstCanvas: \"\",\r\n    lastCanvas: \"\",\r\n    selectOptions: [],\r\n    selectedOption: null\r\n  }\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state.selectOptions = this.props.canvases?.map((canvas, index) => {\r\n      return {\r\n        value: canvas.id,\r\n        label: `Image ${index+1}`\r\n      }\r\n    })\r\n    this.state.selectedOption =  this.state.selectOptions?.[0]\r\n    this.state.canvasIds = this.props.canvases?.map((canvas) => canvas.id)\r\n    this.state.firstCanvas = this.state.canvasIds?.[0]\r\n    this.state.lastCanvas = this.state.canvasIds?.pop()\r\n  }\r\n\r\n  handleChange = (selectedOption) => {\r\n    this.setState({ selectedOption }, () =>\r\n      this.props.setCanvas(selectedOption.value)\r\n    );\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    if(this.props.currentCanvas.id !== prevProps.currentCanvas?.id) {\r\n      let index = 0\r\n      for(let canvas of this.props.canvases) {\r\n        if (canvas['id'] === this.props.currentCanvas.id) break\r\n        index++\r\n      }\r\n      this.state.selectedOption = {\r\n        value: this.props.currentCanvas.id,\r\n        label: `Image ${index+1}`\r\n      }\r\n      this.forceUpdate()\r\n    }\r\n    if (this.props.canvases && !isEqual(this.props.canvases, prevProps.canvases)) {\r\n      this.state.selectOptions = this.props.canvases.map((canvas, index) => {\r\n        return {\r\n          value: canvas.id,\r\n          label: `Image ${index+1}`\r\n        }\r\n      })\r\n      this.state.selectedOption = this.state.selectOptions[0]\r\n      this.state.canvasIds = this.props.canvases.map((canvas) => canvas.id)\r\n      this.state.firstCanvas = this.state.canvasIds[0]\r\n      this.state.lastCanvas = this.state.canvasIds.pop()\r\n      this.forceUpdate()\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const { windowId, hasNextCanvas, hasPreviousCanvas, viewingDirection, setNextCanvas, setPreviousCanvas, setCanvas } = this.props\r\n    const { firstCanvas, lastCanvas, selectOptions, selectedOption } = this.state\r\n    return (\r\n      <div  style={{zIndex: 1000000, position: \"absolute\", top: \"0.6rem\", left: \"1rem\", display: \"flex\", alignItems: \"flex-start\"}}> \r\n        <Select\r\n          value={selectedOption}\r\n          onChange={this.handleChange}\r\n          options={selectOptions}\r\n        />\r\n        <ViewerNavigation \r\n          windowId={windowId}\r\n          hasNextCanvas={hasNextCanvas}\r\n          hasPreviousCanvas={hasPreviousCanvas}\r\n          viewingDirection={viewingDirection}\r\n          setNextCanvas={setNextCanvas}\r\n          setPreviousCanvas={setPreviousCanvas}\r\n          setCanvas={setCanvas}\r\n          lastCanvas={lastCanvas}\r\n          firstCanvas={firstCanvas}\r\n         />\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\n/** */\r\nconst mapStateToProps = (state, { windowId }) => ({\r\n  hasNextCanvas: !!getNextCanvasGrouping(state, { windowId }),\r\n  hasPreviousCanvas: !!getPreviousCanvasGrouping(state, { windowId }),\r\n  viewingDirection: getSequenceViewingDirection(state, { windowId }),\r\n  currentCanvas: getCurrentCanvas(state, { windowId }),\r\n  canvases: getCanvases(state, { windowId })\r\n});\r\n\r\n/**\r\n * mapDispatchToProps - used to hook up connect to action creators\r\n * @memberof ManifestForm\r\n * @private\r\n */\r\nconst mapDispatchToProps = (dispatch, { windowId }) => ({\r\n  setNextCanvas: (...args) => dispatch(actions.setNextCanvas(windowId)),\r\n  setPreviousCanvas: (...args) => dispatch(actions.setPreviousCanvas(windowId)),\r\n  setCanvas: (canvasId) => {\r\n    return dispatch(actions.setCanvas(windowId, canvasId))\r\n  },\r\n});\r\n\r\nexport default {\r\n  component: NavControlsPlugin,\r\n  mode: 'add',\r\n  name: 'NavControlsPlugin',\r\n  target: 'WindowTopBarPluginArea',\r\n  mapStateToProps,\r\n  mapDispatchToProps\r\n};\r\n","import React, { Component } from 'react'\r\nimport * as actions from 'mirador/dist/es/src/state/actions'\r\nimport {\r\n  getCanvases\r\n} from 'mirador/dist/es/src/state/selectors'\r\nimport Card from '@material-ui/core/Card'\r\nimport CardHeader from '@material-ui/core/CardHeader'\r\nimport CardMedia from '@material-ui/core/CardMedia'\r\nimport Button from '@material-ui/core/Button'\r\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack'\r\nimport ClearIcon from '@material-ui/icons/Clear'\r\nimport Pagination from '@material-ui/lab/Pagination'\r\n\r\nexport class LegacySearchPlugin extends Component {\r\n\r\n  state = {\r\n    query: '',\r\n    results: [],\r\n    currentResultIndex: 0,\r\n    currentCanvasIndex: 0,\r\n    resultsListOpen: false,\r\n    resultsMenuOpen: false,\r\n    itemOffset: 0,\r\n    endOffset: 0,\r\n    currentItems: [],\r\n    pageCount: 0,\r\n    page: 1,\r\n    itemsPerPage: 20\r\n  }\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    const queryString = window.location.search\r\n    const urlParams = new URLSearchParams(queryString)\r\n    const query = urlParams.get('q') \r\n    this.state.query = query ? query : \"\"\r\n  }\r\n\r\n  handleClear = () => {\r\n    document.getElementById(\"pvSearch\").value = \"\"\r\n    this.state.query = \"\"\r\n    this.state.results = []\r\n    this.state.currentResultIndex = 0\r\n    this.state.resultsListOpen = false\r\n    this.state.resultsMenuOpen = false\r\n    this.state.endOffset = 0\r\n    this.state.currentItems = 0\r\n    this.state.pageCount = 0\r\n    this.forceUpdate()\r\n  }\r\n\r\n  handleSearch = () => {\r\n    if(this.state.query.length) {\r\n      let currURL = window.location.href\r\n      let urlArr=currURL.split('/')\r\n      let parameters=urlArr[urlArr.length-1].split('?')\r\n      let id = parameters[0]\r\n      fetch('/legacy/'+id+'?'+ new URLSearchParams({\r\n          q: this.state.query\r\n      })).then(response => {\r\n        response.json().then(content => {\r\n          this.state.results = content\r\n          this.state.resultsListOpen = true\r\n          this.state.page = 0\r\n          this.state.itemOffset = 0\r\n          this.state.endOffset = 1 * this.state.itemsPerPage \r\n          this.state.currentItems = this.state.results.slice(this.state.itemOffset, this.state.endOffset)\r\n          this.state.pageCount = Math.ceil(this.state.results.length / this.state.itemsPerPage)\r\n          console.log(\"???\", this.state.currentItems, this.state.pageCount, this.state.endOffset, this.state.itemsPerPage)\r\n          this.forceUpdate()\r\n        })\r\n      })\r\n    } else this.handleClear()\r\n  }\r\n\r\n  handleChangePage = (event, newPage) => {\r\n    this.state.page = newPage\r\n    this.state.itemOffset = (this.state.page - 1) * this.state.itemsPerPage \r\n    this.state.endOffset = (this.state.page ) * this.state.itemsPerPage \r\n    this.state.currentItems = this.state.results.slice(this.state.itemOffset, this.state.endOffset)\r\n    console.log(\"???\", this.state)\r\n    this.forceUpdate()\r\n  };\r\n  \r\n  render() {\r\n    const { windowId, canvases, setCanvas, manifestId } = this.props\r\n    return (\r\n      <div className={this.state.resultsListOpen ? \"fullscreen\" : \"\"} style={{zIndex: 10000000, position: \"absolute\", top: \"-3.5rem\", left: \"0\", padding:\"1rem 1rem 0 1rem\", right:\"0\", background: \"#ffffff\", borderBottom: \"none\"}}> \r\n        <div id=\"pvToolbarTop\" aria-label=\"Viewer controls\">\r\n            <input \r\n            id=\"pvSearch\" \r\n            class=\"DocSearch-Input search-q q form-control\"\r\n            aria-autocomplete=\"both\" \r\n            aria-labelledby=\"docsearch-label\" \r\n            autocomplete=\"off\" \r\n            autocorrect=\"off\" \r\n            autocapitalize=\"off\" \r\n            enterkeyhint=\"search\" \r\n            spellcheck=\"false\" \r\n            placeholder=\"Search within images...\"\r\n            type=\"search\"\r\n            name=\"q\"\r\n            defaultValue={this.state.query}\r\n            onChange={(e) => { \r\n              console.log(e)\r\n              this.state.query = e.target.value\r\n            }}/>\r\n            <button \r\n              onClick={this.handleSearch}\r\n              type=\"submit\" \r\n              id=\"item-search-submit\" \r\n              class=\"btn btn-primary\">\r\n                <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"currentColor\" aria-hidden=\"true\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\">\r\n                    <path fill=\"none\" d=\"M0 0h24v24H0V0z\"></path><path d=\"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z\"></path>\r\n                </svg>\r\n            </button>\r\n            { \r\n              this.state.resultsListOpen || this.state.resultsMenuOpen ? (\r\n              <Button \r\n                onClick={this.handleClear}\r\n                className=\"btn-ghost\"\r\n                id=\"item-search-clear\">\r\n                  <ClearIcon />\r\n              </Button> ) : (\"\")\r\n            }\r\n        </div>\r\n        <div class=\"container-fluid container-flex card-section\">\r\n          { this.state.resultsListOpen ? this.state.currentItems.length ? this.state.currentItems.map((result, index) => (\r\n            <Card className='mui-card clickable' onClick={() => {\r\n              this.state.currentCanvasIndex = result - 1\r\n              this.state.currentResultIndex = this.state.itemOffset + index \r\n              this.state.resultsListOpen = false\r\n              this.state.resultsMenuOpen = true\r\n              console.log(this.state.currentCanvasIndex, this.state.currentResultIndex)\r\n              setCanvas(canvases[this.state.currentCanvasIndex].id)\r\n              this.forceUpdate()\r\n            }}>\r\n              <CardHeader\r\n                title={\"Image \" + result}\r\n              />\r\n              <CardMedia\r\n                image={canvases[result-1].__jsonld.items[0].items[0].body.id}\r\n                height=\"300px\"\r\n                title={\"Image \" + result}\r\n              />\r\n            </Card>\r\n          )) : (<p><br/>No results</p>) : this.state.resultsMenuOpen ?\r\n            <div className=\"legacy-search-menu\">\r\n              <div style={{display : \"flex\", justifyContent: \"flex-start\", alignItems: \"center\"}}>\r\n                <Button variant=\"contained\" color=\"primary\" onClick={() => {\r\n                  this.state.resultsListOpen = true\r\n                  this.state.resultsMenuOpen = false \r\n                  this.state.page = 1\r\n                  this.state.itemOffset = 0\r\n                  this.state.endOffset = 1 * this.state.itemsPerPage \r\n                  this.state.currentItems = this.state.results.slice(this.state.itemOffset, this.state.endOffset)\r\n                  this.forceUpdate()\r\n                }}\r\n                  className=\"btn-ghost btn-icon\"\r\n                  style={{marginLeft: \"1rem\"}}>\r\n                  <ArrowBackIcon />\r\n                  All results\r\n                </Button>\r\n              </div>\r\n              <div style={{display : \"flex\", justifyContent: \"center\", alignItems: \"center\", color: \"#666\"}} className=\"MuiTypography-caption\">\r\n                <span style={{paddingRight : \"0.6rem\", borderRight: \"none\"}}>\r\n                  Image {this.state.currentCanvasIndex + 1}\r\n                </span>\r\n                <span style={{marginLeft: \"0.5rem\"}}>\r\n                  - Result {this.state.currentResultIndex + 1} of {this.state.results.length}\r\n                </span>\r\n              </div>\r\n              <div style={{display : \"flex\", justifyContent: \"flex-end\", alignItems: \"center\"}}>\r\n                <Button disabled={this.state.currentResultIndex === 0} variant=\"contained\" className=\"btn-ghost\" onClick={() => {\r\n                  if(this.state.currentResultIndex > 0) {\r\n                    this.state.currentResultIndex -= 1\r\n                    this.state.currentCanvasIndex = this.state.results[this.state.currentResultIndex]-1\r\n                    setCanvas(canvases[this.state.currentCanvasIndex].id)\r\n                    console.log(canvases[this.state.currentCanvasIndex])\r\n                    this.forceUpdate()\r\n                  }\r\n                }}>\r\n                  previous result\r\n                </Button>\r\n                <Button disabled={this.state.currentResultIndex === this.state.results.length-1} variant=\"contained\" className=\"btn-ghost\" onClick={() => {\r\n                  if(this.state.currentResultIndex < this.state.results.length-1) {\r\n                    this.state.currentResultIndex += 1\r\n                    this.state.currentCanvasIndex = this.state.results[this.state.currentResultIndex]-1\r\n                    setCanvas(canvases[this.state.currentCanvasIndex].id)\r\n                    console.log(canvases[this.state.currentCanvasIndex])\r\n                    this.forceUpdate()\r\n                  }\r\n                }}>\r\n                  next result\r\n                </Button>\r\n              </div>\r\n            </div> \r\n            : \"\"\r\n          }\r\n        </div>\r\n\r\n        { this.state.resultsListOpen && this.state.currentItems.length ? (\r\n          <div class=\"card-pagination-wrapper\">\r\n            <Pagination count={this.state.pageCount} page={this.state.page} onChange={this.handleChangePage} />\r\n          </div>\r\n         ) : \"\" }\r\n        \r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state, { windowId }) => ({\r\n  canvases: getCanvases(state, { windowId })\r\n});\r\n\r\n/**\r\n * mapDispatchToProps - used to hook up connect to action creators\r\n * @memberof ManifestForm\r\n * @private\r\n */\r\nconst mapDispatchToProps = (dispatch, { windowId }) => ({\r\n  setCanvas: (canvasId) => {\r\n    return dispatch(actions.setCanvas(windowId, canvasId))\r\n  },\r\n});\r\n\r\nexport default {\r\n  component: LegacySearchPlugin,\r\n  mode: 'add',\r\n  name: 'LegacySearchPlugin',\r\n  target: 'WindowTopBarPluginArea',\r\n  mapStateToProps,\r\n  mapDispatchToProps\r\n};\r\n","import Mirador from 'mirador/dist/es/src/index.js'\r\nimport miradorImageToolsPlugin from '../plugins/mirador-image-tools/miradorImageToolsPlugin.js'\r\nimport miradorShareDialogPlugin from 'mirador-share-plugin/es/MiradorShareDialog.js'\r\nimport fullResDownloadPlugin from '../plugins/fullResDownloadPlugin.js'\r\nimport pdfDownloadPlugin from '../plugins/pdfDownloadPlugin.js'\r\nimport fullPdfDownloadPlugin from '../plugins/fullPdfDownloadPlugin.js'\r\nimport miradorDownloadPlugin from '../plugins/mirador-downloads/miradorDownloadPlugin.js'\r\nimport miradorDownloadDialogPlugin from '../plugins/mirador-downloads/MiradorDownloadDialog.js'\r\nimport downloadMenuPlugin from '../plugins/downloadMenuPlugin.jsx'\r\nimport miradorPDIIIFMenuItemPlugin from '../plugins/miradorPDIIIFMenuItem.js'\r\nimport miradorPDIIIFDialogPlugin from '../plugins/miradorPDIIIFDialog.js'\r\nimport pageNumPlugin from '../plugins/pageNumPlugin.jsx'\r\nimport miradorViewPlugin from '../plugins/miradorViewPlugin.jsx'\r\nimport navControlsPlugin from '../plugins/navControls.jsx'\r\nimport legacySearchPlugin from '../plugins/legacySearchPlugin.jsx'\r\n//import textOverlayPlugin from 'mirador-textoverlay/es';\r\n\r\nexport default {\r\n  init: function() {\r\n        console.log(Mirador)\r\n        //let searchInput = document.getElementById(\"pvSearch\")\r\n        //let resetButton = document.getElementById(\"pvSearchReset\")\r\n\r\n        //console.log(\"rb\", resetButton)\r\n        let pageViewer = document.getElementById(\"page-viewer\")\r\n        if(!pageViewer) return\r\n    \r\n        const documentId = pageViewer.getAttribute(\"data-docid\")\r\n        let canvasIndex = 0\r\n        const params = new URLSearchParams(window.location.search)\r\n        if(params.has(\"pageNum\")) canvasIndex = parseInt(params.get(\"pageNum\")-1)\r\n    \r\n        let apiPrefix =  \"https://parl.canadiana.ca/iiif/\"\r\n        let manifest = apiPrefix+documentId+\"/manifest\"\r\n        \r\n        let mplugins = [\r\n          //miradorZoomBugPlugin,\r\n          miradorViewPlugin,\r\n          downloadMenuPlugin,\r\n          {\r\n            ...fullResDownloadPlugin,\r\n            target: 'WindowTopBarShareMenu',\r\n          },\r\n          {\r\n            ...miradorDownloadPlugin,\r\n            target: 'WindowTopBarShareMenu',\r\n          },\r\n          {\r\n            ...pdfDownloadPlugin,\r\n            target: 'WindowTopBarShareMenu',\r\n          },\r\n          {\r\n            ...fullPdfDownloadPlugin,\r\n            target: 'WindowTopBarShareMenu',\r\n          },\r\n          miradorPDIIIFMenuItemPlugin,\r\n          miradorPDIIIFDialogPlugin,\r\n          miradorShareDialogPlugin,\r\n          miradorDownloadDialogPlugin,\r\n          ...miradorImageToolsPlugin,\r\n          pageNumPlugin,\r\n          legacySearchPlugin,\r\n          navControlsPlugin\r\n          //textOverlayPlugin\r\n        ]\r\n    \r\n        //https://github.com/ProjectMirador/mirador/blob/master/src/config/settings.js\r\n        let mconfig = {\r\n    \r\n          id: 'page-viewer', // id selector where Mirador should be instantiated\r\n    \r\n          canvasNavigation: {\r\n    \r\n            // Set the height and width of canvas thumbnails in the  CanvasNavigation companion window\r\n    \r\n            height: 50,\r\n    \r\n            width: 50\r\n    \r\n          },\r\n    \r\n          selectedTheme: \"light\", // dark also available\r\n    \r\n          themes: {\r\n    \r\n            dark: {\r\n    \r\n              palette: {\r\n    \r\n                type: \"dark\",\r\n    \r\n                primary: {\r\n    \r\n                  main: \"#4db6ac\"\r\n    \r\n                },\r\n    \r\n                secondary: {\r\n    \r\n                  main: \"#4db6ac\"\r\n    \r\n                },\r\n    \r\n                shades: {\r\n    \r\n                  dark: \"#000000\",\r\n    \r\n                  main: \"#424242\",\r\n    \r\n                  light: \"#616161\"\r\n    \r\n                }\r\n    \r\n              }\r\n    \r\n            },\r\n    \r\n            light: {\r\n    \r\n              palette: {\r\n    \r\n                type: \"light\"\r\n    \r\n              }\r\n    \r\n            }\r\n    \r\n          },\r\n    \r\n          theme: {\r\n    \r\n            // Sets up a MaterialUI theme. See https://material-ui.com/customization/default-theme/\r\n    \r\n            palette: {\r\n    \r\n              type: \"light\",\r\n    \r\n              primary: {\r\n    \r\n                main: \"#3a78ae\" // Controls the color of the Add button and current window indicator\r\n    \r\n              },\r\n    \r\n              secondary: {\r\n    \r\n                main: \"#3a78ae\" // Controls the color of Selects and FormControls\r\n    \r\n              },\r\n    \r\n              shades: {\r\n    \r\n                // Shades that can be used to offset color areas of the Workspace / Window\r\n    \r\n                dark: \"#eeeeee\",\r\n    \r\n                main: \"#ffffff\",\r\n    \r\n                light: \"#f5f5f5\"\r\n    \r\n              },\r\n    \r\n              error: {\r\n    \r\n                main: \"#b00020\"\r\n    \r\n              },\r\n    \r\n              notification: {\r\n    \r\n                // Color used in MUI Badge dots\r\n    \r\n                main: \"#ffa224\"\r\n    \r\n              },\r\n    \r\n              hitCounter: {\r\n    \r\n                default: \"#bdbdbd\"\r\n    \r\n              },\r\n    \r\n              highlights: {\r\n    \r\n                primary: \"#ffff00\",\r\n    \r\n                secondary: \"#00BFFF\"\r\n    \r\n              },\r\n    \r\n              section_divider: \"rgba(0, 0, 0, 0.25)\",\r\n    \r\n              annotations: {\r\n    \r\n                hidden: { globalAlpha: 0 },\r\n    \r\n                default: { strokeStyle: \"#00BFFF\", globalAlpha: 1 },\r\n    \r\n                hovered: { strokeStyle: \"#BF00FF\", globalAlpha: 1 },\r\n    \r\n                selected: { strokeStyle: \"#ffff00\", globalAlpha: 1 }\r\n    \r\n              },\r\n    \r\n              search: {\r\n    \r\n                default: { fillStyle: \"#00BFFF\", globalAlpha: 0.3 },\r\n    \r\n                hovered: { fillStyle: \"#00FFFF\", globalAlpha: 0.3 },\r\n    \r\n                selected: { fillStyle: \"#ffff00\", globalAlpha: 0.3 }\r\n    \r\n              }\r\n    \r\n            },\r\n    \r\n            typography: {\r\n    \r\n              body1: {\r\n    \r\n                fontSize: \"1rem\",\r\n    \r\n                letterSpacing: \"0em\",\r\n    \r\n                lineHeight: \"1.6em\"\r\n    \r\n              },\r\n    \r\n              body2: {\r\n    \r\n                fontSize: \"0.878rem\",\r\n    \r\n                letterSpacing: \"0.015em\",\r\n    \r\n                lineHeight: \"1.6em\"\r\n    \r\n              },\r\n    \r\n              button: {\r\n    \r\n                fontSize: \"0.878rem\",\r\n    \r\n                letterSpacing: \"0.09em\",\r\n    \r\n                lineHeight: \"2.25rem\",\r\n    \r\n                textTransform: \"uppercase\"\r\n    \r\n              },\r\n    \r\n              caption: {\r\n    \r\n                fontSize: \"0.772rem\",\r\n    \r\n                letterSpacing: \"0.033em\",\r\n    \r\n                lineHeight: \"1.6rem\"\r\n    \r\n              },\r\n    \r\n              body1Next: {\r\n    \r\n                fontSize: \"1rem\",\r\n    \r\n                letterSpacing: \"0em\",\r\n    \r\n                lineHeight: \"1.6em\"\r\n    \r\n              },\r\n    \r\n              body2Next: {\r\n    \r\n                fontSize: \"0.878rem\",\r\n    \r\n                letterSpacing: \"0.015em\",\r\n    \r\n                lineHeight: \"1.6em\"\r\n    \r\n              },\r\n    \r\n              buttonNext: {\r\n    \r\n                fontSize: \"0.878rem\",\r\n    \r\n                letterSpacing: \"0.09em\",\r\n    \r\n                lineHeight: \"2.25rem\"\r\n    \r\n              },\r\n    \r\n              captionNext: {\r\n    \r\n                fontSize: \"0.772rem\",\r\n    \r\n                letterSpacing: \"0.33em\",\r\n    \r\n                lineHeight: \"1.6rem\"\r\n    \r\n              },\r\n    \r\n              overline: {\r\n    \r\n                fontSize: \"0.678rem\",\r\n    \r\n                fontWeight: 500,\r\n    \r\n                letterSpacing: \"0.166em\",\r\n    \r\n                lineHeight: \"2em\",\r\n    \r\n                textTransform: \"uppercase\"\r\n    \r\n              },\r\n    \r\n              h1: {\r\n    \r\n                fontSize: \"2.822rem\",\r\n    \r\n                letterSpacing: \"-0.015em\",\r\n    \r\n                lineHeight: \"1.2em\"\r\n    \r\n              },\r\n    \r\n              h2: {\r\n    \r\n                fontSize: \"1.575rem\",\r\n    \r\n                letterSpacing: \"0em\",\r\n    \r\n                lineHeight: \"1.33em\"\r\n    \r\n              },\r\n    \r\n              h3: {\r\n    \r\n                fontSize: \"1.383rem\",\r\n    \r\n                fontWeight: 300,\r\n    \r\n                letterSpacing: \"0em\",\r\n    \r\n                lineHeight: \"1.33em\"\r\n    \r\n              },\r\n    \r\n              h4: {\r\n    \r\n                fontSize: \"1rem\",\r\n    \r\n                letterSpacing: \"0.007em\",\r\n    \r\n                lineHeight: \"1.45em\"\r\n    \r\n              },\r\n    \r\n              h5: {\r\n    \r\n                fontSize: \"1rem\",\r\n    \r\n                letterSpacing: \"0.005em\",\r\n    \r\n                lineHeight: \"1.55em\"\r\n    \r\n              },\r\n    \r\n              h6: {\r\n    \r\n                fontSize: \"1rem\",\r\n    \r\n                fontWeight: 400,\r\n    \r\n                letterSpacing: \"0.01em\",\r\n    \r\n                lineHeight: \"1.6em\"\r\n    \r\n              },\r\n    \r\n              subtitle1: {\r\n    \r\n                fontSize: \"0.937rem\",\r\n    \r\n                letterSpacing: \"0.015em\",\r\n    \r\n                lineHeight: \"1.6em\",\r\n    \r\n                fontWeight: 300\r\n    \r\n              },\r\n    \r\n              subtitle2: {\r\n    \r\n                fontSize: \"0.878rem\",\r\n    \r\n                fontWeight: 500,\r\n    \r\n                letterSpacing: \"0.02em\",\r\n    \r\n                lineHeight: \"1.75em\"\r\n    \r\n              },\r\n    \r\n              useNextVariants: true // set so that console deprecation warning is removed\r\n    \r\n            },\r\n    \r\n            overrides: {\r\n    \r\n              MuiListSubheader: {\r\n    \r\n                root: {\r\n    \r\n                  '&[role=\"presentation\"]:focus': {\r\n    \r\n                    outline: 0\r\n    \r\n                  }\r\n    \r\n                }\r\n    \r\n              },\r\n    \r\n              MuiTooltip: {\r\n    \r\n                // Overridden from https://github.com/mui-org/material-ui/blob/master/packages/material-ui/src/Tooltip/Tooltip.js#L40-L70\r\n    \r\n                tooltipPlacementLeft: {\r\n    \r\n                  [\"@media (min-width:600px)\"]: {\r\n    \r\n                    margin: 0\r\n    \r\n                  }\r\n    \r\n                },\r\n    \r\n                tooltipPlacementRight: {\r\n    \r\n                  [\"@media (min-width:600px)\"]: {\r\n    \r\n                    margin: 0\r\n    \r\n                  }\r\n    \r\n                },\r\n    \r\n                tooltipPlacementTop: {\r\n    \r\n                  [\"@media (min-width:600px)\"]: {\r\n    \r\n                    margin: 0\r\n    \r\n                  }\r\n    \r\n                },\r\n    \r\n                tooltipPlacementBottom: {\r\n    \r\n                  [\"@media (min-width:600px)\"]: {\r\n    \r\n                    margin: 0\r\n    \r\n                  }\r\n    \r\n                }\r\n    \r\n              },\r\n    \r\n              MuiTouchRipple: {\r\n    \r\n                childPulsate: {\r\n    \r\n                  animation: \"none\"\r\n    \r\n                },\r\n    \r\n                rippleVisible: {\r\n    \r\n                  animation: \"none\"\r\n    \r\n                }\r\n    \r\n              }\r\n    \r\n            },\r\n    \r\n            props: {\r\n    \r\n              MuiButtonBase: {\r\n    \r\n                disableTouchRipple: true\r\n    \r\n              },\r\n    \r\n              MuiLink: {\r\n    \r\n                underline: \"always\"\r\n    \r\n              }\r\n    \r\n            }\r\n    \r\n          },\r\n    \r\n          language: \"en\", // The default language set in the application\r\n    \r\n          availableLanguages: {\r\n    \r\n            // All the languages available in the language switcher\r\n    \r\n            ar: \"العربية\",\r\n    \r\n            de: \"Deutsch\",\r\n    \r\n            en: \"English\",\r\n    \r\n            fa: \"فارسی\",\r\n    \r\n            fr: \"Français\",\r\n    \r\n            ja: \"日本語\",\r\n    \r\n            kr: \"한국어\",\r\n    \r\n            lt: \"Lietuvių\",\r\n    \r\n            nl: \"Nederlands\",\r\n    \r\n            \"nb-NO\": \"Norwegian Bokmål\",\r\n    \r\n            pl: \"Polski\",\r\n    \r\n            \"pt-BR\": \"Português do Brasil\",\r\n    \r\n            vi: \"Tiếng Việt\",\r\n    \r\n            \"zh-CN\": \"中文(简体)\",\r\n    \r\n            \"zh-TW\": \"中文(繁體)\",\r\n    \r\n            it: \"Italiano\",\r\n    \r\n            sr: \"Српски\",\r\n    \r\n            sv: \"Svenska\",\r\n    \r\n            bg: \"Български\"\r\n    \r\n          },\r\n    \r\n          annotations: {\r\n    \r\n            htmlSanitizationRuleSet: \"iiif\", // See src/lib/htmlRules.js for acceptable values\r\n    \r\n            filteredMotivations: [\r\n    \r\n              \"oa:commenting\",\r\n    \r\n              \"oa:tagging\",\r\n    \r\n              \"sc:painting\",\r\n    \r\n              \"commenting\",\r\n    \r\n              \"tagging\"\r\n    \r\n            ]\r\n    \r\n          },\r\n    \r\n          createGenerateClassNameOptions: {\r\n    \r\n            // Options passed directly to createGenerateClassName in Material-UI https://material-ui.com/styles/api/#creategenerateclassname-options-class-name-generator\r\n    \r\n            productionPrefix: \"mirador\"\r\n    \r\n          },\r\n    \r\n          requests: {\r\n    \r\n            preprocessors: [\r\n    \r\n              // Functions that receive HTTP requests and manipulate them (e.g. to add headers)\r\n    \r\n              // (url, options) => (url.match('info.json') && { ...options, myCustomThing: 'blah' })\r\n    \r\n            ],\r\n    \r\n            postprocessors: [\r\n    \r\n              // Functions that receive HTTP responses and manipulates them before adding to store\r\n    \r\n              // An example of manipulating the response for an annotation request\r\n    \r\n              // (url, action) => {\r\n    \r\n              //   if (action.annotationId) {\r\n    \r\n              //     action.annotationJson = {}\r\n    \r\n              //   }\r\n    \r\n              // }\r\n    \r\n            ]\r\n    \r\n          },\r\n    \r\n          translations: {\r\n    \r\n            // Translations can be added to inject new languages or override existing labels\r\n            en: { \r\n              \"currentItem\": \"Current image\",\r\n              \"currentItem_1/1\": \"Current image\",\r\n              \"resource\": \"Item Title\",\r\n            }\r\n    \r\n          },\r\n    \r\n    \r\n          view: \"catalogueView\",\r\n    \r\n          window: {\r\n\r\n            imageToolsOpen: false,\r\n    \r\n            //global window defaults\r\n    \r\n            allowClose: false, // Configure if windows can be closed or not\r\n    \r\n            allowFullscreen: false, // Configure to show a \"fullscreen\" button in the WindowTopBar\r\n    \r\n            allowMaximize: false, // Configure if windows can be maximized or not\r\n    \r\n            allowTopMenuButton: false, // Configure if window view and thumbnail display menu are visible or not\r\n    \r\n            allowWindowSideBar: false, // Configure if side bar menu is visible or not\r\n    \r\n            authNewWindowCenter: \"parent\", // Configure how to center a new window created by the authentication flow. Options: parent, screen\r\n    \r\n            sideBarPanel: \"info\", // Configure which sidebar is selected by default. Options: info, attribution, canvas, annotations, search\r\n    \r\n            defaultSidebarPanelHeight: 201, // Configure default sidebar height in pixels\r\n    \r\n            defaultSidebarPanelWidth: 235, // Configure default sidebar width in pixels\r\n    \r\n            defaultView: \"single\", // Configure which viewing mode (e.g. single, book, gallery) for windows to be opened in\r\n    \r\n            forceDrawAnnotations: false,\r\n    \r\n            hideWindowTitle: false, // Configure if the window title is shown in the window title bar or not\r\n    \r\n            highlightAllAnnotations: false, // Configure whether to display annotations on the canvas by default\r\n    \r\n            showLocalePicker: false, // Configure locale picker for multi-lingual metadata\r\n    \r\n            sideBarOpen:  false, // Configure if the sidebar (and its content panel) is open by default\r\n    \r\n            switchCanvasOnSearch: true, // Configure if Mirador should automatically switch to the canvas of the first search result\r\n    \r\n            panels: {\r\n    \r\n              // Configure which panels are visible in WindowSideBarButtons\r\n    \r\n              info: false,\r\n    \r\n              attribution: false,\r\n    \r\n              canvas: false,\r\n    \r\n              annotations: false,\r\n    \r\n              search: false,\r\n    \r\n              layers: false\r\n    \r\n            },\r\n    \r\n            views: [\r\n    \r\n              { key: \"single\", behaviors: [\"individuals\"] },\r\n    \r\n              { key: \"book\", behaviors: [\"paged\"] },\r\n    \r\n              { key: \"scroll\", behaviors: [\"continuous\"] },\r\n    \r\n              { key: \"gallery\" }\r\n    \r\n            ],\r\n    \r\n            elastic: {\r\n    \r\n              height: 400,\r\n    \r\n              width: 480\r\n    \r\n            }\r\n    \r\n          },\r\n          \r\n          windows: [{\r\n            manifestId: manifest,\r\n            //view: 'single',\r\n            canvasIndex,\r\n          }],\r\n    \r\n          thumbnails: {\r\n    \r\n            preferredFormats: [\"jpg\", \"png\", \"webp\", \"tif\"]\r\n    \r\n          },\r\n    \r\n          thumbnailNavigation: {\r\n    \r\n            defaultPosition: \"off\", // Which position for the thumbnail navigation to be be displayed. Other possible values are \"far-bottom\" or \"far-right\"\r\n    \r\n            displaySettings: false, // Display the settings for this in WindowTopMenu\r\n    \r\n            height: 130, // height of entire ThumbnailNavigation area when position is \"far-bottom\"\r\n    \r\n            width: 100 // width of one canvas (doubled for book view) in ThumbnailNavigation area when position is \"far-right\"\r\n    \r\n          },\r\n    \r\n          \r\n          workspace: {\r\n    \r\n            draggingEnabled: false,\r\n    \r\n            allowNewWindows: true,\r\n    \r\n            isWorkspaceAddVisible: false, // Catalog/Workspace add window feature visible by default\r\n    \r\n            exposeModeOn: false, // unused?\r\n    \r\n            height: 5000, // height of the elastic mode's virtual canvas\r\n    \r\n            showZoomControls: false, // Configure if zoom controls should be displayed by default\r\n    \r\n            type: \"mosaic\", // Which workspace type to load by default. Other possible values are \"elastic\". If \"mosaic\" or \"elastic\" are not selected no worksapce type will be used.\r\n    \r\n            viewportPosition: {\r\n    \r\n              // center coordinates for the elastic mode workspace\r\n    \r\n              x: 0,\r\n    \r\n              y: 0\r\n    \r\n            },\r\n    \r\n            width: 5000 // width of the elastic mode's virtual canvas\r\n    \r\n          },\r\n    \r\n          workspaceControlPanel: {\r\n    \r\n            enabled: false // Configure if the control panel should be rendered.  Useful if you want to lock the viewer down to only the configured manifests\r\n    \r\n          },\r\n    \r\n          galleryView: {\r\n    \r\n            height: 120, // height of gallery view thumbnails\r\n    \r\n            width: null // width of gallery view thumbnails (or null, to auto-calculate an aspect-ratio appropriate size)\r\n    \r\n          },\r\n    \r\n          osdConfig: {\r\n    \r\n            // Default config used for OpenSeadragon https://openseadragon.github.io/docs/OpenSeadragon.html#.Options\r\n    \r\n            alwaysBlend: false,\r\n    \r\n            blendTime: 0.1,\r\n    \r\n            preserveImageSizeOnResize: true,\r\n    \r\n            preserveViewport: true,\r\n    \r\n            zoomPerScroll: 1.2,\r\n    \r\n            gestureSettingsMouse: {\r\n              scrollToZoom: true,\r\n              clickToZoom: true,\r\n              dblClickToZoom: true\r\n            },\r\n    \r\n            gestureSettingsTouch: {\r\n              scrollToZoom: false,\r\n              dragToPan: false\r\n            },\r\n\r\n            minScrollDeltaTime: 0,\r\n            clickTimeThreshold: 0,\r\n            zoomPerSecond: 1.2,\r\n            showNavigator: true,\r\n            autoHideControls: false,\r\n            showNavigationControl: true,\r\n            navigatorPosition: \"BOTTOM_RIGHT\",\r\n            showFullPageControl: true\r\n          },\r\n    \r\n          export: {\r\n    \r\n            catalog: true,\r\n    \r\n            companionWindows: true,\r\n    \r\n            config: true,\r\n    \r\n            elasticLayout: true,\r\n    \r\n            layers: true,\r\n    \r\n            // filter out anything re-retrievable:\r\n    \r\n            manifests: { filter: ([id, value]) => !id.startsWith(\"http\") },\r\n    \r\n            viewers: true,\r\n    \r\n            windows: true,\r\n    \r\n            workspace: true\r\n    \r\n          },\r\n    \r\n          audioOptions: {\r\n    \r\n            // Additional props passed to <audio> element\r\n    \r\n            controls: true,\r\n    \r\n            crossOrigin: \"anonymous\"\r\n    \r\n          },\r\n    \r\n          videoOptions: {\r\n    \r\n            // Additional props passed to <audio> element\r\n    \r\n            controls: true,\r\n    \r\n            crossOrigin: \"anonymous\"\r\n    \r\n          }\r\n    \r\n        }\r\n\r\n        let miradorInstance = Mirador.viewer(mconfig, mplugins)\r\n        console.log(miradorInstance)\r\n\r\n        miradorInstance.store.subscribe(() => {\r\n          /*Enable keyboard nav of canvas controls*/\r\n          let zoomIns = document.querySelectorAll('[title=\"Zoom in\"]')\r\n          //console.log(zoomIns)\r\n          if(zoomIns.length) {\r\n            zoomIns[0].setAttribute(\"tabindex\", \"0\")\r\n          }\r\n          let zoomOuts = document.querySelectorAll('[title=\"Zoom out\"]')\r\n          //console.log(zoomOuts)\r\n          if(zoomOuts.length) {\r\n            zoomOuts[0].setAttribute(\"tabindex\", \"0\")\r\n          }\r\n          let resets = document.querySelectorAll('[title=\"Go home\"]')\r\n          //console.log(resets)\r\n          if(resets.length) {\r\n            resets[0].setAttribute(\"tabindex\", \"0\")\r\n          }\r\n          let fullscreens = document.querySelectorAll('[title=\"Toggle full page\"]')\r\n          //console.log(fullscreens)\r\n          if(fullscreens.length) {\r\n            fullscreens[0].setAttribute(\"tabindex\", \"0\")\r\n          }\r\n        })\r\n     \r\n  }\r\n}\r\n","import M3Viewer from \"../src/modules/m3_viewer.js\";\r\nM3Viewer.init();\r\n"],"names":["ImageTool","_Component","props","_this","_classCallCheck","_callSuper","state","open","handleChange","bind","_assertThisInitialized","handleClick","_inherits","key","value","_this$props","this","variant","setState","e","val","onChange","bubbleBg","_this$props2","children","containerId","label","max","min","type","windowId","foregroundColor","classes","width","toggled","id","concat","fade","React","style","display","MiradorMenuButton","onClick","backgroundColor","className","slider","Slider","orientation","indexOf","Component","defaultProps","compose","withStyles","_ref","palette","breakpoints","shades","main","borderRadius","top","marginTop","position","height","zIndex","marginLeft","padding","down","right","marginBottom","withWidth","ImageRotation","arguments","otherProps","_objectWithoutProperties","_excluded","Object","assign","RotateLeftIcon","RotateRightIcon","ImageFlip","flipped","SwapHorizIcon","color","MiradorImageTools","toggleState","toggleRotate","toggleFlip","handleReset","viewer","applyFilters","prevProps","viewConfig","param","updateViewport","_defineProperty","_this$props3","rotation","flip","brightness","contrast","saturate","grayscale","invert","_this$props4","_this$props4$viewConf","_this$props4$viewConf2","_this$props4$viewConf3","_this$props4$viewConf4","_this$props4$viewConf5","_this$props4$viewConf6","canvas","controlledFilters","newFilters","filter","split","some","includes","push","join","_this$props5","updateWindow","imageToolsOpen","_this$props6","_this$props6$viewConf","_this$props6$viewConf2","_this$props6$viewConf3","_this$props7","_this$props7$viewConf","_this2","_this$props8","enabled","theme","_this$props8$viewConf","_this$props8$viewConf2","_this$props8$viewConf3","_this$props8$viewConf4","_this$props8$viewConf5","_this$props8$viewConf6","_this$props8$viewConf7","t","getContrastText","isSmallDisplay","toggleButton","borderContainer","context","CloseSharpIcon","TuneSharpIcon","toggleButtonLabel","root","BrightnessIcon","ContrastIcon","transform","GradientIcon","TonalityIcon","InvertColorsIcon","ReplaySharpIcon","undefined","border","borderImageRight","borderImageBottom","replace","flexDirection","borderRight","borderImageSlice","borderImageSource","borderBottom","fontSize","MiradorImageToolsMenuItem","handleClose","MenuItem","imageToolsEnabled","ListItemIcon","ListItemText","primaryTypographyProps","de","collapse_open","collapse_close","greyscale","hide","revert","rotateLeft","rotateRight","saturation","show","en","it","fr","ja","sr","target","mapDispatchToProps","actions","mapStateToProps","getContainerId","getWindowConfig","getViewer","mode","component","withTheme","config","translations","_ref2","FullResDownload","canvasIndex","manifestId","console","log","url","filename","page","__jsonld","items","body","fetch","method","then","response","blob","window","URL","createObjectURL","a","document","createElement","href","download","appendChild","click","remove","tabIndex","downloadAndCloseMenu","DownloadIcon","name","getCanvasIndex","getCurrentCanvas","windows","PDFDownload","parts","pathname","length","json","data","_data$canvasDownloadU","alert","FullPDFDownload","_data$docPdfUri","MiradorDownload","openDownloadDialog","openDialogAndCloseMenu","dispatch","dialogType","reducers","windowDialogs","action","_objectSpread","openDialog","RenderingDownloadLink","rendering","ListItem","disableGutters","divider","Link","rel","getLabel","getValue","getFormat","CanvasDownloadLinks","bounds","currentBounds","Math","floor","getWidth","getHeight","boundsUrl","getCanonicalImageUri","x","y","size","OSDReferences","get","current","viewport","osdViewport","getBounds","keys","reduce","object","ceil","infoResponse","_infoResponse$json","definedSizes","restrictDownloadOnSizeDefinition","viewType","definedSizesRestrictsDownload","sizes","uniqBy","fullImageUrl","fullImageLabel","thousandPixelWideImage","smallImageLabel","map","imageUrlForSize","canvasLabel","Typography","noWrap","h3","List","displayCurrentZoomLink","zoomedImageUrl","zoomedImageLabel","fullImageLink","thousandPixelWideLink","linksForDefinedSizes","getRenderings","ManifestDownloadLinks","renderings","MiradorDownloadDialog","manifest","getSequences","canvases","closeDialog","Dialog","container","querySelector","disableEnforceFocus","onClose","scroll","fullWidth","maxWidth","DialogTitle","disableTypography","h2","ScrollIndicatedDialogContent","DialogActions","Button","paddingBottom","getVisibleCanvases","canvasId","getCanvasLabel","selectInfoResponse","getManifestoInstance","miradorDownloadPlugin","getWindowViewType","_regeneratorRuntime","r","prototype","n","hasOwnProperty","o","defineProperty","i","Symbol","iterator","c","asyncIterator","u","toStringTag","define","enumerable","configurable","writable","wrap","Generator","create","Context","makeInvokeMethod","tryCatch","arg","call","h","l","f","s","GeneratorFunction","GeneratorFunctionPrototype","p","d","getPrototypeOf","v","values","g","defineIteratorMethods","forEach","_invoke","AsyncIterator","invoke","resolve","__await","callInvokeWithMethodAndArg","Error","done","delegate","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","TypeError","resultName","next","nextLoc","pushTryEntry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","resetTryEntry","completion","reset","isNaN","displayName","isGeneratorFunction","constructor","mark","setPrototypeOf","__proto__","awrap","async","Promise","reverse","pop","prev","charAt","slice","stop","rval","handle","complete","finish","delegateYield","_defineProperties","descriptor","_toPropertyKey","_getPrototypeOf","self","_possibleConstructorReturn","_isNativeReflectConstruct","Reflect","construct","apply","Boolean","valueOf","ReferenceError","_setPrototypeOf","ownKeys","getOwnPropertySymbols","getOwnPropertyDescriptor","getOwnPropertyDescriptors","defineProperties","obj","toPrimitive","String","Number","_toPrimitive","asyncGeneratorStep","gen","reject","_next","_throw","info","error","_asyncToGenerator","fn","args","err","checkStreamsaverSupport","Response","WritableStream","isSecureContext","navigator","checkImageApiHasCors","_checkImageApiHasCors","_callee2","_images$0$Id","testImgResp","testImgData","_context2","images","t0","Uint8Array","arrayBuffer","t1","t2","PDIIIFMenuItem","instance","Constructor","hasChecked","allowPdfDownload","supportsFilesystemAPI","showSaveFilePicker","supportsStreamsaver","imageApiHasCors","protoProps","staticProps","_componentDidMount","subClass","superClass","_callee","canvasGroupings","setAllowPdfDownload","setEstimatedSize","_this$state","estimatedSizeInBytes","_context","estimatePdfSize","disabled","renderMenuItemText","CircularProgress","progress","openPDIIIFDialog","_state$PDIIIF$windowI","_state$PDIIIF$windowI2","manifests","getCanvasGroupings","PDIIIF","PDFDownloadEnabled","Array","isArray","DownloadWindowTopBarPluginMenu","anchorEl","handleMenuClick","handleMenuClose","event","currentTarget","PluginComponents","menuIcon","windowPluginMenuId","class","tabindex","PluginHook","MoreVertIcon","miradorPDIIIFMenuItemPlugin","ctrlBtnSelected","selected","withPlugins","createRange","start","end","from","_","PDIIIFDialog","isDownloading","msg","preventDefault","returnValue","canvasIds","pageError","indexSpec","filteredCanvasIds","parseCanvasRanges","_this$state2","abortController","webWritable","abort","AbortController","signal","addEventListener","resetDownloadState","once","status","round","pagesWritten","totalPages","_this$state3","progressContainer","Box","alignItems","mr","LinearProgress","minWidth","manifestLabel","_this$state4","suggestedName","date","Date","getYear","getMonth","getDate","downloadWithFilesystemAPI","downloadWithStreamsaver","savingError","pdfPath","_manifestConverter","_downloadWithStreamsaver","_downloadWithFilesystemAPI","canvasCount","canvasIdxs","Set","idxs","group","newIdxs","startsWith","parseInt","endsWith","_parts$map2","_slicedToArray","num","find","out","has","mitmPath","streamSaver","prevState","_this$state5","handleBeforeUnload","handleUnload","removeEventListener","_callee3","file","_webWritable","_context3","types","description","accept","message","queryPermission","getFile","createWritable","manifestConverter","_x","_callee4","_context4","_x2","_callee6","coverPageEndpoint","_this$state6","_this3","_context6","attachAbortListener","_callee5","_context5","convertManifest","concurrency","filterCanvases","onProgress","updateProgress","_x3","_this$state7","estimatedSize","fileSizeText","bytes","decimals","dm","parseFloat","pow","toFixed","formatBytes","DialogContent","DialogContentText","renderProgress","TextField","margin","placeholder","handlePageChange","cancelDownload","downloadPDF","disabledButton","opacity","_state$config$mirador","_state$config$mirador2","getCanvases","miradorPDIIIFPlugin","getManifestTitle","PageNumPlugin","TargetComponent","targetProps","pageNum","queryParams","URLSearchParams","location","search","queryPageNum","set","history","pushState","toString","ViewPlugin","WindowViewSettings","ViewerNavigation","_createClass","hasNextCanvas","hasPreviousCanvas","setNextCanvas","setPreviousCanvas","viewingDirection","setCanvas","lastCanvas","firstCanvas","htmlDir","previousIconStyle","nextIconStyle","classNames","ns","dir","title","SkipNextIcon","NavigationIcon","NavControlsPlugin","_Component2","_this$props$canvases","_this$state$selectOpt","_this$props$canvases2","_this$state$canvasIds","_this$state$canvasIds2","selectOptions","selectedOption","index","_prevProps$currentCan","currentCanvas","_step","_iterator","_createForOfIteratorHelper","forceUpdate","isEqual","left","Select","options","getNextCanvasGrouping","getPreviousCanvasGrouping","getSequenceViewingDirection","LegacySearchPlugin","query","results","currentResultIndex","currentCanvasIndex","resultsListOpen","resultsMenuOpen","itemOffset","endOffset","currentItems","pageCount","itemsPerPage","getElementById","urlArr","q","content","handleClear","newPage","queryString","background","autocomplete","autocorrect","autocapitalize","enterkeyhint","spellcheck","defaultValue","handleSearch","xmlns","fill","viewBox","ClearIcon","result","Card","CardHeader","CardMedia","image","justifyContent","ArrowBackIcon","paddingRight","Pagination","count","handleChangePage","Mirador","pageViewer","documentId","getAttribute","params","mplugins","miradorViewPlugin","downloadMenuPlugin","fullResDownloadPlugin","pdfDownloadPlugin","fullPdfDownloadPlugin","miradorPDIIIFDialogPlugin","miradorShareDialogPlugin","miradorDownloadDialogPlugin","_toConsumableArray","miradorImageToolsPlugin","pageNumPlugin","legacySearchPlugin","navControlsPlugin","mconfig","canvasNavigation","selectedTheme","themes","dark","primary","secondary","light","notification","hitCounter","default","highlights","section_divider","annotations","hidden","globalAlpha","strokeStyle","hovered","fillStyle","typography","body1","letterSpacing","lineHeight","body2","button","textTransform","caption","body1Next","body2Next","buttonNext","captionNext","overline","fontWeight","h1","h4","h5","h6","subtitle1","subtitle2","useNextVariants","overrides","MuiListSubheader","outline","MuiTooltip","tooltipPlacementLeft","tooltipPlacementRight","tooltipPlacementTop","tooltipPlacementBottom","MuiTouchRipple","childPulsate","animation","rippleVisible","MuiButtonBase","disableTouchRipple","MuiLink","underline","language","availableLanguages","ar","fa","kr","lt","nl","pl","vi","sv","bg","htmlSanitizationRuleSet","filteredMotivations","createGenerateClassNameOptions","productionPrefix","requests","preprocessors","postprocessors","view","allowClose","allowFullscreen","allowMaximize","allowTopMenuButton","allowWindowSideBar","authNewWindowCenter","sideBarPanel","defaultSidebarPanelHeight","defaultSidebarPanelWidth","defaultView","forceDrawAnnotations","hideWindowTitle","highlightAllAnnotations","showLocalePicker","sideBarOpen","switchCanvasOnSearch","panels","attribution","layers","views","behaviors","elastic","thumbnails","preferredFormats","thumbnailNavigation","defaultPosition","displaySettings","workspace","draggingEnabled","allowNewWindows","isWorkspaceAddVisible","exposeModeOn","showZoomControls","viewportPosition","workspaceControlPanel","galleryView","osdConfig","alwaysBlend","blendTime","preserveImageSizeOnResize","preserveViewport","zoomPerScroll","gestureSettingsMouse","scrollToZoom","clickToZoom","dblClickToZoom","gestureSettingsTouch","dragToPan","minScrollDeltaTime","clickTimeThreshold","zoomPerSecond","showNavigator","autoHideControls","showNavigationControl","navigatorPosition","showFullPageControl","export","catalog","companionWindows","elasticLayout","viewers","audioOptions","controls","crossOrigin","videoOptions","miradorInstance","store","subscribe","zoomIns","querySelectorAll","setAttribute","zoomOuts","resets","fullscreens","M3Viewer"],"sourceRoot":""}