import*as r from"@babel/runtime/helpers/defineProperty";import*as t from"@babel/runtime/helpers/objectWithoutPropertiesLoose";import*as n from"react";var i="default"in r?r.default:r;var c="default"in t?t.default:t;var a="default"in n?n.default:n;var d={};(function(r,t){t(d,i,c,a)})(0,(function(r,t,n,i){function e(r){return r&&"object"==typeof r&&"default"in r?r:{default:r}}function f(r,t){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),n.push.apply(n,i)}return n}function g(r){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?f(Object(t),!0).forEach((function(n){c.default(r,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):f(Object(t)).forEach((function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))}));return r}function h(r){var t=r.srcList,n=r.imgPromise,c=void 0===n?o({decode:!0}):n,a=r.useSuspense,d=void 0===a||a,O=i.useState(!1),b=O[1],v=p(q(t)),m=v.join("");if(l[m]||(l[m]={promise:s(v,c),cache:"pending",error:null}),"resolved"===l[m].cache)return{src:l[m].src,isLoading:!1,error:null};if("rejected"===l[m].cache){if(d)throw l[m].error;return{isLoading:!1,error:l[m].error,src:void 0}}if(l[m].promise.then((function(r){l[m]=g(g({},l[m]),{},{cache:"resolved",src:r}),d||b(m)})).catch((function(r){l[m]=g(g({},l[m]),{},{cache:"rejected",error:r}),d||b(m)})),d)throw l[m].promise;return{isLoading:!0,src:void 0,error:null}}function j(r,t){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),n.push.apply(n,i)}return n}function k(r){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?j(Object(t),!0).forEach((function(n){c.default(r,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):j(Object(t)).forEach((function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))}));return r}var c=e(t),a=e(n),d=e(i),o=function(r){var t=r.decode,n=r.crossOrigin,i=void 0===n?"":n;return function(r){return new Promise((function(n,c){var a=new Image;i&&(a.crossOrigin=i),a.onload=function(){void 0!==t&&!t||!a.decode?n():a.decode().then(n).catch(c)},a.onerror=c,a.src=r}))}},p=function(r){return r.filter((function(r){return r}))},q=function(r){return Array.isArray(r)?r:[r]},l={},s=function(r,t){var n=!1;return new Promise((function(i,c){var f=function(r){return t(r).then((function(){n=!0,i(r)}))};r.reduce((function(r,t){return r.catch((function(){if(!n)return f(t)}))}),f(r.shift())).catch(c)}))},O=["decode","src","loader","unloader","container","loaderContainer","unloaderContainer","imgPromise","crossorigin","useSuspense"],u=function(r){return r};r.Img=function(r){var t=r.decode,n=r.src,i=void 0===n?[]:n,c=r.loader,l=void 0===c?null:c,b=r.unloader,v=void 0===b?null:b,m=r.container,y=void 0===m?u:m,P=r.loaderContainer,w=void 0===P?u:P,S=r.unloaderContainer,D=void 0===S?u:S,L=r.imgPromise,E=r.crossorigin,C=r.useSuspense,I=void 0!==C&&C,A=a.default(r,O);L=L||o({decode:!(void 0!==t)||t,crossOrigin:E});var _=h({srcList:i,imgPromise:L,useSuspense:I}),x=_.src,M=_.isLoading;return x?y(d.default.createElement("img",k({src:x},A))):!I&&M?w(l):!I&&v?D(v):null},r.useImage=h,Object.defineProperty(r,"__esModule",{value:!0})}));export{d as default};

