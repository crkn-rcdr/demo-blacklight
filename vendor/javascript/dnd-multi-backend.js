var D=(i,e,s)=>{if(!e.has(i))throw TypeError("Cannot "+s)};var t=(i,e,s)=>(D(i,e,"read from private field"),s?s.call(i):e.get(i)),o=(i,e,s)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,s)},p=(i,e,s,n)=>(D(i,e,"write to private field"),n?n.call(i,s):e.set(i,s),s);var i,e=class{constructor(){o(this,i,void 0);this.register=e=>{t(this,i).push(e)};this.unregister=e=>{let s;for(;-1!==(s=t(this,i).indexOf(e));)t(this,i).splice(s,1)};this.backendChanged=e=>{for(let s of t(this,i))s.backendChanged(e)};p(this,i,[])}};i=new WeakMap;var s,n,r,a,h,c,d,u,w,f,k,g=class l{constructor(i,g,v){o(this,s,void 0);o(this,n,void 0);o(this,r,void 0);o(this,a,void 0);o(this,h,void 0);o(this,c,((i,e,s)=>{if(!s.backend)throw new Error(`You must specify a 'backend' property in your Backend entry: ${JSON.stringify(s)}`);let n=s.backend(i,e,s.options),a=s.id,h=!s.id&&n&&n.constructor;if(h&&(a=n.constructor.name),!a)throw new Error(`You must specify an 'id' property in your Backend entry: ${JSON.stringify(s)}\n        see this guide: https://github.com/louisbrunner/dnd-multi-backend/tree/master/packages/react-dnd-multi-backend#migrating-from-5xx`);h&&console.warn("Deprecation notice: You are using a pipeline which doesn't include backends' 'id'.\n        This might be unsupported in the future, please specify 'id' explicitely for every backend.");if(t(this,r)[a])throw new Error(`You must specify a unique 'id' property in your Backend entry:\n        ${JSON.stringify(s)} (conflicts with: ${JSON.stringify(t(this,r)[a])})`);return{id:a,instance:n,preview:s.preview??!1,transition:s.transition,skipDispatchOnTransition:s.skipDispatchOnTransition??!1}}));this.setup=()=>{if(!(typeof window>"u")){if(l.isSetUp)throw new Error("Cannot have two MultiBackends at the same time.");l.isSetUp=!0,t(this,d).call(this,window),t(this,r)[t(this,s)].instance.setup()}};this.teardown=()=>{typeof window>"u"||(l.isSetUp=!1,t(this,u).call(this,window),t(this,r)[t(this,s)].instance.teardown())};this.connectDragSource=(i,e,s)=>t(this,k).call(this,"connectDragSource",i,e,s);this.connectDragPreview=(i,e,s)=>t(this,k).call(this,"connectDragPreview",i,e,s);this.connectDropTarget=(i,e,s)=>t(this,k).call(this,"connectDropTarget",i,e,s);this.profile=()=>t(this,r)[t(this,s)].instance.profile();this.previewEnabled=()=>t(this,r)[t(this,s)].preview;this.previewsList=()=>t(this,n);this.backendsList=()=>t(this,a);o(this,d,(i=>{t(this,a).forEach((e=>{e.transition&&i.addEventListener(e.transition.event,t(this,w))}))}));o(this,u,(i=>{t(this,a).forEach((e=>{e.transition&&i.removeEventListener(e.transition.event,t(this,w))}))}));o(this,w,(i=>{let e=t(this,s);if(t(this,a).some((e=>!(e.id===t(this,s)||!e.transition||!e.transition.check(i))&&(p(this,s,e.id),!0))),t(this,s)!==e){t(this,r)[e].instance.teardown(),Object.keys(t(this,h)).forEach((i=>{let e=t(this,h)[i];e.unsubscribe(),e.unsubscribe=t(this,f).call(this,e.func,...e.args)})),t(this,n).backendChanged(this);let a=t(this,r)[t(this,s)];if(a.instance.setup(),a.skipDispatchOnTransition)return;let c=i.constructor,d=new c(i.type,i);i.target?.dispatchEvent(d)}}));o(this,f,((i,e,n,a)=>t(this,r)[t(this,s)].instance[i](e,n,a)));o(this,k,((i,e,s,n)=>{let r=`${i}_${e}`,a=t(this,f).call(this,i,e,s,n);return t(this,h)[r]={func:i,args:[e,s,n],unsubscribe:a},()=>{t(this,h)[r].unsubscribe(),delete t(this,h)[r]}}));if(!v||!v.backends||v.backends.length<1)throw new Error("You must specify at least one Backend, if you are coming from 2.x.x (or don't understand this error)\n        see this guide: https://github.com/louisbrunner/dnd-multi-backend/tree/master/packages/react-dnd-multi-backend#migrating-from-2xx");p(this,n,new e),p(this,r,{}),p(this,a,[]),v.backends.forEach((e=>{let s=t(this,c).call(this,i,g,e);t(this,r)[s.id]=s,t(this,a).push(s)})),p(this,s,t(this,a)[0].id),p(this,h,{})}};s=new WeakMap,n=new WeakMap,r=new WeakMap,a=new WeakMap,h=new WeakMap,c=new WeakMap,d=new WeakMap,u=new WeakMap,w=new WeakMap,f=new WeakMap,k=new WeakMap,g.isSetUp=!1;var v=g;var P=(i,e,s)=>new v(i,e,s);var m=(i,e)=>({event:i,check:e});var b=m("touchstart",(i=>{let e=i;return null!==e.touches&&void 0!==e.touches})),y=m("dragstart",(i=>-1!==i.type.indexOf("drag")||-1!==i.type.indexOf("drop"))),M=m("mousedown",(i=>-1===i.type.indexOf("touch")&&-1!==i.type.indexOf("mouse"))),T=m("pointerdown",(i=>"mouse"==i.pointerType));export{y as HTML5DragTransition,M as MouseTransition,P as MultiBackend,T as PointerTransition,b as TouchTransition,m as createTransition};

