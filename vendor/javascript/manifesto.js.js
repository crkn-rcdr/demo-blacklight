var o="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;var l={};!function(o,c){l=c()}("undefined"!=typeof self&&self,(function(){return function(o){var l={};function r(c){if(l[c])return l[c].exports;var p=l[c]={i:c,l:!1,exports:{}};return o[c].call(p.exports,p,p.exports,r),p.l=!0,p.exports}return r.m=o,r.c=l,r.d=function(o,l,c){r.o(o,l)||Object.defineProperty(o,l,{enumerable:!0,get:c})},r.r=function(o){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},r.t=function(o,l){if(1&l&&(o=r(o)),8&l)return o;if(4&l&&"object"==typeof o&&o&&o.__esModule)return o;var c=Object.create(null);if(r.r(c),Object.defineProperty(c,"default",{enumerable:!0,value:o}),2&l&&"string"!=typeof o)for(var p in o)r.d(c,p,function(l){return o[l]}.bind(null,p));return c},r.n=function(o){var l=o&&o.__esModule?function(){return o.default}:function(){return o};return r.d(l,"a",l),l},r.o=function(o,l){return Object.prototype.hasOwnProperty.call(o,l)},r.p="",r(r.s=7)}([function(o,l,c){function n(o){for(var c in o)l.hasOwnProperty(c)||(l[c]=o[c])}Object.defineProperty(l,"__esModule",{value:!0}),n(c(9)),n(c(10)),n(c(11)),n(c(12)),n(c(13)),n(c(14)),n(c(15)),n(c(16)),n(c(17)),n(c(31)),n(c(32)),n(c(33)),n(c(34)),n(c(35)),n(c(38)),n(c(39)),n(c(40)),n(c(41)),n(c(42)),n(c(43)),n(c(44)),n(c(45)),n(c(46)),n(c(47)),n(c(48)),n(c(49)),n(c(50)),n(c(3))},function(o,l,c){Object.defineProperty(l,"__esModule",{value:!0}),function(o){o.BOOKMARKING="oa:bookmarking",o.CLASSIFYING="oa:classifying",o.COMMENTING="oa:commenting",o.DESCRIBING="oa:describing",o.EDITING="oa:editing",o.HIGHLIGHTING="oa:highlighting",o.IDENTIFYING="oa:identifying",o.LINKING="oa:linking",o.MODERATING="oa:moderating",o.PAINTING="sc:painting",o.QUESTIONING="oa:questioning",o.REPLYING="oa:replying",o.TAGGING="oa:tagging",o.TRANSCRIBING="oad:transcribing"}(l.AnnotationMotivation||(l.AnnotationMotivation={})),function(o){o.AUTO_ADVANCE="auto-advance",o.CONTINUOUS="continuous",o.FACING_PAGES="facing-pages",o.HIDDEN="hidden",o.INDIVIDUALS="individuals",o.MULTI_PART="multi-part",o.NO_NAV="no-nav",o.NON_PAGED="non-paged",o.PAGED="paged",o.REPEAT="repeat",o.SEQUENCE="sequence",o.THUMBNAIL_NAV="thumbnail-nav",o.TOGETHER="together",o.UNORDERED="unordered"}(l.Behavior||(l.Behavior={})),function(o){o.CANVAS="canvas",o.CHOICE="choice",o.OA_CHOICE="oa:choice",o.CONTENT_AS_TEXT="contentastext",o.DATASET="dataset",o.DOCUMENT="document",o.IMAGE="image",o.MODEL="model",o.MOVING_IMAGE="movingimage",o.PDF="pdf",o.PHYSICAL_OBJECT="physicalobject",o.SOUND="sound",o.TEXT="text",o.TEXTUALBODY="textualbody",o.VIDEO="video"}(l.ExternalResourceType||(l.ExternalResourceType={})),function(o){o.ANNOTATION="annotation",o.CANVAS="canvas",o.COLLECTION="collection",o.MANIFEST="manifest",o.RANGE="range",o.SEQUENCE="sequence"}(l.IIIFResourceType||(l.IIIFResourceType={})),function(o){o.AUDIO_MP4="audio/mp4",o.CORTO="application/corto",o.DICOM="application/dicom",o.DRACO="application/draco",o.EPUB="application/epub+zip",o.GIRDER="image/vnd.kitware.girder",o.GLB="model/gltf-binary",o.GLTF="model/gltf+json",o.IIIF_PRESENTATION_2='application/ld+json;profile="http://iiif.io/api/presentation/2/context.json"',o.IIIF_PRESENTATION_3='application/ld+json;profile="http://iiif.io/api/presentation/3/context.json"',o.JPG="image/jpeg",o.M3U8="application/vnd.apple.mpegurl",o.MP3="audio/mp3",o.MPEG_DASH="application/dash+xml",o.OBJ="text/plain",o.OPF="application/oebps-package+xml",o.PDF="application/pdf",o.PLY="application/ply",o.THREEJS="application/vnd.threejs+json",o.USDZ="model/vnd.usd+zip",o.VIDEO_MP4="video/mp4",o.WAV="audio/wav",o.WEBM="video/webm"}(l.MediaType||(l.MediaType={})),function(o){o.DOC="application/msword",o.DOCX="application/vnd.openxmlformats-officedocument.wordprocessingml.document",o.PDF="application/pdf"}(l.RenderingFormat||(l.RenderingFormat={})),function(o){o.IMAGE_0_COMPLIANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/compliance.html#level0",o.IMAGE_0_COMPLIANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/compliance.html#level1",o.IMAGE_0_COMPLIANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/compliance.html#level2",o.IMAGE_0_CONFORMANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/conformance.html#level0",o.IMAGE_0_CONFORMANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/conformance.html#level1",o.IMAGE_0_CONFORMANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/conformance.html#level2",o.IMAGE_1_COMPLIANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0",o.IMAGE_1_COMPLIANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1",o.IMAGE_1_COMPLIANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2",o.IMAGE_1_CONFORMANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level0",o.IMAGE_1_CONFORMANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1",o.IMAGE_1_CONFORMANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2",o.IMAGE_1_LEVEL_0="http://iiif.io/api/image/1/level0.json",o.IMAGE_1_PROFILE_LEVEL_0="http://iiif.io/api/image/1/profiles/level0.json",o.IMAGE_1_LEVEL_1="http://iiif.io/api/image/1/level1.json",o.IMAGE_1_PROFILE_LEVEL_1="http://iiif.io/api/image/1/profiles/level1.json",o.IMAGE_1_LEVEL_2="http://iiif.io/api/image/1/level2.json",o.IMAGE_1_PROFILE_LEVEL_2="http://iiif.io/api/image/1/profiles/level2.json",o.IMAGE_2_LEVEL_0="http://iiif.io/api/image/2/level0.json",o.IMAGE_2_PROFILE_LEVEL_0="http://iiif.io/api/image/2/profiles/level0.json",o.IMAGE_2_LEVEL_1="http://iiif.io/api/image/2/level1.json",o.IMAGE_2_PROFILE_LEVEL_1="http://iiif.io/api/image/2/profiles/level1.json",o.IMAGE_2_LEVEL_2="http://iiif.io/api/image/2/level2.json",o.IMAGE_2_PROFILE_LEVEL_2="http://iiif.io/api/image/2/profiles/level2.json",o.AUTH_0_CLICK_THROUGH="http://iiif.io/api/auth/0/login/clickthrough",o.AUTH_0_LOGIN="http://iiif.io/api/auth/0/login",o.AUTH_0_LOGOUT="http://iiif.io/api/auth/0/logout",o.AUTH_0_RESTRICTED="http://iiif.io/api/auth/0/login/restricted",o.AUTH_0_TOKEN="http://iiif.io/api/auth/0/token",o.AUTH_1_CLICK_THROUGH="http://iiif.io/api/auth/1/clickthrough",o.AUTH_1_EXTERNAL="http://iiif.io/api/auth/1/external",o.AUTH_1_KIOSK="http://iiif.io/api/auth/1/kiosk",o.AUTH_1_LOGIN="http://iiif.io/api/auth/1/login",o.AUTH_1_LOGOUT="http://iiif.io/api/auth/1/logout",o.AUTH_1_PROBE="http://iiif.io/api/auth/1/probe",o.AUTH_1_TOKEN="http://iiif.io/api/auth/1/token",o.SEARCH_0="http://iiif.io/api/search/0/search",o.SEARCH_0_AUTO_COMPLETE="http://iiif.io/api/search/0/autocomplete",o.SEARCH_1="http://iiif.io/api/search/1/search",o.SEARCH_1_AUTO_COMPLETE="http://iiif.io/api/search/1/autocomplete",o.TRACKING_EXTENSIONS="http://universalviewer.io/tracking-extensions-profile",o.UI_EXTENSIONS="http://universalviewer.io/ui-extensions-profile",o.PRINT_EXTENSIONS="http://universalviewer.io/print-extensions-profile",o.SHARE_EXTENSIONS="http://universalviewer.io/share-extensions-profile",o.DOWNLOAD_EXTENSIONS="http://universalviewer.io/download-extensions-profile",o.OTHER_MANIFESTATIONS="http://iiif.io/api/otherManifestations.json",o.IXIF="http://wellcomelibrary.org/ld/ixif/0/alpha.json"}(l.ServiceProfile||(l.ServiceProfile={})),function(o){o.IMAGE_SERVICE_2="ImageService2",o.IMAGE_SERVICE_3="ImageService3"}(l.ServiceType||(l.ServiceType={})),function(o){o.BOTTOM_TO_TOP="bottom-to-top",o.LEFT_TO_RIGHT="left-to-right",o.RIGHT_TO_LEFT="right-to-left",o.TOP_TO_BOTTOM="top-to-bottom"}(l.ViewingDirection||(l.ViewingDirection={})),function(o){o.CONTINUOUS="continuous",o.INDIVIDUALS="individuals",o.NON_PAGED="non-paged",o.PAGED="paged",o.TOP="top"}(l.ViewingHint||(l.ViewingHint={}))},function(o,l,c){var p=c(21).Symbol;o.exports=p},function(l,c,p){var f=(this||o)&&(this||o).__awaiter||function(o,l,c,p){return new(c||(c=Promise))((function(f,h){function a(o){try{u(p.next(o))}catch(o){h(o)}}function s(o){try{u(p.throw(o))}catch(o){h(o)}}function u(o){var l;o.done?f(o.value):(l=o.value,l instanceof c?l:new c((function(o){o(l)}))).then(a,s)}u((p=p.apply(o,l||[])).next())}))},h=(this||o)&&(this||o).__generator||function(l,c){var p,f,h,_,g={label:0,sent:function(){if(1&h[0])throw h[1];return h[1]},trys:[],ops:[]};return _={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(_[Symbol.iterator]=function(){return this||o}),_;function s(o){return function(_){return function(o){if(p)throw new TypeError("Generator is already executing.");for(;g;)try{if(p=1,f&&(h=2&o[0]?f.return:o[0]?f.throw||((h=f.return)&&h.call(f),0):f.next)&&!(h=h.call(f,o[1])).done)return h;switch(f=0,h&&(o=[2&o[0],h.value]),o[0]){case 0:case 1:h=o;break;case 4:return g.label++,{value:o[1],done:!1};case 5:g.label++,f=o[1],o=[0];continue;case 7:o=g.ops.pop(),g.trys.pop();continue;default:if(!(h=(h=g.trys).length>0&&h[h.length-1])&&(6===o[0]||2===o[0])){g=0;continue}if(3===o[0]&&(!h||o[1]>h[0]&&o[1]<h[3])){g.label=o[1];break}if(6===o[0]&&g.label<h[1]){g.label=h[1],h=o;break}if(h&&g.label<h[2]){g.label=h[2],g.ops.push(o);break}h[2]&&g.ops.pop(),g.trys.pop();continue}o=c.call(l,g)}catch(l){o=[6,l],f=0}finally{p=h=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,_])}}};Object.defineProperty(c,"__esModule",{value:!0});var _=p(0),g=p(1),d=p(36);p(37);var v=function(){function e(){}return e.getMediaType=function(o){return(o=(o=o.toLowerCase()).split(";")[0]).trim()},e.getImageQuality=function(o){return o===g.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_1||o===g.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_2||o===g.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_1||o===g.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_2||o===g.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_1||o===g.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_2||o===g.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_1||o===g.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_2||o===g.ServiceProfile.IMAGE_1_LEVEL_1||o===g.ServiceProfile.IMAGE_1_PROFILE_LEVEL_1||o===g.ServiceProfile.IMAGE_1_LEVEL_2||o===g.ServiceProfile.IMAGE_1_PROFILE_LEVEL_2?"native":"default"},e.getInexactLocale=function(o){return-1!==o.indexOf("-")?o.substr(0,o.indexOf("-")):o},e.getLocalisedValue=function(o,l){if(!Array.isArray(o))return o;for(var c=0;c<o.length;c++){var p=o[c];if(l===p["@language"])return p["@value"]}var f=l.substr(0,l.indexOf("-"));for(c=0;c<o.length;c++){var h=o[c];if(h["@language"]===f)return h["@value"]}return null},e.generateTreeNodeIds=function(o,l){var c;void 0===l&&(l=0),c=o.parentNode?o.parentNode.id+"-"+l:"0",o.id=c;for(var p=0;p<o.nodes.length;p++){var f=o.nodes[p];e.generateTreeNodeIds(f,p)}},e.normaliseType=function(o){return-1!==(o=(o||"").toLowerCase()).indexOf(":")?o.split(":")[1]:o},e.normaliseUrl=function(o){return-1!==(o=o.substr(o.indexOf("://"))).indexOf("#")&&(o=o.split("#")[0]),o},e.normalisedUrlsMatch=function(o,l){return e.normaliseUrl(o)===e.normaliseUrl(l)},e.isImageProfile=function(o){return!!(e.normalisedUrlsMatch(o,g.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_0)||e.normalisedUrlsMatch(o,g.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_1)||e.normalisedUrlsMatch(o,g.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_2)||e.normalisedUrlsMatch(o,g.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_0)||e.normalisedUrlsMatch(o,g.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_2)||e.normalisedUrlsMatch(o,g.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_0)||e.normalisedUrlsMatch(o,g.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_1)||e.normalisedUrlsMatch(o,g.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_2)||e.normalisedUrlsMatch(o,g.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_1)||e.normalisedUrlsMatch(o,g.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_2)||e.normalisedUrlsMatch(o,g.ServiceProfile.IMAGE_1_LEVEL_0)||e.normalisedUrlsMatch(o,g.ServiceProfile.IMAGE_1_PROFILE_LEVEL_0)||e.normalisedUrlsMatch(o,g.ServiceProfile.IMAGE_1_LEVEL_1)||e.normalisedUrlsMatch(o,g.ServiceProfile.IMAGE_1_PROFILE_LEVEL_1)||e.normalisedUrlsMatch(o,g.ServiceProfile.IMAGE_1_LEVEL_2)||e.normalisedUrlsMatch(o,g.ServiceProfile.IMAGE_1_PROFILE_LEVEL_2)||e.normalisedUrlsMatch(o,g.ServiceProfile.IMAGE_2_LEVEL_0)||e.normalisedUrlsMatch(o,g.ServiceProfile.IMAGE_2_PROFILE_LEVEL_0)||e.normalisedUrlsMatch(o,g.ServiceProfile.IMAGE_2_LEVEL_1)||e.normalisedUrlsMatch(o,g.ServiceProfile.IMAGE_2_PROFILE_LEVEL_1)||e.normalisedUrlsMatch(o,g.ServiceProfile.IMAGE_2_LEVEL_2)||e.normalisedUrlsMatch(o,g.ServiceProfile.IMAGE_2_PROFILE_LEVEL_2))},e.isImageServiceType=function(o){return null!==o&&o.toLowerCase()===g.ServiceType.IMAGE_SERVICE_2.toLowerCase()||o===g.ServiceType.IMAGE_SERVICE_3.toLowerCase()},e.isLevel0ImageProfile=function(o){return!!(e.normalisedUrlsMatch(o,g.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_0)||e.normalisedUrlsMatch(o,g.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_0)||e.normalisedUrlsMatch(o,g.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_0)||e.normalisedUrlsMatch(o,g.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_0)||e.normalisedUrlsMatch(o,g.ServiceProfile.IMAGE_1_LEVEL_0)||e.normalisedUrlsMatch(o,g.ServiceProfile.IMAGE_1_PROFILE_LEVEL_0)||e.normalisedUrlsMatch(o,g.ServiceProfile.IMAGE_2_LEVEL_0)||e.normalisedUrlsMatch(o,g.ServiceProfile.IMAGE_2_PROFILE_LEVEL_0))},e.isLevel1ImageProfile=function(o){return!!(e.normalisedUrlsMatch(o,g.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_1)||e.normalisedUrlsMatch(o,g.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_1)||e.normalisedUrlsMatch(o,g.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_1)||e.normalisedUrlsMatch(o,g.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_1)||e.normalisedUrlsMatch(o,g.ServiceProfile.IMAGE_1_LEVEL_1)||e.normalisedUrlsMatch(o,g.ServiceProfile.IMAGE_1_PROFILE_LEVEL_1)||e.normalisedUrlsMatch(o,g.ServiceProfile.IMAGE_2_LEVEL_1)||e.normalisedUrlsMatch(o,g.ServiceProfile.IMAGE_2_PROFILE_LEVEL_1))},e.isLevel2ImageProfile=function(o){return!!(e.normalisedUrlsMatch(o,g.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_2)||e.normalisedUrlsMatch(o,g.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_2)||e.normalisedUrlsMatch(o,g.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_2)||e.normalisedUrlsMatch(o,g.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_2)||e.normalisedUrlsMatch(o,g.ServiceProfile.IMAGE_1_LEVEL_2)||e.normalisedUrlsMatch(o,g.ServiceProfile.IMAGE_1_PROFILE_LEVEL_2)||e.normalisedUrlsMatch(o,g.ServiceProfile.IMAGE_2_LEVEL_2)||e.normalisedUrlsMatch(o,g.ServiceProfile.IMAGE_2_PROFILE_LEVEL_2))},e.parseManifest=function(o,l){return _.Deserialiser.parse(o,l)},e.checkStatus=function(o){if(o.ok)return o;var l=new Error(o.statusText);return l.response=o,Promise.reject(l)},e.loadManifest=function(o){return new Promise((function(l,c){fetch(o).then(e.checkStatus).then((function(o){return o.json()})).then((function(o){l(o)})).catch((function(o){c()}))}))},e.loadExternalResourcesAuth1=function(o,l,c,p,f,h,_,g){return new Promise((function(d,v){var y=o.map((function(o){return e.loadExternalResourceAuth1(o,l,c,p,f,h,_,g)}));Promise.all(y).then((function(){d(o)})).catch((function(o){v(o)}))}))},e.loadExternalResourceAuth1=function(l,c,p,_,g,v,y,E){return f(this||o,void 0,void 0,(function(){var f;return h(this||o,(function(o){switch(o.label){case 0:return[4,_(l)];case 1:return(f=o.sent())?[4,l.getData(f)]:[3,6];case 2:return o.sent(),l.status!==d.OK?[3,3]:[2,l];case 3:return[4,e.doAuthChain(l,c,p,g,v,y,E)];case 4:o.sent(),o.label=5;case 5:if(l.status===d.OK||l.status===d.MOVED_TEMPORARILY)return[2,l];throw e.createAuthorizationFailedError();case 6:return[4,l.getData()];case 7:return o.sent(),l.status!==d.MOVED_TEMPORARILY&&l.status!==d.UNAUTHORIZED?[3,9]:[4,e.doAuthChain(l,c,p,g,v,y,E)];case 8:o.sent(),o.label=9;case 9:if(l.status===d.OK||l.status===d.MOVED_TEMPORARILY)return[2,l];throw e.createAuthorizationFailedError()}}))}))},e.doAuthChain=function(l,c,p,_,g,v,y){return f(this||o,void 0,void 0,(function(){var f,E,I,O,A,T,L,P;return h(this||o,(function(o){switch(o.label){case 0:return l.isAccessControlled()?((f=l.externalService)&&(f.options=l.options),(E=l.kioskService)&&(E.options=l.options),(I=l.clickThroughService)&&(I.options=l.options),(O=l.loginService)&&(O.options=l.options),l.isResponseHandled||l.status!==d.MOVED_TEMPORARILY?[3,2]:[4,v(l)]):[2,l];case 1:return o.sent(),[2,l];case 2:return A=null,T=null,(A=f)?(T=A,[4,e.attemptResourceWithToken(l,p,A)]):[3,4];case 3:return o.sent(),[2,l];case 4:return(A=E)?(T=A,(L=c(A))?[4,_(L)]:[3,7]):[3,7];case 5:return o.sent(),[4,e.attemptResourceWithToken(l,p,A)];case 6:return o.sent(),[2,l];case 7:return(A=I)?(T=A,[4,g(l,A)]):[3,11];case 8:return(P=o.sent())?[4,_(P)]:[3,11];case 9:return o.sent(),[4,e.attemptResourceWithToken(l,p,A)];case 10:return o.sent(),[2,l];case 11:return(A=O)?(T=A,[4,g(l,A)]):[3,15];case 12:return(P=o.sent())?[4,_(P)]:[3,15];case 13:return o.sent(),[4,e.attemptResourceWithToken(l,p,A)];case 14:return o.sent(),[2,l];case 15:return T&&y(l,T),[2]}}))}))},e.attemptResourceWithToken=function(l,c,p){return f(this||o,void 0,void 0,(function(){var f,_;return h(this||o,(function(o){switch(o.label){case 0:return(f=p.getService(g.ServiceProfile.AUTH_1_TOKEN))?[4,c(l,f)]:[3,3];case 1:return(_=o.sent())&&_.accessToken?[4,l.getData(_)]:[3,3];case 2:return o.sent(),[2,l];case 3:return[2]}}))}))},e.loadExternalResourcesAuth09=function(o,l,c,p,f,h,_,g,d,v){return new Promise((function(y,E){var I=o.map((function(o){return e.loadExternalResourceAuth09(o,l,c,p,f,h,_,g,d,v)}));Promise.all(I).then((function(){y(o)})).catch((function(o){E(o)}))}))},e.loadExternalResourceAuth09=function(o,l,c,p,f,h,_,g,v,y){return new Promise((function(E,I){y&&y.pessimisticAccessControl?o.getData().then((function(){o.isAccessControlled()?o.clickThroughService?(E(c(o)),E(p(o))):f(o).then((function(){h(o,!0).then((function(l){o.getData(l).then((function(){E(v(o))})).catch((function(o){I(e.createInternalServerError(o))}))})).catch((function(o){I(e.createInternalServerError(o))}))})).catch((function(o){I(e.createInternalServerError(o))})):E(o)})).catch((function(o){I(e.createInternalServerError(o))})):g(o,l).then((function(y){y?o.getData(y).then((function(){o.status===d.OK?E(v(o)):e.authorize(o,l,c,p,f,h,_,g).then((function(){E(v(o))})).catch((function(o){I(e.createAuthorizationFailedError())}))})).catch((function(o){I(e.createAuthorizationFailedError())})):e.authorize(o,l,c,p,f,h,_,g).then((function(){E(v(o))})).catch((function(o){I(e.createAuthorizationFailedError())}))})).catch((function(o){I(e.createAuthorizationFailedError())}))}))},e.createError=function(o,l){var c=new Error;return c.message=l,c.name=String(o),c},e.createAuthorizationFailedError=function(){return e.createError(_.StatusCode.AUTHORIZATION_FAILED,"Authorization failed")},e.createRestrictedError=function(){return e.createError(_.StatusCode.RESTRICTED,"Restricted")},e.createInternalServerError=function(o){return e.createError(_.StatusCode.INTERNAL_SERVER_ERROR,o)},e.authorize=function(o,l,c,p,f,h,_,g){return new Promise((function(v,y){o.getData().then((function(){o.isAccessControlled()?g(o,l).then((function(g){g?o.getData(g).then((function(){o.status===d.OK?v(o):e.showAuthInteraction(o,l,c,p,f,h,_,v,y)})).catch((function(o){y(e.createInternalServerError(o))})):h(o,!1).then((function(g){g?_(o,g,l).then((function(){o.getData(g).then((function(){o.status===d.OK?v(o):e.showAuthInteraction(o,l,c,p,f,h,_,v,y)})).catch((function(o){y(e.createInternalServerError(o))}))})).catch((function(o){y(e.createInternalServerError(o))})):e.showAuthInteraction(o,l,c,p,f,h,_,v,y)}))})).catch((function(o){y(e.createInternalServerError(o))})):v(o)}))}))},e.showAuthInteraction=function(o,l,c,p,f,h,_,g,v){o.status!==d.MOVED_TEMPORARILY||o.isResponseHandled?o.clickThroughService&&!o.isResponseHandled?c(o).then((function(){h(o,!0).then((function(c){_(o,c,l).then((function(){o.getData(c).then((function(){g(o)})).catch((function(o){v(e.createInternalServerError(o))}))})).catch((function(o){v(e.createInternalServerError(o))}))})).catch((function(o){v(e.createInternalServerError(o))}))})):f(o).then((function(){h(o,!0).then((function(c){_(o,c,l).then((function(){o.getData(c).then((function(){g(o)})).catch((function(o){v(e.createInternalServerError(o))}))})).catch((function(o){v(e.createInternalServerError(o))}))})).catch((function(o){v(e.createInternalServerError(o))}))})):g(o)},e.getService=function(o,l){for(var c=this.getServices(o),p=0;p<c.length;p++){var f=c[p];if(f.getProfile()===l)return f}return null},e.getResourceById=function(o,l){return e.traverseAndFind(o.__jsonld,"@id",l)},e.traverseAndFind=function(o,l,c){if(o.hasOwnProperty(l)&&o[l]===c)return o;for(var p=0;p<Object.keys(o).length;p++)if("object"==typeof o[Object.keys(o)[p]]){var f=e.traverseAndFind(o[Object.keys(o)[p]],l,c);if(null!=f)return f}},e.getServices=function(o,l){var c=void 0===l?{}:l,p=c.onlyService,f=void 0!==p&&p,h=c.onlyServices,g=void 0!==h&&h,d=c.skipParentResources,v=[];!(void 0!==d&&d)&&o&&o.options&&o.options.resource&&o.options.resource!==o&&v.push.apply(v,e.getServices(o.options.resource,{onlyServices:!0}));var y=g?[]:(o.__jsonld||o).service||[];if(Array.isArray(y)||(y=[y]),f||y.push.apply(y,(o.__jsonld||o).services||[]),0===y.length)return v;for(var E=0;E<y.length;E++){var I=y[E];if("string"==typeof I){var O=this.getResourceById(o.options.resource,I);O&&v.push(new _.Service(O.__jsonld||O,o.options))}else v.push(new _.Service(I,o.options))}return v},e.getTemporalComponent=function(o){var l=/t=([^&]+)/g.exec(o),c=null;return l&&l[1]&&(c=l[1].split(",")),c},e}();c.Utils=v},function(o,l,c){var p=c(19),f=c(20);o.exports=function e(o,l,c,h,_){var g=-1,d=o.length;for(c||(c=f),_||(_=[]);++g<d;){var v=o[g];l>0&&c(v)?l>1?e(v,l-1,c,h,_):p(_,v):h||(_[_.length]=v)}return _}},function(o,l){o.exports=function(o){return null!=o&&"object"==typeof o}},function(o,l,c){c.r(l),l.default=function(o,l){return l=l||{},new Promise((function(c,p){var f=new XMLHttpRequest,h=[],_=[],g={},u=function(){return{ok:2==(f.status/100|0),statusText:f.statusText,status:f.status,url:f.responseURL,text:function(){return Promise.resolve(f.responseText)},json:function(){return Promise.resolve(JSON.parse(f.responseText))},blob:function(){return Promise.resolve(new Blob([f.response]))},clone:u,headers:{keys:function(){return h},entries:function(){return _},get:function(o){return g[o.toLowerCase()]},has:function(o){return o.toLowerCase()in g}}}};for(var d in f.open(l.method||"get",o,!0),f.onload=function(){f.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,(function(o,l,c){h.push(l=l.toLowerCase()),_.push([l,c]),g[l]=g[l]?g[l]+","+c:c})),c(u())},f.onerror=p,f.withCredentials="include"==l.credentials,l.headers)f.setRequestHeader(d,l.headers[d]);f.send(l.body||null)}))}},function(o,l,c){o.exports=c(8)},function(o,l,c){Object.defineProperty(l,"__esModule",{value:!0}),function(o){for(var c in o)l.hasOwnProperty(c)||(l[c]=o[c])}(c(0));var p=c(3);l.loadManifest=function(o){return p.Utils.loadManifest(o)},l.parseManifest=function(o,l){return p.Utils.parseManifest(o,l)}},function(l,c,p){Object.defineProperty(c,"__esModule",{value:!0});var f=function(){function e(l){(this||o).__jsonld=l,(this||o).context=this.getProperty("context"),(this||o).id=this.getProperty("id")}return e.prototype.getProperty=function(l){var c=null;return(this||o).__jsonld&&((c=(this||o).__jsonld[l])||(c=(this||o).__jsonld["@"+l])),c},e}();c.JSONLDResource=f},function(l,c,p){var f,h=(this||o)&&(this||o).__extends||(f=function(o,l){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,l){o.__proto__=l}||function(o,l){for(var c in l)l.hasOwnProperty(c)&&(o[c]=l[c])})(o,l)},function(l,c){function r(){(this||o).constructor=l}f(l,c),l.prototype=null===c?Object.create(c):(r.prototype=c.prototype,new r)});Object.defineProperty(c,"__esModule",{value:!0});var _=p(0),g=p(1),d=function(l){function t(c,p){var f=l.call(this||o,c)||this||o;return f.options=p,f}return h(t,l),t.prototype.getIIIFResourceType=function(){return _.Utils.normaliseType(this.getProperty("type"))},t.prototype.getLabel=function(){var l=this.getProperty("label");return l?_.PropertyValue.parse(l,(this||o).options.locale):new _.PropertyValue([],(this||o).options.locale)},t.prototype.getDefaultLabel=function(){return this.getLabel().getValue((this||o).options.locale)},t.prototype.getMetadata=function(){var l=this.getProperty("metadata"),c=[];if(!l)return c;for(var p=0;p<l.length;p++){var f=l[p],h=new _.LabelValuePair((this||o).options.locale);h.parse(f),c.push(h)}return c},t.prototype.getRendering=function(o){for(var l=this.getRenderings(),c=0;c<l.length;c++){var p=l[c];if(p.getFormat()===o)return p}return null},t.prototype.getRenderings=function(){var l,c=[];if(!(l=(this||o).__jsonld?(this||o).__jsonld.rendering:(this||o).rendering))return c;Array.isArray(l)||(l=[l]);for(var p=0;p<l.length;p++){var f=l[p];c.push(new _.Rendering(f,(this||o).options))}return c},t.prototype.getRequiredStatement=function(){var l=null,c=this.getProperty("requiredStatement");return c&&(l=new _.LabelValuePair((this||o).options.locale)).parse(c),l},t.prototype.getService=function(l){return _.Utils.getService(this||o,l)},t.prototype.getServices=function(){return _.Utils.getServices(this||o)},t.prototype.getThumbnail=function(){var l=this.getProperty("thumbnail");return Array.isArray(l)&&(l=l[0]),l?new _.Thumbnail(l,(this||o).options):null},t.prototype.isAnnotation=function(){return this.getIIIFResourceType()===g.IIIFResourceType.ANNOTATION},t.prototype.isCanvas=function(){return this.getIIIFResourceType()===g.IIIFResourceType.CANVAS},t.prototype.isCollection=function(){return this.getIIIFResourceType()===g.IIIFResourceType.COLLECTION},t.prototype.isManifest=function(){return this.getIIIFResourceType()===g.IIIFResourceType.MANIFEST},t.prototype.isRange=function(){return this.getIIIFResourceType()===g.IIIFResourceType.RANGE},t.prototype.isSequence=function(){return this.getIIIFResourceType()===g.IIIFResourceType.SEQUENCE},t}(_.JSONLDResource);c.ManifestResource=d},function(l,c,p){var f,h=(this||o)&&(this||o).__extends||(f=function(o,l){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,l){o.__proto__=l}||function(o,l){for(var c in l)l.hasOwnProperty(c)&&(o[c]=l[c])})(o,l)},function(l,c){function r(){(this||o).constructor=l}f(l,c),l.prototype=null===c?Object.create(c):(r.prototype=c.prototype,new r)});Object.defineProperty(c,"__esModule",{value:!0});var _=p(0),g=function(l){function t(c,p){return l.call(this||o,c,p)||this||o}return h(t,l),t.prototype.getFormat=function(){var o=this.getProperty("format");return o?o.toLowerCase():null},t.prototype.getResources=function(){var l=[];if(!(this||o).__jsonld.resources)return l;for(var c=0;c<(this||o).__jsonld.resources.length;c++){var p=(this||o).__jsonld.resources[c],f=new _.Annotation(p,(this||o).options);l.push(f)}return l},t.prototype.getType=function(){var o=this.getProperty("type");return o?_.Utils.normaliseType(o):null},t.prototype.getWidth=function(){return this.getProperty("width")},t.prototype.getHeight=function(){return this.getProperty("height")},t.prototype.getMaxWidth=function(){return this.getProperty("maxWidth")},t.prototype.getMaxHeight=function(){return this.getProperty("maxHeight")?null:this.getMaxWidth()},t}(_.ManifestResource);c.Resource=g},function(l,c,p){var f,h=(this||o)&&(this||o).__extends||(f=function(o,l){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,l){o.__proto__=l}||function(o,l){for(var c in l)l.hasOwnProperty(c)&&(o[c]=l[c])})(o,l)},function(l,c){function r(){(this||o).constructor=l}f(l,c),l.prototype=null===c?Object.create(c):(r.prototype=c.prototype,new r)});Object.defineProperty(c,"__esModule",{value:!0});var _=p(0),g=p(1),d=function(l){function t(c,p){var f=l.call(this||o,c,p)||this||o;f.index=-1,f.isLoaded=!1;var h={defaultLabel:"-",locale:"en-GB",resource:f,pessimisticAccessControl:!1};return f.options=Object.assign(h,p),f}return h(t,l),t.prototype.getAttribution=function(){var l=this.getProperty("attribution");return l?_.PropertyValue.parse(l,(this||o).options.locale):new _.PropertyValue([],(this||o).options.locale)},t.prototype.getDescription=function(){var l=this.getProperty("description");return l?_.PropertyValue.parse(l,(this||o).options.locale):new _.PropertyValue([],(this||o).options.locale)},t.prototype.getHomepage=function(){var o=this.getProperty("homepage");return o?"string"==typeof o?o:(Array.isArray(o)&&o.length&&(o=o[0]),o["@id"]||o.id):null},t.prototype.getIIIFResourceType=function(){return _.Utils.normaliseType(this.getProperty("type"))},t.prototype.getLogo=function(){var o=this.getProperty("logo");if(!o){var l=this.getProperty("provider");if(!l)return null;o=l.logo}return o?"string"==typeof o?o:(Array.isArray(o)&&o.length&&(o=o[0]),o["@id"]||o.id):null},t.prototype.getLicense=function(){return _.Utils.getLocalisedValue(this.getProperty("license"),(this||o).options.locale)},t.prototype.getNavDate=function(){return new Date(this.getProperty("navDate"))},t.prototype.getRelated=function(){return this.getProperty("related")},t.prototype.getSeeAlso=function(){return this.getProperty("seeAlso")},t.prototype.getTrackingLabel=function(){var o=this.getService(g.ServiceProfile.TRACKING_EXTENSIONS);return o?o.getProperty("trackingLabel"):""},t.prototype.getDefaultTree=function(){return(this||o).defaultTree=new _.TreeNode("root"),(this||o).defaultTree.data=this||o,(this||o).defaultTree},t.prototype.getRequiredStatement=function(){var l=null,c=this.getProperty("requiredStatement");if(c)(l=new _.LabelValuePair((this||o).options.locale)).parse(c);else{var p=this.getAttribution();p&&((l=new _.LabelValuePair((this||o).options.locale)).value=p)}return l},t.prototype.isCollection=function(){return this.getIIIFResourceType()===g.IIIFResourceType.COLLECTION},t.prototype.isManifest=function(){return this.getIIIFResourceType()===g.IIIFResourceType.MANIFEST},t.prototype.load=function(){var l=this||o;return new Promise((function(o){if(l.isLoaded)o(l);else{var c=l.options;c.navDate=l.getNavDate();var p=l.__jsonld.id;p||(p=l.__jsonld["@id"]),_.Utils.loadManifest(p).then((function(p){l.parentLabel=l.getLabel().getValue(c.locale);var f=_.Deserialiser.parse(p,c);(l=Object.assign(l,f)).index=c.index,o(l)}))}}))},t}(_.ManifestResource);c.IIIFResource=d},function(l,c,p){var f,h=(this||o)&&(this||o).__extends||(f=function(o,l){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,l){o.__proto__=l}||function(o,l){for(var c in l)l.hasOwnProperty(c)&&(o[c]=l[c])})(o,l)},function(l,c){function r(){(this||o).constructor=l}f(l,c),l.prototype=null===c?Object.create(c):(r.prototype=c.prototype,new r)});Object.defineProperty(c,"__esModule",{value:!0});var _=p(0),g=function(l){function t(c,p){return l.call(this||o,c,p)||this||o}return h(t,l),t.prototype.getBody=function(){var l=[],c=this.getProperty("body");if(c)if(Array.isArray(c))for(var p=0;p<c.length;p++)if((g=c[p]).items)for(var f=0;f<g.items.length;f++){var h=g.items[f];l.push(new _.AnnotationBody(h,(this||o).options))}else l.push(new _.AnnotationBody(g,(this||o).options));else if(c.items)for(p=0;p<c.items.length;p++){var g=c.items[p];l.push(new _.AnnotationBody(g,(this||o).options))}else l.push(new _.AnnotationBody(c,(this||o).options));return l},t.prototype.getMotivation=function(){var o=this.getProperty("motivation");return o||null},t.prototype.getOn=function(){return this.getProperty("on")},t.prototype.getTarget=function(){return this.getProperty("target")},t.prototype.getResource=function(){return new _.Resource(this.getProperty("resource"),(this||o).options)},t}(_.ManifestResource);c.Annotation=g},function(l,c,p){var f,h=(this||o)&&(this||o).__extends||(f=function(o,l){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,l){o.__proto__=l}||function(o,l){for(var c in l)l.hasOwnProperty(c)&&(o[c]=l[c])})(o,l)},function(l,c){function r(){(this||o).constructor=l}f(l,c),l.prototype=null===c?Object.create(c):(r.prototype=c.prototype,new r)});Object.defineProperty(c,"__esModule",{value:!0});var _=p(0),g=function(l){function t(c,p){return l.call(this||o,c,p)||this||o}return h(t,l),t.prototype.getFormat=function(){var o=this.getProperty("format");return o?_.Utils.getMediaType(o):null},t.prototype.getType=function(){return this.getProperty("type")?_.Utils.normaliseType(this.getProperty("type")):null},t.prototype.getWidth=function(){return this.getProperty("width")},t.prototype.getHeight=function(){return this.getProperty("height")},t}(_.ManifestResource);c.AnnotationBody=g},function(l,c,p){var f,h=(this||o)&&(this||o).__extends||(f=function(o,l){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,l){o.__proto__=l}||function(o,l){for(var c in l)l.hasOwnProperty(c)&&(o[c]=l[c])})(o,l)},function(l,c){function r(){(this||o).constructor=l}f(l,c),l.prototype=null===c?Object.create(c):(r.prototype=c.prototype,new r)});Object.defineProperty(c,"__esModule",{value:!0});var _=p(0),g=function(l){function t(c,p,f){var h=l.call(this||o,p)||this||o;return h.label=c,h.options=f,h}return h(t,l),t.prototype.getIIIFResourceType=function(){return _.Utils.normaliseType(this.getProperty("type"))},t.prototype.getLabel=function(){return(this||o).label},t.prototype.getResources=function(){var l=this||o;return this.getProperty("resources").map((function(o){return new _.Annotation(o,l.options)}))},t.prototype.load=function(){var l=this||o;return new Promise((function(o,c){if(l.isLoaded)o(l);else{var p=l.__jsonld.id;p||(p=l.__jsonld["@id"]),_.Utils.loadManifest(p).then((function(c){l.__jsonld=c,l.context=l.getProperty("context"),l.id=l.getProperty("id"),l.isLoaded=!0,o(l)})).catch(c)}}))},t}(_.JSONLDResource);c.AnnotationList=g},function(l,c,p){var f,h=(this||o)&&(this||o).__extends||(f=function(o,l){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,l){o.__proto__=l}||function(o,l){for(var c in l)l.hasOwnProperty(c)&&(o[c]=l[c])})(o,l)},function(l,c){function r(){(this||o).constructor=l}f(l,c),l.prototype=null===c?Object.create(c):(r.prototype=c.prototype,new r)});Object.defineProperty(c,"__esModule",{value:!0});var _=function(l){function t(c,p){return l.call(this||o,c,p)||this||o}return h(t,l),t.prototype.getItems=function(){return this.getProperty("items")},t}(p(0).ManifestResource);c.AnnotationPage=_},function(l,c,p){var f,h=(this||o)&&(this||o).__extends||(f=function(o,l){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,l){o.__proto__=l}||function(o,l){for(var c in l)l.hasOwnProperty(c)&&(o[c]=l[c])})(o,l)},function(l,c){function r(){(this||o).constructor=l}f(l,c),l.prototype=null===c?Object.create(c):(r.prototype=c.prototype,new r)}),_=(this||o)&&(this||o).__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(c,"__esModule",{value:!0});var g=p(1),d=p(0),v=_(p(18)),y=_(p(30)),E=function(l){function t(c,p){return l.call(this||o,c,p)||this||o}return h(t,l),t.prototype.getCanonicalImageUri=function(l){var c,p=null,f="default",h=l;if((this||o).externalResource&&(this||o).externalResource.data&&(this||o).externalResource.data["@id"])p=(this||o).externalResource.data["@id"],h||(h=(this||o).externalResource.data.width),(this||o).externalResource.data["@context"]&&((this||o).externalResource.data["@context"].indexOf("/1.0/context.json")>-1||(this||o).externalResource.data["@context"].indexOf("/1.1/context.json")>-1||(this||o).externalResource.data["@context"].indexOf("/1/context.json")>-1)&&(f="native");else{var _=void 0;if((_=this.getImages())&&_.length){var g=_[0].getResource(),v=g.getServices();if(h||(h=g.getWidth()),y=v?v.find((function(o){return d.Utils.isImageProfile(o.getProfile())||d.Utils.isImageServiceType(o.getIIIFResourceType())})):null)p=y.id,f=d.Utils.getImageQuality(y.getProfile());else if(h===g.getWidth())return g.id}if((_=this.getContent())&&_.length){var y,E=_[0].getBody()[0];v=E.getServices();if(h||(h=E.getWidth()),y=v?v.find((function(o){return d.Utils.isImageServiceType(o.getIIIFResourceType())})):null)p=y.id,f=d.Utils.getImageQuality(y.getProfile());else if(h===E.getWidth())return E.id}if(!p){var I=this.getProperty("thumbnail");if(I){if("string"==typeof I)return I;if(I["@id"])return I["@id"];if(I.length)return I[0].id}}}return c=h+",",p&&p.endsWith("/")&&(p=p.substr(0,p.length-1)),[p,"full",c,0,f+".jpg"].join("/")},t.prototype.getMaxDimensions=function(){var l,c=null;return(this||o).externalResource&&(this||o).externalResource.data&&(this||o).externalResource.data.profile&&(l=(this||o).externalResource.data.profile,Array.isArray(l)&&(l=l.filter((function(o){return o.maxWidth}))[0])&&(c=new d.Size(l.maxWidth,l.maxHeight?l.maxHeight:l.maxWidth))),c},t.prototype.getContent=function(){var l=[],c=(this||o).__jsonld.items||(this||o).__jsonld.content;if(!c)return l;var p=null;if(c.length&&(p=new d.AnnotationPage(c[0],(this||o).options)),!p)return l;for(var f=p.getItems(),h=0;h<f.length;h++){var _=f[h],g=new d.Annotation(_,(this||o).options);l.push(g)}return l},t.prototype.getDuration=function(){return this.getProperty("duration")},t.prototype.getImages=function(){var l=[];if(!(this||o).__jsonld.images)return l;for(var c=0;c<(this||o).__jsonld.images.length;c++){var p=(this||o).__jsonld.images[c],f=new d.Annotation(p,(this||o).options);l.push(f)}return l},t.prototype.getIndex=function(){return this.getProperty("index")},t.prototype.getOtherContent=function(){var l=this||o,c=Array.isArray(this.getProperty("otherContent"))?this.getProperty("otherContent"):[this.getProperty("otherContent")],p=c.filter((function(o){return o&&(l=o["@type"],c="sc:AnnotationList","string"==typeof l&&"string"==typeof c&&l.toLowerCase()==l.toLowerCase());var l,c})).map((function(o,c){return new d.AnnotationList(o.label||"Annotation list "+c,o,l.options)})).map((function(o){return o.load()}));return Promise.all(p)},t.prototype.getWidth=function(){return this.getProperty("width")},t.prototype.getHeight=function(){return this.getProperty("height")},t.prototype.getViewingHint=function(){return this.getProperty("viewingHint")},Object.defineProperty(t.prototype,"imageResources",{get:function(){var l=this||o,c=y.default([this.getImages().map((function(o){return o.getResource()})),this.getContent().map((function(o){return o.getBody()}))]);return v.default(c.map((function(o){switch(o.getProperty("type").toLowerCase()){case g.ExternalResourceType.CHOICE:case g.ExternalResourceType.OA_CHOICE:return new t({images:v.default([o.getProperty("default"),o.getProperty("item")]).map((function(o){return{resource:o}}))},l.options).getImages().map((function(o){return o.getResource()}));default:return o}})))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"resourceAnnotations",{get:function(){return y.default([this.getImages(),this.getContent()])},enumerable:!0,configurable:!0}),t.prototype.resourceAnnotation=function(l){return(this||o).resourceAnnotations.find((function(o){return o.getResource().id===l||v.default(new Array(o.getBody())).some((function(o){return o.id===l}))}))},t.prototype.onFragment=function(o){var l=this.resourceAnnotation(o);if(l){var c=l.getProperty("on"),p=l.getProperty("target");if(c&&p){var f=(c||p).match(/xywh=(.*)$/);if(f)return f[1].split(",").map((function(o){return parseInt(o,10)}))}}},Object.defineProperty(t.prototype,"iiifImageResources",{get:function(){return(this||o).imageResources.filter((function(o){return o&&o.getServices()[0]&&o.getServices()[0].id}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageServiceIds",{get:function(){return(this||o).iiifImageResources.map((function(o){return o.getServices()[0].id}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"aspectRatio",{get:function(){return this.getWidth()/this.getHeight()},enumerable:!0,configurable:!0}),t}(d.Resource);c.Canvas=E},function(o,l,c){var p=c(4);o.exports=function(o){return(null==o?0:o.length)?p(o,1):[]}},function(o,l){o.exports=function(o,l){for(var c=-1,p=l.length,f=o.length;++c<p;)o[f+c]=l[c];return o}},function(o,l,c){var p=c(2),f=c(24),h=c(29),_=p?p.isConcatSpreadable:void 0;o.exports=function(o){return h(o)||f(o)||!!(_&&o&&o[_])}},function(o,l,c){var p=c(22),f="object"==typeof self&&self&&self.Object===Object&&self,h=p||f||Function("return this")();o.exports=h},function(l,c,p){(function(o){var c="object"==typeof o&&o&&o.Object===Object&&o;l.exports=c}).call(this||o,p(23))},function(l,c){var p;p=function(){return this||o}();try{p=p||new Function("return this")()}catch(l){"object"==typeof window&&(p=window)}l.exports=p},function(o,l,c){var p=c(25),f=c(5),h=Object.prototype,_=h.hasOwnProperty,g=h.propertyIsEnumerable,d=p(function(){return arguments}())?p:function(o){return f(o)&&_.call(o,"callee")&&!g.call(o,"callee")};o.exports=d},function(o,l,c){var p=c(26),f=c(5),h="[object Arguments]";o.exports=function(o){return f(o)&&p(o)==h}},function(o,l,c){var p=c(2),f=c(27),h=c(28),_="[object Null]",g="[object Undefined]",d=p?p.toStringTag:void 0;o.exports=function(o){return null==o?void 0===o?g:_:d&&d in Object(o)?f(o):h(o)}},function(o,l,c){var p=c(2),f=Object.prototype,h=f.hasOwnProperty,_=f.toString,g=p?p.toStringTag:void 0;o.exports=function(o){var l=h.call(o,g),c=o[g];try{o[g]=void 0;var p=!0}catch(o){}var f=_.call(o);return p&&(l?o[g]=c:delete o[g]),f}},function(o,l){var c=Object.prototype.toString;o.exports=function(o){return c.call(o)}},function(o,l){var c=Array.isArray;o.exports=c},function(o,l,c){var p=c(4),f=1/0;o.exports=function(o){return(null==o?0:o.length)?p(o,f):[]}},function(l,c,p){var f,h=(this||o)&&(this||o).__extends||(f=function(o,l){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,l){o.__proto__=l}||function(o,l){for(var c in l)l.hasOwnProperty(c)&&(o[c]=l[c])})(o,l)},function(l,c){function r(){(this||o).constructor=l}f(l,c),l.prototype=null===c?Object.create(c):(r.prototype=c.prototype,new r)});Object.defineProperty(c,"__esModule",{value:!0});var _=p(1),g=p(0),d=function(l){function t(c,p){var f=l.call(this||o,c,p)||this||o;return f.items=[],f._collections=null,f._manifests=null,c.__collection=f,f}return h(t,l),t.prototype.getCollections=function(){return(this||o)._collections?(this||o)._collections:(this||o)._collections=(this||o).items.filter((function(o){return o.isCollection()}))},t.prototype.getManifests=function(){return(this||o)._manifests?(this||o)._manifests:(this||o)._manifests=(this||o).items.filter((function(o){return o.isManifest()}))},t.prototype.getCollectionByIndex=function(o){for(var l,c=this.getCollections(),p=0;p<c.length;p++){var f=c[p];f.index===o&&(l=f)}if(l)return l.options.index=o,l.load();throw new Error("Collection index not found")},t.prototype.getManifestByIndex=function(o){for(var l,c=this.getManifests(),p=0;p<c.length;p++){var f=c[p];f.index===o&&(l=f)}if(l)return l.options.index=o,l.load();throw new Error("Manifest index not found")},t.prototype.getTotalCollections=function(){return this.getCollections().length},t.prototype.getTotalManifests=function(){return this.getManifests().length},t.prototype.getTotalItems=function(){return(this||o).items.length},t.prototype.getViewingDirection=function(){return this.getProperty("viewingDirection")?this.getProperty("viewingDirection"):_.ViewingDirection.LEFT_TO_RIGHT},t.prototype.getBehavior=function(){var o=this.getProperty("behavior");return Array.isArray(o)&&(o=o[0]),o||null},t.prototype.getViewingHint=function(){return this.getProperty("viewingHint")},t.prototype.getDefaultTree=function(){return l.prototype.getDefaultTree.call(this||o),(this||o).defaultTree.data.type=g.Utils.normaliseType(g.TreeNodeType.COLLECTION),this._parseManifests(this||o),this._parseCollections(this||o),g.Utils.generateTreeNodeIds((this||o).defaultTree),(this||o).defaultTree},t.prototype._parseManifests=function(l){if(l.getManifests()&&l.getManifests().length)for(var c=0;c<l.getManifests().length;c++){var p=l.getManifests()[c],f=p.getDefaultTree();f.label=p.parentLabel||p.getLabel().getValue((this||o).options.locale)||"manifest "+(c+1),f.navDate=p.getNavDate(),f.data.id=p.id,f.data.type=g.Utils.normaliseType(g.TreeNodeType.MANIFEST),l.defaultTree.addNode(f)}},t.prototype._parseCollections=function(l){if(l.getCollections()&&l.getCollections().length)for(var c=0;c<l.getCollections().length;c++){var p=l.getCollections()[c],f=p.getDefaultTree();f.label=p.parentLabel||p.getLabel().getValue((this||o).options.locale)||"collection "+(c+1),f.navDate=p.getNavDate(),f.data.id=p.id,f.data.type=g.Utils.normaliseType(g.TreeNodeType.COLLECTION),l.defaultTree.addNode(f)}},t}(g.IIIFResource);c.Collection=d},function(l,c,p){Object.defineProperty(c,"__esModule",{value:!0});var f=function(){function e(l,c){(this||o).start=l,(this||o).end=c}return e.prototype.getLength=function(){return(this||o).end-(this||o).start},e}();c.Duration=f},function(l,c,p){Object.defineProperty(c,"__esModule",{value:!0});var f=p(0),h=function(){function e(l){(this||o).defaultLocale=l}return e.prototype.parse=function(l){(this||o).resource=l,(this||o).label=f.PropertyValue.parse((this||o).resource.label,(this||o).defaultLocale),(this||o).value=f.PropertyValue.parse((this||o).resource.value,(this||o).defaultLocale)},e.prototype.getLabel=function(l){return null===(this||o).label?null:(Array.isArray(l)&&!l.length&&(l=void 0),(this||o).label.getValue(l||(this||o).defaultLocale))},e.prototype.setLabel=function(l){null===(this||o).label&&((this||o).label=new f.PropertyValue([])),(this||o).label.setValue(l,(this||o).defaultLocale)},e.prototype.getValue=function(l,c){return void 0===c&&(c="<br/>"),null===(this||o).value?null:(Array.isArray(l)&&!l.length&&(l=void 0),(this||o).value.getValue(l||(this||o).defaultLocale,c))},e.prototype.getValues=function(l){return null===(this||o).value?[]:(Array.isArray(l)&&!l.length&&(l=void 0),(this||o).value.getValues(l||(this||o).defaultLocale))},e.prototype.setValue=function(l){null===(this||o).value&&((this||o).value=new f.PropertyValue([])),(this||o).value.setValue(l,(this||o).defaultLocale)},e}();c.LabelValuePair=h},function(l,c,p){var f,h=(this||o)&&(this||o).__extends||(f=function(o,l){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,l){o.__proto__=l}||function(o,l){for(var c in l)l.hasOwnProperty(c)&&(o[c]=l[c])})(o,l)},function(l,c){function r(){(this||o).constructor=l}f(l,c),l.prototype=null===c?Object.create(c):(r.prototype=c.prototype,new r)});Object.defineProperty(c,"__esModule",{value:!0});var _=function(l){function t(){return null!==l&&l.apply(this||o,arguments)||this||o}return h(t,l),t.getValue=function(o,l){return o.getValue(l,"<br/>")},t.getValues=function(o,l){return o.getValues(l)},t}(Array);c.LanguageMap=_},function(l,c,p){var f,h=(this||o)&&(this||o).__extends||(f=function(o,l){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,l){o.__proto__=l}||function(o,l){for(var c in l)l.hasOwnProperty(c)&&(o[c]=l[c])})(o,l)},function(l,c){function r(){(this||o).constructor=l}f(l,c),l.prototype=null===c?Object.create(c):(r.prototype=c.prototype,new r)}),_=(this||o)&&(this||o).__spreadArrays||function(){for(var o=0,l=0,c=arguments.length;l<c;l++)o+=arguments[l].length;var p=Array(o),f=0;for(l=0;l<c;l++)for(var h=arguments[l],_=0,g=h.length;_<g;_++,f++)p[f]=h[_];return p};Object.defineProperty(c,"__esModule",{value:!0});var g=p(3),d=function(){function e(l,c,p){void 0===p&&(p="none"),Array.isArray(l)&&1===l.length?(this||o)._value=l[0]:(this||o)._value=l,"none"!==c&&"@none"!==c||(c=void 0),(this||o)._locale=c,(this||o)._defaultLocale=p}return e.parseV2Value=function(o,l){return"string"==typeof o?new e(o,void 0,l):o["@value"]?new e(o["@value"],o["@language"],l):null},Object.defineProperty(e.prototype,"value",{get:function(){return Array.isArray((this||o)._value)?(this||o)._value.join("<br/>"):(this||o)._value},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"locale",{get:function(){return void 0===(this||o)._locale?(this||o)._defaultLocale:(this||o)._locale},enumerable:!0,configurable:!0}),e.prototype.addValue=function(l){Array.isArray((this||o)._value)||((this||o)._value=[(this||o)._value]),Array.isArray(l)?(this||o)._value=(this||o)._value.concat(l):(this||o)._value.push(l)},e}();c.LocalizedValue=d;var v=function(l){function t(c,p){void 0===c&&(c=[]);var f=l.apply(this||o,c)||this||o;return f.__proto__=t.prototype,f._defaultLocale=p,f}return h(t,l),t.parse=function(o,l){if(!o)return new t([],l);if(Array.isArray(o)){var c=(p=o.map((function(o){return d.parseV2Value(o,l)})).filter((function(o){return null!==o}))).reduce((function(o,l){var c=l._locale;return c||(c="none"),o[c]?o[c].addValue(l._value):o[c]=l,o}),{});return new t(Object.values(c),l)}return"string"==typeof o?new t([new d(o,void 0,l)],l):o["@language"]||o["@value"]?new t(null!==(p=d.parseV2Value(o))?[p]:[],l):new t(Object.keys(o).map((function(c){var p=o[c];if(!Array.isArray(p))throw new Error("A IIIF v3 localized property value must have an array as the value for a given language.");return new d(p,c,l)})),l);var p},t.prototype.getSuitableLocale=function(l){for(var c=_(this||o).map((function(o){return o._locale})).filter((function(o){return void 0!==o})),r=function(o){var l=c.find((function(l){return l===o}));if(l)return{value:l}},p=0,f=l;p<f.length;p++){var h=r(f[p]);if("object"==typeof h)return h.value}for(var u=function(o){var l=c.find((function(l){return g.Utils.getInexactLocale(l)===g.Utils.getInexactLocale(o)}));if(l)return{value:l}},d=0,v=l;d<v.length;d++){var y=u(v[d]);if("object"==typeof y)return y.value}},t.prototype.setValue=function(l,c){var p=void 0;if(c){var f=this.getSuitableLocale([c]);f&&(p=this.find((function(o){return o._locale===f})))}else p=this.find((function(o){return void 0===o._locale}));p?p._value=l:this.push(new d(l,c,(this||o)._defaultLocale))},t.prototype.getValue=function(o,l){var c=this.getValues(o);return 0===c.length?null:l?c.join(l):c[0]},t.prototype.getValues=function(l){if(!(this||o).length)return[];var c;if(c=l?Array.isArray(l)?l:[l]:[],1===(this||o).length&&void 0===(this||o)[0]._locale){var p=(this||o)[0]._value;return Array.isArray(p)?p:[p]}var f=this.getSuitableLocale(c);if(f){p=this.find((function(o){return o._locale===f}))._value;return Array.isArray(p)?p:[p]}if(!this.find((function(o){return void 0===o._locale}))){p=(this||o)[0]._value;return Array.isArray(p)?p:[p]}var h=this.find((function(o){return void 0===o._locale}));return h?Array.isArray(h._value)?h._value:[h._value]:[]},t}(Array);c.PropertyValue=v},function(o,l,c){Object.defineProperty(l,"__esModule",{value:!0}),l.CONTINUE=100,l.SWITCHING_PROTOCOLS=101,l.PROCESSING=102,l.OK=200,l.CREATED=201,l.ACCEPTED=202,l.NON_AUTHORITATIVE_INFORMATION=203,l.NO_CONTENT=204,l.RESET_CONTENT=205,l.PARTIAL_CONTENT=206,l.MULTI_STATUS=207,l.MULTIPLE_CHOICES=300,l.MOVED_PERMANENTLY=301,l.MOVED_TEMPORARILY=302,l.SEE_OTHER=303,l.NOT_MODIFIED=304,l.USE_PROXY=305,l.TEMPORARY_REDIRECT=307,l.BAD_REQUEST=400,l.UNAUTHORIZED=401,l.PAYMENT_REQUIRED=402,l.FORBIDDEN=403,l.NOT_FOUND=404,l.METHOD_NOT_ALLOWED=405,l.NOT_ACCEPTABLE=406,l.PROXY_AUTHENTICATION_REQUIRED=407,l.REQUEST_TIME_OUT=408,l.CONFLICT=409,l.GONE=410,l.LENGTH_REQUIRED=411,l.PRECONDITION_FAILED=412,l.REQUEST_ENTITY_TOO_LARGE=413,l.REQUEST_URI_TOO_LARGE=414,l.UNSUPPORTED_MEDIA_TYPE=415,l.REQUESTED_RANGE_NOT_SATISFIABLE=416,l.EXPECTATION_FAILED=417,l.IM_A_TEAPOT=418,l.UNPROCESSABLE_ENTITY=422,l.LOCKED=423,l.FAILED_DEPENDENCY=424,l.UNORDERED_COLLECTION=425,l.UPGRADE_REQUIRED=426,l.PRECONDITION_REQUIRED=428,l.TOO_MANY_REQUESTS=429,l.REQUEST_HEADER_FIELDS_TOO_LARGE=431,l.INTERNAL_SERVER_ERROR=500,l.NOT_IMPLEMENTED=501,l.BAD_GATEWAY=502,l.SERVICE_UNAVAILABLE=503,l.GATEWAY_TIME_OUT=504,l.HTTP_VERSION_NOT_SUPPORTED=505,l.VARIANT_ALSO_NEGOTIATES=506,l.INSUFFICIENT_STORAGE=507,l.BANDWIDTH_LIMIT_EXCEEDED=509,l.NOT_EXTENDED=510,l.NETWORK_AUTHENTICATION_REQUIRED=511},function(o,l,c){o.exports=window.fetch||(window.fetch=c(6).default||c(6))},function(l,c,p){var f,h=(this||o)&&(this||o).__extends||(f=function(o,l){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,l){o.__proto__=l}||function(o,l){for(var c in l)l.hasOwnProperty(c)&&(o[c]=l[c])})(o,l)},function(l,c){function r(){(this||o).constructor=l}f(l,c),l.prototype=null===c?Object.create(c):(r.prototype=c.prototype,new r)});Object.defineProperty(c,"__esModule",{value:!0});var _=p(1),g=p(0),d=function(l){function t(c,p){var f=l.call(this||o,c,p)||this||o;if(f.index=0,f._allRanges=null,f.items=[],f._topRanges=[],f.__jsonld.structures&&f.__jsonld.structures.length)for(var h=f._getTopRanges(),_=0;_<h.length;_++){var g=h[_];f._parseRanges(g,String(_))}return f}return h(t,l),t.prototype.getPosterCanvas=function(){var l=this.getProperty("posterCanvas");return l&&(l=new g.Canvas(l,(this||o).options)),l},t.prototype.getAccompanyingCanvas=function(){var l=this.getProperty("accompanyingCanvas");return l&&(l=new g.Canvas(l,(this||o).options)),l},t.prototype.getBehavior=function(){var o=this.getProperty("behavior");return Array.isArray(o)&&(o=o[0]),o||null},t.prototype.getDefaultTree=function(){if(l.prototype.getDefaultTree.call(this||o),(this||o).defaultTree.data.type=g.Utils.normaliseType(g.TreeNodeType.MANIFEST),!(this||o).isLoaded)return(this||o).defaultTree;var c=this.getTopRanges();return c.length&&c[0].getTree((this||o).defaultTree),g.Utils.generateTreeNodeIds((this||o).defaultTree),(this||o).defaultTree},t.prototype._getTopRanges=function(){var l=[];if((this||o).__jsonld.structures&&(this||o).__jsonld.structures.length){for(var c=0;c<(this||o).__jsonld.structures.length;c++){var p=(this||o).__jsonld.structures[c];p.viewingHint===_.ViewingHint.TOP&&l.push(p)}if(!l.length){var f={};f.ranges=(this||o).__jsonld.structures,l.push(f)}}return l},t.prototype.getTopRanges=function(){return(this||o)._topRanges},t.prototype._getRangeById=function(l){if((this||o).__jsonld.structures&&(this||o).__jsonld.structures.length)for(var c=0;c<(this||o).__jsonld.structures.length;c++){var p=(this||o).__jsonld.structures[c];if(p["@id"]===l||p.id===l)return p}return null},t.prototype._parseRanges=function(l,c,p){var f,h=null;if("string"==typeof l&&(h=l,l=this._getRangeById(h)),l){(f=new g.Range(l,(this||o).options)).parentRange=p,f.path=c,p?p.items.push(f):(this||o)._topRanges.push(f);var _=l.items||l.members;if(_)for(var d=0;d<_.length;d++){var v=_[d];if(v["@type"]&&"sc:range"===v["@type"].toLowerCase()||v.type&&"range"===v.type.toLowerCase())this._parseRanges(v,c+"/"+d,f);else if(v["@type"]&&"sc:canvas"===v["@type"].toLowerCase()||v.type&&"canvas"===v.type.toLowerCase()){f.canvases||(f.canvases=[]);var y=v.id||v["@id"];f.canvases.push(y)}}else if(l.ranges)for(d=0;d<l.ranges.length;d++)this._parseRanges(l.ranges[d],c+"/"+d,f)}else console.warn("Range:",h,"does not exist")},t.prototype.getAllRanges=function(){if(null!=(this||o)._allRanges)return(this||o)._allRanges;(this||o)._allRanges=[];for(var l=this.getTopRanges(),t=function(o){var p=l[o];p.id&&c._allRanges.push(p);var i=function(o,l){o.add(l);var c=l.getRanges();return c.length?c.reduce(i,o):o},f=Array.from(p.getRanges().reduce(i,new Set));c._allRanges=c._allRanges.concat(f)},c=this||o,p=0;p<l.length;p++)t(p);return(this||o)._allRanges},t.prototype.getRangeById=function(o){for(var l=this.getAllRanges(),c=0;c<l.length;c++){var p=l[c];if(p.id===o)return p}return null},t.prototype.getRangeByPath=function(o){for(var l=this.getAllRanges(),c=0;c<l.length;c++){var p=l[c];if(p.path===o)return p}return null},t.prototype.getSequences=function(){if((this||o).items.length)return(this||o).items;var l=(this||o).__jsonld.mediaSequences||(this||o).__jsonld.sequences;if(l)for(var c=0;c<l.length;c++){var p=l[c],f=new g.Sequence(p,(this||o).options);(this||o).items.push(f)}else if((this||o).__jsonld.items){f=new g.Sequence((this||o).__jsonld.items,(this||o).options);(this||o).items.push(f)}return(this||o).items},t.prototype.getSequenceByIndex=function(o){return this.getSequences()[o]},t.prototype.getTotalSequences=function(){return this.getSequences().length},t.prototype.getManifestType=function(){var o=this.getService(_.ServiceProfile.UI_EXTENSIONS);return o?o.getProperty("manifestType"):g.ManifestType.EMPTY},t.prototype.isMultiSequence=function(){return this.getTotalSequences()>1},t.prototype.isPagingEnabled=function(){var o=this.getViewingHint();if(o)return o===_.ViewingHint.PAGED;var l=this.getBehavior();return!!l&&l===_.Behavior.PAGED},t.prototype.getViewingDirection=function(){return this.getProperty("viewingDirection")},t.prototype.getViewingHint=function(){return this.getProperty("viewingHint")},t}(g.IIIFResource);c.Manifest=d},function(o,l,c){Object.defineProperty(l,"__esModule",{value:!0}),function(o){o.EMPTY="",o.MANUSCRIPT="manuscript",o.MONOGRAPH="monograph"}(l.ManifestType||(l.ManifestType={}))},function(l,c,p){var f,h=(this||o)&&(this||o).__extends||(f=function(o,l){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,l){o.__proto__=l}||function(o,l){for(var c in l)l.hasOwnProperty(c)&&(o[c]=l[c])})(o,l)},function(l,c){function r(){(this||o).constructor=l}f(l,c),l.prototype=null===c?Object.create(c):(r.prototype=c.prototype,new r)});Object.defineProperty(c,"__esModule",{value:!0});var _=p(0),g=p(1),d=function(l){function t(c,p){var f=l.call(this||o,c,p)||this||o;return f._ranges=null,f.canvases=null,f.items=[],f}return h(t,l),t.prototype.getCanvasIds=function(){return(this||o).__jsonld.canvases?(this||o).__jsonld.canvases:(this||o).canvases?(this||o).canvases:[]},t.prototype.getDuration=function(){if((this||o).canvases&&(this||o).canvases.length){for(var l=[],c=[],p=0,f=(this||o).canvases;p<f.length;p++)if(T=f[p]){var h=T.match(/(.*)#t=([0-9.]+),?([0-9.]+)?/)||[void 0,T],g=h[1],d=h[2],v=h[3];g&&(l.push(parseFloat(d)),c.push(parseFloat(v)))}if(l.length&&c.length)return new _.Duration(Math.min.apply(Math,l),Math.max.apply(Math,c))}else{l=[],c=[];for(var y=0,E=P=this.getRanges();y<E.length;y++)(m=E[y].getDuration())&&(l.push(m.start),c.push(m.end));if(l.length&&c.length)return new _.Duration(Math.min.apply(Math,l),Math.max.apply(Math,c))}var I,O;if((this||o).canvases&&(this||o).canvases.length)for(var A=0;A<(this||o).canvases.length;A++){var T=(this||o).canvases[A],L=_.Utils.getTemporalComponent(T);L&&L.length>1&&(0===A&&(I=Number(L[0])),A===(this||o).canvases.length-1&&(O=Number(L[1])))}else{var P=this.getRanges();for(A=0;A<P.length;A++){var m;(m=P[A].getDuration())&&(0===A&&(I=m.start),A===P.length-1&&(O=m.end))}}if(void 0!==I&&void 0!==O)return new _.Duration(I,O)},t.prototype.getRanges=function(){return(this||o)._ranges?(this||o)._ranges:(this||o)._ranges=(this||o).items.filter((function(o){return o.isRange()}))},t.prototype.getBehavior=function(){var o=this.getProperty("behavior");return Array.isArray(o)&&(o=o[0]),o||null},t.prototype.getViewingDirection=function(){return this.getProperty("viewingDirection")},t.prototype.getViewingHint=function(){return this.getProperty("viewingHint")},t.prototype.getTree=function(l){l.data=this||o,(this||o).treeNode=l;var c=this.getRanges();if(c&&c.length)for(var p=0;p<c.length;p++){var f=c[p],h=new _.TreeNode;l.addNode(h),this._parseTreeNode(h,f)}return _.Utils.generateTreeNodeIds(l),l},t.prototype.spansTime=function(o){var l=this.getDuration();return!!(l&&o>=l.start&&o<=l.end)},t.prototype._parseTreeNode=function(l,c){l.label=c.getLabel().getValue((this||o).options.locale),l.data=c,l.data.type=_.Utils.normaliseType(_.TreeNodeType.RANGE),c.treeNode=l;var p=c.getRanges();if(p&&p.length)for(var f=0;f<p.length;f++){var h=p[f];if(h.getBehavior()!==g.Behavior.NO_NAV){var d=new _.TreeNode;l.addNode(d),this._parseTreeNode(d,h)}}},t}(_.ManifestResource);c.Range=d},function(l,c,p){var f,h=(this||o)&&(this||o).__extends||(f=function(o,l){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,l){o.__proto__=l}||function(o,l){for(var c in l)l.hasOwnProperty(c)&&(o[c]=l[c])})(o,l)},function(l,c){function r(){(this||o).constructor=l}f(l,c),l.prototype=null===c?Object.create(c):(r.prototype=c.prototype,new r)});Object.defineProperty(c,"__esModule",{value:!0});var _=function(l){function t(c,p){return l.call(this||o,c,p)||this||o}return h(t,l),t.prototype.getFormat=function(){return this.getProperty("format")},t}(p(0).ManifestResource);c.Rendering=_},function(l,c,p){var f,h=(this||o)&&(this||o).__extends||(f=function(o,l){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,l){o.__proto__=l}||function(o,l){for(var c in l)l.hasOwnProperty(c)&&(o[c]=l[c])})(o,l)},function(l,c){function r(){(this||o).constructor=l}f(l,c),l.prototype=null===c?Object.create(c):(r.prototype=c.prototype,new r)});Object.defineProperty(c,"__esModule",{value:!0});var _=p(1),g=p(0),d=function(l){function t(c,p){var f=l.call(this||o,c,p)||this||o;return f.items=[],f._thumbnails=null,f}return h(t,l),t.prototype.getCanvases=function(){if((this||o).items.length)return(this||o).items;var l=(this||o).__jsonld.canvases||(this||o).__jsonld.elements;if(l)for(var c=0;c<l.length;c++){var p=l[c];(f=new g.Canvas(p,(this||o).options)).index=c,(this||o).items.push(f)}else if((this||o).__jsonld)for(c=0;c<(this||o).__jsonld.length;c++){var f;p=(this||o).__jsonld[c];(f=new g.Canvas(p,(this||o).options)).index=c,(this||o).items.push(f)}return(this||o).items},t.prototype.getCanvasById=function(o){for(var l=0;l<this.getTotalCanvases();l++){var c=this.getCanvasByIndex(l),p=g.Utils.normaliseUrl(c.id);if(g.Utils.normaliseUrl(o)===p)return c}return null},t.prototype.getCanvasByIndex=function(o){return this.getCanvases()[o]},t.prototype.getCanvasIndexById=function(o){for(var l=0;l<this.getTotalCanvases();l++)if(this.getCanvasByIndex(l).id===o)return l;return null},t.prototype.getCanvasIndexByLabel=function(l,c){l=l.trim(),isNaN(l)||(l=parseInt(l,10).toString(),c&&(l+="r"));for(var p,f,h,_=/(\d*)\D+(\d*)/,g=0;g<this.getTotalCanvases();g++){var d=this.getCanvasByIndex(g);if(d.getLabel().getValue((this||o).options.locale)===l)return g;if((p=_.exec(l))&&(f=p[1],(h=p[2])&&new RegExp("^"+f+"\\D+"+h+"$").test(d.getLabel().toString())))return g}return-1},t.prototype.getLastCanvasLabel=function(l){for(var c=this.getTotalCanvases()-1;c>=0;c--){var p=this.getCanvasByIndex(c).getLabel().getValue((this||o).options.locale);if(l){if(/^[a-zA-Z0-9]*$/.test(p))return p}else if(p)return p}return(this||o).options.defaultLabel},t.prototype.getLastPageIndex=function(){return this.getTotalCanvases()-1},t.prototype.getNextPageIndex=function(o,l){var c;if(l){var p=this.getPagedIndices(o),f=this.getViewingDirection();c=f&&f===_.ViewingDirection.RIGHT_TO_LEFT?p[0]+1:p[p.length-1]+1}else c=o+1;return c>this.getLastPageIndex()?-1:c},t.prototype.getPagedIndices=function(o,l){var c=[];if(l){c=this.isFirstCanvas(o)||this.isLastCanvas(o)?[o]:o%2?[o,o+1]:[o-1,o];var p=this.getViewingDirection();p&&p===_.ViewingDirection.RIGHT_TO_LEFT&&(c=c.reverse())}else c.push(o);return c},t.prototype.getPrevPageIndex=function(o,l){var c;if(l){var p=this.getPagedIndices(o),f=this.getViewingDirection();c=f&&f===_.ViewingDirection.RIGHT_TO_LEFT?p[p.length-1]-1:p[0]-1}else c=o-1;return c},t.prototype.getStartCanvasIndex=function(){var o=this.getStartCanvas();if(o)for(var l=0;l<this.getTotalCanvases();l++)if(this.getCanvasByIndex(l).id===o)return l;return 0},t.prototype.getThumbs=function(o,l){for(var c=[],p=this.getTotalCanvases(),f=0;f<p;f++){var h=this.getCanvasByIndex(f),_=new g.Thumb(o,h);c.push(_)}return c},t.prototype.getThumbnails=function(){if(null!=(this||o)._thumbnails)return(this||o)._thumbnails;(this||o)._thumbnails=[];for(var l=this.getCanvases(),c=0;c<l.length;c++){var p=l[c].getThumbnail();p&&(this||o)._thumbnails.push(p)}return(this||o)._thumbnails},t.prototype.getStartCanvas=function(){return this.getProperty("startCanvas")},t.prototype.getTotalCanvases=function(){return this.getCanvases().length},t.prototype.getViewingDirection=function(){return this.getProperty("viewingDirection")?this.getProperty("viewingDirection"):(this||o).options.resource.getViewingDirection?(this||o).options.resource.getViewingDirection():null},t.prototype.getViewingHint=function(){return this.getProperty("viewingHint")},t.prototype.isCanvasIndexOutOfRange=function(o){return o>this.getTotalCanvases()-1},t.prototype.isFirstCanvas=function(o){return 0===o},t.prototype.isLastCanvas=function(o){return o===this.getTotalCanvases()-1},t.prototype.isMultiCanvas=function(){return this.getTotalCanvases()>1},t.prototype.isPagingEnabled=function(){var o=this.getViewingHint();return!!o&&o===_.ViewingHint.PAGED},t.prototype.isTotalCanvasesEven=function(){return this.getTotalCanvases()%2==0},t}(g.ManifestResource);c.Sequence=d},function(l,c,p){Object.defineProperty(c,"__esModule",{value:!0});var f=p(0),h=function(){function e(){}return e.parse=function(o,l){return"string"==typeof o&&(o=JSON.parse(o)),this.parseJson(o,l)},e.parseJson=function(o,l){var c;if(l&&l.navDate&&!isNaN(l.navDate.getTime())&&(o.navDate=l.navDate.toString()),o["@type"])switch(o["@type"]){case"sc:Collection":c=this.parseCollection(o,l);break;case"sc:Manifest":c=this.parseManifest(o,l);break;default:return null}else switch(o.type){case"Collection":c=this.parseCollection(o,l);break;case"Manifest":c=this.parseManifest(o,l);break;default:return null}return c.isLoaded=!0,c},e.parseCollection=function(o,l){var c=new f.Collection(o,l);return l?(c.index=l.index||0,l.resource&&(c.parentCollection=l.resource.parentCollection)):c.index=0,this.parseCollections(c,l),this.parseManifests(c,l),this.parseItems(c,l),c},e.parseCollections=function(o,l){var c;if(o.__jsonld.collections?c=o.__jsonld.collections:o.__jsonld.items&&(c=o.__jsonld.items.filter((function(o){return"collection"===o.type.toLowerCase()}))),c)for(var p=0;p<c.length;p++){l&&(l.index=p);var f=this.parseCollection(c[p],l);f.index=p,f.parentCollection=o,o.items.push(f)}},e.parseManifest=function(o,l){return new f.Manifest(o,l)},e.parseManifests=function(o,l){var c;if(o.__jsonld.manifests?c=o.__jsonld.manifests:o.__jsonld.items&&(c=o.__jsonld.items.filter((function(o){return"manifest"===o.type.toLowerCase()}))),c)for(var p=0;p<c.length;p++){var f=this.parseManifest(c[p],l);f.index=p,f.parentCollection=o,o.items.push(f)}},e.parseItem=function(o,l){if(o["@type"]){if("sc:manifest"===o["@type"].toLowerCase())return this.parseManifest(o,l);if("sc:collection"===o["@type"].toLowerCase())return this.parseCollection(o,l)}else if(o.type){if("manifest"===o.type.toLowerCase())return this.parseManifest(o,l);if("collection"===o.type.toLowerCase())return this.parseCollection(o,l)}return null},e.parseItems=function(l,c){var p=l.__jsonld.members||l.__jsonld.items;if(p)for(var n=function(o){c&&(c.index=o);var h=f.parseItem(p[o],c);return h?l.items.filter((function(o){return o.id===h.id}))[0]?"continue":(h.index=o,h.parentCollection=l,void l.items.push(h)):{value:void 0}},f=this||o,h=0;h<p.length;h++){var _=n(h);if("object"==typeof _)return _.value}},e}();c.Deserialiser=h},function(l,c,p){var f,h=(this||o)&&(this||o).__extends||(f=function(o,l){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,l){o.__proto__=l}||function(o,l){for(var c in l)l.hasOwnProperty(c)&&(o[c]=l[c])})(o,l)},function(l,c){function r(){(this||o).constructor=l}f(l,c),l.prototype=null===c?Object.create(c):(r.prototype=c.prototype,new r)});Object.defineProperty(c,"__esModule",{value:!0});var _=p(0),g=function(l){function t(c,p){return l.call(this||o,c,p)||this||o}return h(t,l),t.prototype.getProfile=function(){var o=this.getProperty("profile");return o||(o=this.getProperty("dcterms:conformsTo")),Array.isArray(o)?o[0]:o},t.prototype.getConfirmLabel=function(){return _.Utils.getLocalisedValue(this.getProperty("confirmLabel"),(this||o).options.locale)},t.prototype.getDescription=function(){return _.Utils.getLocalisedValue(this.getProperty("description"),(this||o).options.locale)},t.prototype.getFailureDescription=function(){return _.Utils.getLocalisedValue(this.getProperty("failureDescription"),(this||o).options.locale)},t.prototype.getFailureHeader=function(){return _.Utils.getLocalisedValue(this.getProperty("failureHeader"),(this||o).options.locale)},t.prototype.getHeader=function(){return _.Utils.getLocalisedValue(this.getProperty("header"),(this||o).options.locale)},t.prototype.getServiceLabel=function(){return _.Utils.getLocalisedValue(this.getProperty("label"),(this||o).options.locale)},t.prototype.getInfoUri=function(){var l=(this||o).id;return l.endsWith("/")||(l+="/"),l+"info.json"},t}(_.ManifestResource);c.Service=g},function(l,c,p){Object.defineProperty(c,"__esModule",{value:!0});var n=function(l,c){(this||o).width=l,(this||o).height=c};c.Size=n},function(o,l,c){Object.defineProperty(l,"__esModule",{value:!0}),function(o){o[o.AUTHORIZATION_FAILED=1]="AUTHORIZATION_FAILED",o[o.FORBIDDEN=2]="FORBIDDEN",o[o.INTERNAL_SERVER_ERROR=3]="INTERNAL_SERVER_ERROR",o[o.RESTRICTED=4]="RESTRICTED"}(l.StatusCode||(l.StatusCode={}))},function(l,c,p){Object.defineProperty(c,"__esModule",{value:!0});var n=function(l,c){(this||o).data=c,(this||o).index=c.index,(this||o).width=l;var p=c.getHeight()/c.getWidth();(this||o).height=p?Math.floor((this||o).width*p):l,(this||o).uri=c.getCanonicalImageUri(l),(this||o).label=c.getLabel().getValue(),(this||o).viewingHint=c.getViewingHint()};c.Thumb=n},function(l,c,p){var f,h=(this||o)&&(this||o).__extends||(f=function(o,l){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,l){o.__proto__=l}||function(o,l){for(var c in l)l.hasOwnProperty(c)&&(o[c]=l[c])})(o,l)},function(l,c){function r(){(this||o).constructor=l}f(l,c),l.prototype=null===c?Object.create(c):(r.prototype=c.prototype,new r)});Object.defineProperty(c,"__esModule",{value:!0});var _=function(l){function t(c,p){return l.call(this||o,c,p)||this||o}return h(t,l),t}(p(0).Resource);c.Thumbnail=_},function(l,c,p){Object.defineProperty(c,"__esModule",{value:!0});var f=p(0),h=function(){function e(l,c){(this||o).label=l,(this||o).data=c||{},(this||o).nodes=[]}return e.prototype.addNode=function(l){(this||o).nodes.push(l),l.parentNode=this||o},e.prototype.isCollection=function(){return(this||o).data.type===f.Utils.normaliseType(f.TreeNodeType.COLLECTION)},e.prototype.isManifest=function(){return(this||o).data.type===f.Utils.normaliseType(f.TreeNodeType.MANIFEST)},e.prototype.isRange=function(){return(this||o).data.type===f.Utils.normaliseType(f.TreeNodeType.RANGE)},e}();c.TreeNode=h},function(o,l,c){Object.defineProperty(l,"__esModule",{value:!0}),function(o){o.COLLECTION="collection",o.MANIFEST="manifest",o.RANGE="range"}(l.TreeNodeType||(l.TreeNodeType={}))}])}));var c=l;const p=l.manifesto;export{c as default,p as manifesto};

